"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonpCheckout"] = self["webpackJsonpCheckout"] || []).push([["wallet-button-v1-resolver"],{

/***/ "../checkout-sdk-js/dist/esm/integrations/apple-pay.js":
/*!*************************************************************!*\
  !*** ../checkout-sdk-js/dist/esm/integrations/apple-pay.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createApplePayButtonStrategy: () => (/* binding */ ie),\n/* harmony export */   createApplePayCustomerStrategy: () => (/* binding */ H),\n/* harmony export */   createApplePayPaymentStrategy: () => (/* binding */ Y)\n/* harmony export */ });\n/* harmony import */ var _bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @bigcommerce/request-sender */ \"../checkout-sdk-js/node_modules/@bigcommerce/request-sender/esm/index.js\");\n/* harmony import */ var _bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @bigcommerce/script-loader */ \"../checkout-sdk-js/node_modules/@bigcommerce/script-loader/lib/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"../checkout-sdk-js/node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\nvar o={};function r(e,t,i=!0){var n;return null!==(n=e[t])&&void 0!==n?n:i}o.d=(e,t)=>{for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const s=\"3.128.0\",l=\"3.123.2\",d=\"3.106.0\";class c{constructor(e){this.paymentIntegrationService=e,this.braintreeWindow=window}getSDKVersion(){const e=this.paymentIntegrationService.getState().getStoreConfig(),t=(null==e?void 0:e.checkoutSettings.features)||{};return this.getPreloadedSDKVersion()||(r(t,\"PAYPAL-5809.braintree_hosted_fields_fix_version\")?s:r(t,\"PAYPAL-5636.update_braintree_sdk_version\")?l:d)}getPreloadedSDKVersion(){const e=this.braintreeWindow.braintree;if(e){const t=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.find)(Object.values(e),e=>!!e.VERSION);return null==t?void 0:t.VERSION}}}class h extends Error{constructor(e){var t;super(e||\"An unexpected error has occurred.\"),this.name=\"StandardError\",this.type=\"standard\",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,\"function\"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class u extends h{constructor(e){super(e||\"Unsupported browser error\"),this.name=\"UnsupportedBrowserError\",this.type=\"unsupported_browser\"}}var p,m,y,g,v,S,b,C;!function(e){e[e.CheckoutButtonNotInitialized=0]=\"CheckoutButtonNotInitialized\",e[e.CustomerNotInitialized=1]=\"CustomerNotInitialized\",e[e.PaymentNotInitialized=2]=\"PaymentNotInitialized\",e[e.ShippingNotInitialized=3]=\"ShippingNotInitialized\",e[e.SpamProtectionNotInitialized=4]=\"SpamProtectionNotInitialized\"}(p||(p={}));class f extends h{constructor(e){super(function(e){switch(e){case p.CustomerNotInitialized:return\"Unable to proceed because the customer step of checkout has not been initialized.\";case p.PaymentNotInitialized:return\"Unable to proceed because the payment step of checkout has not been initialized.\";case p.ShippingNotInitialized:return\"Unable to proceed because the shipping step of checkout has not been initialized.\";case p.SpamProtectionNotInitialized:return\"Unable to proceed because the checkout spam protection has not been initialized.\";default:return\"Unable to proceed because the required component has not been initialized.\"}}(e)),this.subtype=e,this.name=\"NotInitializedError\",this.type=\"not_initialized\"}}!function(e){e.ESTIMATED=\"ESTIMATED\",e.FINAL=\"FINAL\",e.NOT_CURRENTLY_KNOWN=\"NOT_CURRENTLY_KNOWN\"}(m||(m={})),function(e){e.Completed=\"COMPLETED\",e.Pending=\"PENDING\",e.Failed=\"FAILED\"}(y||(y={})),function(e){e.TRUSTLY=\"trustly\"}(g||(g={})),function(e){e.SUCCEEDED=\"succeeded\",e.FAILED=\"failed\",e.CANCELED=\"cancelled\",e.UNRECOGNIZED=\"unrecognized\"}(v||(v={})),function(e){e.Customer=\"CUSTOMER\",e.Merchant=\"MERCHANT\",e.Network=\"NETWORK\",e.Internal=\"INTERNAL\",e.Unknown=\"UNKNOWN\"}(S||(S={})),function(e){e.KountNotEnabled=\"DATA_COLLECTOR_KOUNT_NOT_ENABLED\"}(b||(b={})),function(e){e.Visa=\"visa\",e.Mastercard=\"mastercard\",e.AmericanExpress=\"american-express\",e.DinersClub=\"diners-club\",e.Discover=\"discover\",e.Jcb=\"jcb\",e.UnionPay=\"union-pay\",e.Maestro=\"maestro\",e.Elo=\"elo\",e.Mir=\"mir\",e.Hiper=\"hiper\",e.Hipercard=\"hipercard\"}(C||(C={}));var _,w,P,I=function(e,t,i,n){return new(i||(i=Promise))(function(a,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}l((n=n.apply(e,t||[])).next())})};class T{constructor(e){this.braintreeScriptLoader=e}initialize(e){this.setClientToken(e)}deinitialize(){return I(this,void 0,void 0,function*(){yield this.teardownModule(this.dataCollector),this.dataCollector=void 0})}getClient(){return I(this,void 0,void 0,function*(){if(!this.client){const e=this.getClientTokenOrThrow(),t=yield this.braintreeScriptLoader.loadClient();this.client=yield t.create({authorization:e})}return this.client})}getDataCollectorOrThrow(e){return I(this,void 0,void 0,function*(){const t={deviceData:void 0,teardown:()=>Promise.resolve()};if(!this.dataCollector)try{const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadDataCollector(),n=Object.assign({client:t,kount:!0},e);this.dataCollector=yield i.create(n)}catch(e){if(function(e){return Boolean(\"object\"==typeof e&&null!==e&&(\"type\"in e||\"message\"in e||\"code\"in e))}(e)&&e.code===b.KountNotEnabled)return t;throw e}return this.dataCollector})}getBraintreeGooglePayment(){return I(this,void 0,void 0,function*(){if(!this.googlePayment){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadGooglePayment()]);this.googlePayment=yield t.create({client:e})}return this.googlePayment})}getBraintreeThreeDS(){return I(this,void 0,void 0,function*(){if(!this.threeDS){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.load3DS()]);this.threeDS=yield t.create({client:e,version:2})}return this.threeDS})}getBraintreeLocalPayment(e){return I(this,void 0,void 0,function*(){if(!this.braintreeLocalPayment){const[t,i]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadLocalPayment()]);this.braintreeLocalPayment=yield new Promise((n,a)=>{i.create({client:t,merchantAccountId:e},(e,t)=>{e&&a(e),n(t)})})}return this.braintreeLocalPayment})}getUsBankAccount(){return I(this,void 0,void 0,function*(){if(!this.usBankAccount){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadUsBankAccount();this.usBankAccount=yield t.create({client:e})}return this.usBankAccount})}getBraintreeVisaCheckout(){return this.visaCheckout||(this.visaCheckout=Promise.all([this.getClient(),this.braintreeScriptLoader.loadVisaCheckout()]).then(([e,t])=>t.create({client:e}))),this.visaCheckout}getVisaCheckoutSdk(e){return I(this,void 0,void 0,function*(){return this.visaCheckoutSDK||(this.visaCheckoutSDK=yield this.braintreeScriptLoader.loadVisaCheckoutSdk(e)),this.visaCheckoutSDK})}getVenmoCheckoutOrThrow(){return I(this,void 0,void 0,function*(){if(!this.braintreeVenmo){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadVenmoCheckout(),i={client:e,allowDesktop:!0,paymentMethodUsage:\"multi_use\"},n=yield t.create(i);if(!n.isBrowserSupported())throw new u;this.braintreeVenmo=n}return this.braintreeVenmo})}setClientToken(e){this.clientToken=e}getClientTokenOrThrow(){if(!this.clientToken)throw new f(p.PaymentNotInitialized);return this.clientToken}teardownModule(e){return e?e.teardown():Promise.resolve()}}class k extends h{constructor(e){super(e||\"Unable to proceed because the client library of a payment method is not loaded or ready to be used.\"),this.name=\"PaymentMethodClientUnavailableError\",this.type=\"payment_method_client_unavailable\"}}!function(e){e.Sandbox=\"sandbox\",e.Production=\"production\"}(_||(_={})),function(e){e.Client=\"client\",e.DataCollector=\"dataCollector\",e.Fastlane=\"fastlane\",e.GooglePayment=\"googlePayment\",e.HostedFields=\"hostedFields\",e.LocalPayment=\"localPayment\",e.Paypal=\"paypal\",e.PaypalCheckout=\"paypalCheckout\",e.ThreeDSecure=\"threeDSecure\",e.UsBankAccount=\"usBankAccount\",e.Venmo=\"venmo\",e.VisaCheckout=\"visaCheckout\"}(w||(w={})),function(e){e.CardCode=\"cardCode\",e.CardCodeVerification=\"cardCodeVerification\",e.CardExpiry=\"cardExpiry\",e.CardName=\"cardName\",e.CardNumber=\"cardNumber\",e.CardNumberVerification=\"cardNumberVerification\"}(P||(P={}));const A={[d]:{[w.Client]:\"sha384-26BXDNnJI23JYRyFBj4xe4sVNrUSSiSSu11kxVXNM/vEPONm4LuL00w6ZaTgQewt\",[w.PaypalCheckout]:\"sha384-B+vzbZwnQtzWBthpkT4TXKUibO65tyeK7eCxSvpblgprTep2+IAXB2Cxxjrn710O\",[w.Paypal]:\"sha384-uyAGL1/3+XJAHnGoNy4eCoXdzJ4f7Ilzp+6w9PNnEjs6DCCz9WMyJjMN1gzc78U+\",[w.LocalPayment]:\"sha384-LIvOEMkIVEwVuYBdVOQc1AC5YbGGlwyfUheS0ACK218D2STuVYQlZ4FyEPowAEfT\",[w.DataCollector]:\"sha384-1bo9JDz+Kscthc085cCKWur8CLwUoBpoNyxsDi7932mCl0zFq3A5mv+FQLw9GHpV\",[w.UsBankAccount]:\"sha384-xmHBVaU+w74V+OebD3AaPONFxHUGMf+QRs8G/JxVPXNNP7MDa2jL0ICWHIe2tTfJ\",[w.GooglePayment]:\"sha384-WKDJl8mqoP82qZpMGH6AbZxnvXnSW8ILV4M64CyMLiugGMwu7LyP89wjCkHqsiBe\",[w.ThreeDSecure]:\"sha384-VQUlpGHzsGvs5XeiGFip7EXRsvoHWEXDVmgCacfbyieZI9mdBOqq3NSoyo28OCOB\",[w.VisaCheckout]:\"sha384-yx7mADfzTN0T43Q6rlH49LIg1EJ0iUZgBp/EczX9LXsUGkySgxrD+nWHQRBkyfoT\",[w.Venmo]:\"sha384-QX4rPjoj1ZDhuG0aSyKs56lEKDqTMTcjYxUHY1SzO5VZDsqIE2NTkqot7KNSCyov\",[w.HostedFields]:\"sha384-VvYBACfSu0Cr/J32uKmxG7AXcNOJE1AzIIL3kbikyS7YKp5fz5Is+NzNP/lyauNy\",[w.Fastlane]:\"sha384-9oGsZMRZwpGtDEDYa/dFt76dECqj1xAni9gIKgc3KfMIiRnR73nEeeUDLiBzxhFa\"},[l]:{[w.Client]:\"sha384-o+nbQGcwNNxIBeXeu3+XmbSq+Cg8R3EN3N0l5hXCgMMU2RGY0t1z0LroSEIAbfAO\",[w.PaypalCheckout]:\"sha384-WrfbWPBS4mH86GAoycPSgiH8hQ8KH7A67C93Hjhunv/xhNk2YpBn3wbFA4Fhg9U/\",[w.Paypal]:\"sha384-VF389nvvrRUgDsTXMxTYORDtVegB9IQa3Cxr//DyJnLYnz8/X8VCzEvck2c+Megt\",[w.LocalPayment]:\"sha384-tZKx2rEQbfmZpoPSY5VPmJEhaq4X75dLvwHMs3VE9U+C8lPyw+hWTIL1+GPvWCIH\",[w.DataCollector]:\"sha384-E6k3wOpP7syCDDwaRDLF06942Y00NkbwJvWi2OQXwwKzGwG5fd3E7RFUvCCecfvO\",[w.UsBankAccount]:\"sha384-258FON8LZGG0W9Qaz4Jij83pZHu30YnKjJA7gNulLBh6CclkucgF+tHDQuYFRYfW\",[w.GooglePayment]:\"sha384-taJ2p/0+n0VH328POAoBiuEbL3tnHUTE9S42hK1V+Txs3X+QYjZOyKW35JgHRFfO\",[w.ThreeDSecure]:\"sha384-+NSZH4Zj3sO5bdWvPKhU5N16QDxeueTVTnUVeleeESkhLSaz4Ob1hh/5myecc9Ym\",[w.VisaCheckout]:\"sha384-66DiBjghxk1OmBj8aksN8gbQ+CwoQcx1vPfiXUN08g1iQVM+BwewF0p7toM3i7SS\",[w.Venmo]:\"sha384-B5UwY42kE4RoLoWbQ7YpqosUlUad2/DlGWiw0HhoZbSPk30CQAaSA10ohyLDTkDU\",[w.HostedFields]:\"sha384-Aw9EesSaUeWxe36PqEHiOyOyOq8M6CIb1gw7/yHNVPRzGtFXXcd2OQ8qXrIlOj2P\",[w.Fastlane]:\"sha384-rhBL1hpZ71JqG+2TsT0Dih47mbjx8cjJCpeZjk9tw3df1gFMKfCTmMyZunhr7H4Y\"},[s]:{[w.Client]:\"sha384-0WNxksIpRP+fYZiIdr12g6DBUQfLDzYCQJZtR/C8KkcwSGhPHfcFp3tTaGcMyFTq\",[w.PaypalCheckout]:\"sha384-lWM1jk4BOxoDNV6Kop7tVNvQgINlmEVz0c/OwM+HNHK3QC8xqwd54Ovrt2QRDTjh\",[w.Paypal]:\"sha384-fXUmVxC2EMZBDXZ7eTHSTL/LFBrHej/MSXT/vTBXvra4lzgLNGvREAp+x0GYObuH\",[w.LocalPayment]:\"sha384-pha1xGuGSkmZH5x9aqHvRaO4xLea7rmQ/79PFj9zxNzxuFcOWZg7gOP7FibygOEC\",[w.DataCollector]:\"sha384-Q6PI2F9eekWbAxhroybl+aEcvqhdowN/EQlGwBUyJOzPFn9982u9xl6SU6XfGKzc\",[w.UsBankAccount]:\"sha384-W3RLQSKJL1tQ3+Y7mP6tmkamtZ8bV4Yw/XxL9Jj5JtXHraD8loMF8hAIG5m2zK7F\",[w.GooglePayment]:\"sha384-TITQMsFWA3elDNGP2mWz2oKBo4qjt+TlqzovcaPoeBiAh/wPBi6nae50ADdgU1/i\",[w.ThreeDSecure]:\"sha384-YiycYN89ZlL/Evcaq4y1ajW1mhd7JYfZBDuOwHtIn4/Jnm20GL+/XCM+zYAwWD8D\",[w.VisaCheckout]:\"sha384-/OdaTv9qrkKzjObtUe6yzfDhHozFW/+uXlrSl736sOZRJpjGQETvpYXqMFFg69xv\",[w.Venmo]:\"sha384-dA+ojdW9vbJS4JavcXyOs9d5uZHJg5dNtYupoPSH2zsXIiYDVS5amLb/u8qmQ6oz\",[w.HostedFields]:\"sha384-31ZkS58+iaWsW06ftW52zzVZFp43WPd7pNYRiddYynSNg6Oh7WGbSFGorAUH6T1z\",[w.Fastlane]:\"sha384-jlbrwNvL3HvLAUCtLSmrnQ2GH1udCUrRS/bVmReAS5fuIVvcW8Pko/Gkg82tlgtr\"}};var M,N,E=function(e,t,i,n){return new(i||(i=Promise))(function(a,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}l((n=n.apply(e,t||[])).next())})};class O{constructor(e,t,i){this.scriptLoader=e,this.braintreeHostWindow=t,this.braintreeSDKVersionManager=i}loadClient(){return E(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(w.Client,\"client.min.js\")})}loadFastlane(){return E(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(w.Fastlane,\"fastlane.min.js\")})}loadPaypalCheckout(){return E(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(w.PaypalCheckout,\"paypal-checkout.min.js\")})}loadPaypal(){return E(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(w.Paypal,\"paypal.min.js\")})}loadLocalPayment(){return E(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(w.LocalPayment,\"local-payment.min.js\")})}loadDataCollector(){return E(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(w.DataCollector,\"data-collector.min.js\")})}loadUsBankAccount(){return E(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(w.UsBankAccount,\"us-bank-account.min.js\")})}loadGooglePayment(){return E(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(w.GooglePayment,\"google-payment.min.js\")})}load3DS(){return E(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(w.ThreeDSecure,\"three-d-secure.min.js\")})}loadVisaCheckout(){return this.loadBraintreeModuleOrThrow(w.VisaCheckout,\"visa-checkout.min.js\")}loadVenmoCheckout(){return this.loadBraintreeModuleOrThrow(w.Venmo,\"venmo.min.js\")}loadHostedFields(){return E(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(w.HostedFields,\"hosted-fields.min.js\")})}loadVisaCheckoutSdk(e){return E(this,void 0,void 0,function*(){if(this.braintreeHostWindow.V)return this.braintreeHostWindow.V;const t=e?\"sha384-0eu1s1GtqzXlL9DtLgmwzC5WWlEH/ADRM0n38cVQkvtT+W/gey96rcb1LwuUOPDm\":\"sha384-1f1csvP3ZFxg4dILH1GaY4LHlZ0oX7Rk83rxmLlwbnIi4TM0NYzXoev1VoEiVDS6\";return this.scriptLoader.loadScript(`//${e?\"sandbox-\":\"\"}assets.secure.checkout.visa.com/checkout-widget/resources/js/integration/v1/sdk.js`,{async:!0,attributes:{integrity:t,crossorigin:\"anonymous\"}}).then(()=>{if(!this.braintreeHostWindow.V)throw new k;return this.braintreeHostWindow.V})})}loadBraintreeModuleOrThrow(e,t){return E(this,void 0,void 0,function*(){let i=this.getBraintreeModule(e);if(i)return i;const n=this.braintreeSDKVersionManager.getSDKVersion(),a=`//js.braintreegateway.com/web/${n}/js/${t}`,o=n in A?this.getIntegrityValuesByModuleName(e,n):void 0;if(yield this.scriptLoader.loadScript(a,o?{async:!0,attributes:{integrity:o,crossorigin:\"anonymous\"}}:void 0),i=this.getBraintreeModule(e),!i)throw new k;return i})}getBraintreeModule(e){var t;return null===(t=this.braintreeHostWindow.braintree)||void 0===t?void 0:t[e]}getIntegrityValuesByModuleName(e,t){const i=A[t][e];if(!i)throw new Error(\"Unexpected fileName value\");return i}}function D(e,t){return Object.assign(e,{resolveIds:t})}!function(e){e[e.MissingBillingAddress=0]=\"MissingBillingAddress\",e[e.MissingCart=1]=\"MissingCart\",e[e.MissingCheckout=2]=\"MissingCheckout\",e[e.MissingConsignments=3]=\"MissingConsignments\",e[e.MissingCustomer=4]=\"MissingCustomer\",e[e.MissingCheckoutConfig=5]=\"MissingCheckoutConfig\",e[e.MissingOrder=6]=\"MissingOrder\",e[e.MissingOrderConfig=7]=\"MissingOrderConfig\",e[e.MissingOrderId=8]=\"MissingOrderId\",e[e.MissingPayment=9]=\"MissingPayment\",e[e.MissingPaymentId=10]=\"MissingPaymentId\",e[e.MissingPaymentInstrument=11]=\"MissingPaymentInstrument\",e[e.MissingPaymentMethod=12]=\"MissingPaymentMethod\",e[e.MissingPaymentRedirectUrl=13]=\"MissingPaymentRedirectUrl\",e[e.MissingPaymentStatus=14]=\"MissingPaymentStatus\",e[e.MissingPaymentToken=15]=\"MissingPaymentToken\",e[e.MissingShippingAddress=16]=\"MissingShippingAddress\"}(M||(M={}));class B extends h{constructor(e){super(function(e){switch(e){case M.MissingBillingAddress:return\"Unable to proceed because billing address data is unavailable.\";case M.MissingCart:return\"Unable to proceed because cart data is unavailable.\";case M.MissingConsignments:return\"Unable to proceed because consignments data is unavailable.\";case M.MissingCheckout:return\"Unable to proceed because checkout data is unavailable.\";case M.MissingCustomer:return\"Unable to proceed because customer data is unavailable.\";case M.MissingCheckoutConfig:case M.MissingOrderConfig:return\"Unable to proceed because configuration data is unavailable.\";case M.MissingOrder:return\"Unable to proceed because order data is unavailable.\";case M.MissingOrderId:return\"Unable to proceed because order ID is unavailable or not generated yet.\";case M.MissingPayment:return\"Unable to proceed because payment data is unavailable.\";case M.MissingPaymentToken:return\"Unable to proceed because the token required to submit a payment is missing.\";case M.MissingPaymentMethod:return\"Unable to proceed because payment method data is unavailable or not properly configured.\";case M.MissingShippingAddress:return\"Unable to proceed because shipping address data is unavailable.\";default:return\"Unable to proceed because the required data is unavailable.\"}}(e)),this.subtype=e,this.name=\"MissingDataError\",this.type=\"missing_data\"}}class L extends h{constructor(e){super(e||\"Not implemented.\"),this.name=\"NotImplementedError\",this.type=\"not_implemented\"}}class z extends h{constructor(e){super(e||\"Invalid arguments have been provided.\"),this.name=\"InvalidArgumentError\",this.type=\"invalid_argument\"}}class x extends h{constructor(e){super(e||\"Payment process was cancelled.\"),this.name=\"PaymentMethodCancelledError\",this.type=\"payment_cancelled\"}}!function(e){e.BRAINTREE=\"braintree\",e.BRAINTREE_FASTLANE=\"braintreeacceleratedcheckout\"}(N||(N={}));var U,F=function(e,t,i,n){return new(i||(i=Promise))(function(a,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}l((n=n.apply(e,t||[])).next())})};!function(e){e.Subtotal=\"Subtotal\",e.Shipping=\"Shipping\"}(U||(U={}));class R{constructor(e,t,i,n,o){this._requestSender=e,this._paymentIntegrationService=t,this._sessionFactory=i,this._braintreeSdk=n,this._applePayScriptLoader=o,this._onAuthorizeCallback=lodash__WEBPACK_IMPORTED_MODULE_2__.noop,this._onError=lodash__WEBPACK_IMPORTED_MODULE_2__.noop,this._onClick=lodash__WEBPACK_IMPORTED_MODULE_2__.noop,this._subTotalLabel=U.Subtotal,this._shippingLabel=U.Shipping,this._hasApplePaySession=!1}initialize(e){var t;return F(this,void 0,void 0,function*(){const{methodId:i,applepay:n}=e;if(!i||!n)throw new B(M.MissingPaymentMethod);const{container:o,shippingLabel:r,subtotalLabel:s,onError:l=lodash__WEBPACK_IMPORTED_MODULE_2__.noop,onClick:d=lodash__WEBPACK_IMPORTED_MODULE_2__.noop,onPaymentAuthorize:c}=n;this._shippingLabel=r||U.Shipping,this._subTotalLabel=s||U.Subtotal,this._onAuthorizeCallback=c,this._onError=l,this._onClick=d;let h=this._paymentIntegrationService.getState();yield this._applePayScriptLoader.loadSdk();try{this._paymentMethod=h.getPaymentMethodOrThrow(i)}catch(e){h=yield this._paymentIntegrationService.loadPaymentMethod(i),this._paymentMethod=h.getPaymentMethodOrThrow(i)}yield this._paymentIntegrationService.verifyCheckoutSpamProtection(),this._applePayButton=this._createButton(o),this._applePayButton.addEventListener(\"click\",this._handleWalletButtonClick.bind(this)),(null===(t=this._paymentMethod.initializationData)||void 0===t?void 0:t.gateway)===N.BRAINTREE&&(yield this._initializeBraintreeSdk())})}deinitialize(){return Promise.resolve()}signIn(){throw new L('In order to sign in via Apple, the shopper must click on \"Apple Pay\" button.')}signOut(){throw new L(\"Need to do signout via apple.\")}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}_createButton(e){const t=document.getElementById(e);if(!t)throw new z(\"Unable to create sign-in button without valid container ID.\");const i=this._createApplePayButtonElement();return t.appendChild(i),i}_createApplePayButtonElement(){const e=document.createElement(\"apple-pay-button\");return e.setAttribute(\"buttonstyle\",\"black\"),e.setAttribute(\"type\",\"plain\"),e.setAttribute(\"style\",\"--apple-pay-button-width: 100%; --apple-pay-button-height: 36px; --apple-pay-button-border-radius: 4px;\"),e}_handleWalletButtonClick(e){if(e.preventDefault(),this._hasApplePaySession)return;this._onClick();const t=this._paymentIntegrationService.getState(),i=t.getCartOrThrow(),n=t.getStoreConfigOrThrow(),a=t.getCheckoutOrThrow();if(!this._paymentMethod||!this._paymentMethod.initializationData)throw new B(M.MissingPaymentMethod);const o=this._getBaseRequest(i,a,n,this._paymentMethod),r=this._sessionFactory.create(o);this._handleApplePayEvents(r,this._paymentMethod,n),r.begin(),this._hasApplePaySession=!0}_getBaseRequest(e,t,i,n){var a;const{storeProfile:{storeCountryCode:o,storeName:r}}=i,{currency:{code:s,decimalPlaces:l}}=e,{initializationData:{merchantCapabilities:d,supportedNetworks:c}}=n,h=e.lineItems.physicalItems.length>0,u={requiredBillingContactFields:[\"postalAddress\"],requiredShippingContactFields:[\"email\",\"phone\"],countryCode:o,currencyCode:s,merchantCapabilities:d,supportedNetworks:c,lineItems:[],total:h?{label:r,amount:`${t.grandTotal.toFixed(l)}`,type:\"pending\"}:{label:r,amount:`${t.grandTotal.toFixed(l)}`,type:\"final\"}};if(h)null===(a=u.requiredShippingContactFields)||void 0===a||a.push(\"postalAddress\");else{const e=[{label:this._subTotalLabel,amount:`${t.subtotal.toFixed(l)}`}];t.taxes.forEach(t=>e.push({label:t.name,amount:`${t.amount.toFixed(l)}`})),u.lineItems=e}return u}_handleApplePayEvents(e,t,i){e.onvalidatemerchant=i=>F(this,void 0,void 0,function*(){try{const{body:n}=yield this._onValidateMerchant(t,i);e.completeMerchantValidation(n)}catch(e){this._onError(e)}}),e.onshippingcontactselected=t=>F(this,void 0,void 0,function*(){return this._handleShippingContactSelected(e,i,t)}),e.onshippingmethodselected=t=>F(this,void 0,void 0,function*(){return this._handleShippingMethodSelected(e,i,t)}),e.oncancel=()=>F(this,void 0,void 0,function*(){this._hasApplePaySession=!1;try{const e=`/remote-checkout/${t.id}/signout`;return yield this._requestSender.get(e),yield this._paymentIntegrationService.loadCheckout()}catch(e){return this._onError(new x)}}),e.onpaymentauthorized=i=>F(this,void 0,void 0,function*(){return this._onPaymentAuthorized(i,e,t)})}_handleShippingContactSelected(e,t,i){var n;return F(this,void 0,void 0,function*(){const a=this._transformContactToAddress(i.shippingContact);try{yield this._paymentIntegrationService.updateShippingAddress(a)}catch(t){return e.abort(),this._hasApplePaySession=!1,this._onError(t)}const{storeProfile:{storeName:o}}=t;let r=this._paymentIntegrationService.getState();const{currency:{decimalPlaces:s}}=r.getCartOrThrow();let l=r.getCheckoutOrThrow();const d=null===(n=l.consignments[0].selectedShippingOption)||void 0===n?void 0:n.id,c=l.consignments[0].availableShippingOptions,h=null==c?void 0:c.find(({id:e})=>e===d),u=null==c?void 0:c.filter(e=>e.id!==d),p=h?[{label:h.description,amount:`${h.cost.toFixed(s)}`,detail:h.additionalDescription,identifier:h.id}]:[];if(u&&[...u.filter(e=>e.isRecommended),...u.filter(e=>!e.isRecommended)].forEach(e=>p.push({label:e.description,amount:`${e.cost.toFixed(s)}`,detail:e.additionalDescription,identifier:e.id})),!(c instanceof Array))throw new Error(\"Shipping options not available.\");if(0===c.length)return void e.completeShippingContactSelection(ApplePaySession.STATUS_INVALID_SHIPPING_POSTAL_ADDRESS,[],{type:\"pending\",label:o,amount:`${l.grandTotal.toFixed(s)}`},[]);const m=c.find(e=>e.isRecommended),y=m?m.id:c[0].id,g=h?h.id:y;try{yield this._updateShippingOption(g)}catch(e){return this._onError(e)}r=this._paymentIntegrationService.getState(),l=r.getCheckoutOrThrow(),e.completeShippingContactSelection({newShippingMethods:p,newTotal:{type:\"final\",label:o,amount:`${l.grandTotal.toFixed(s)}`},newLineItems:this._getUpdatedLineItems(l,s)})})}_handleShippingMethodSelected(e,t,i){return F(this,void 0,void 0,function*(){const{storeProfile:{storeName:n}}=t,{shippingMethod:{identifier:a}}=i;try{yield this._updateShippingOption(a)}catch(t){return e.abort(),this._hasApplePaySession=!1,this._onError(t)}const o=this._paymentIntegrationService.getState(),{currency:{decimalPlaces:r}}=o.getCartOrThrow(),s=o.getCheckoutOrThrow();e.completeShippingMethodSelection({newTotal:{type:\"final\",label:n,amount:`${s.grandTotal.toFixed(r)}`},newLineItems:this._getUpdatedLineItems(s,r)})})}_getUpdatedLineItems(e,t){const i=[{label:this._subTotalLabel,amount:`${e.subtotal.toFixed(t)}`}];return e.taxes.forEach(e=>i.push({label:e.name,amount:`${e.amount.toFixed(t)}`})),i.push({label:this._shippingLabel,amount:`${e.shippingCostTotal.toFixed(t)}`}),i}_updateShippingOption(e){return F(this,void 0,void 0,function*(){return this._paymentIntegrationService.selectShippingOption(e)})}_onValidateMerchant(e,t){return F(this,void 0,void 0,function*(){const i=[`validationUrl=${t.validationURL}`,`merchantIdentifier=${e.initializationData.merchantId}`,`displayName=${e.initializationData.storeName}`,`domainName=${window.location.hostname}`].join(\"&\");return this._requestSender.post(`${e.initializationData.paymentsUrl}/api/public/v1/payments/applepay/validate_merchant`,{credentials:!1,headers:{Accept:\"application/json\",\"Content-Type\":\"application/x-www-form-urlencoded\",\"X-XSRF-TOKEN\":null},body:i})})}_onPaymentAuthorized(e,t,i){var n;return F(this,void 0,void 0,function*(){const{token:a,billingContact:o,shippingContact:r}=e.payment,s=this._paymentIntegrationService.getState().getCartOrThrow().lineItems.physicalItems.length>0;let l;(null===(n=i.initializationData)||void 0===n?void 0:n.gateway)===N.BRAINTREE&&(l=yield this._getBraintreeDeviceData());const d={methodId:i.id,paymentData:{deviceSessionId:l,formattedPayload:{apple_pay_token:{payment_data:a.paymentData,payment_method:a.paymentMethod,transaction_id:a.transactionIdentifier}}}},c=this._transformContactToAddress(o),h=this._transformContactToAddress(r),u=null==r?void 0:r.emailAddress,p=(null==r?void 0:r.phoneNumber)||\"\";try{return yield this._paymentIntegrationService.updateBillingAddress(Object.assign(Object.assign({},c),{email:u,phone:p})),s&&(yield this._paymentIntegrationService.updateShippingAddress(h)),yield this._paymentIntegrationService.submitOrder({useStoreCredit:!1}),yield this._paymentIntegrationService.submitPayment(d),t.completePayment(ApplePaySession.STATUS_SUCCESS),this._onAuthorizeCallback()}catch(e){return t.completePayment(ApplePaySession.STATUS_FAILURE),this._onError(e)}})}_transformContactToAddress(e){return{firstName:(null==e?void 0:e.givenName)||\"\",lastName:(null==e?void 0:e.familyName)||\"\",city:(null==e?void 0:e.locality)||\"\",company:\"\",address1:(null==e?void 0:e.addressLines)&&e.addressLines[0]||\"\",address2:(null==e?void 0:e.addressLines)&&e.addressLines[1]||\"\",postalCode:(null==e?void 0:e.postalCode)||\"\",countryCode:(null==e?void 0:e.countryCode)||\"\",phone:(null==e?void 0:e.phoneNumber)||\"\",stateOrProvince:(null==e?void 0:e.administrativeArea)||\"\",stateOrProvinceCode:(null==e?void 0:e.administrativeArea)||\"\",customFields:[]}}_getBraintreeDeviceData(){return F(this,void 0,void 0,function*(){try{const{deviceData:e}=yield this._braintreeSdk.getDataCollectorOrThrow();return e}catch(e){}})}_initializeBraintreeSdk(){return F(this,void 0,void 0,function*(){yield this._paymentIntegrationService.loadPaymentMethod(N.BRAINTREE);const e=this._paymentIntegrationService.getState().getPaymentMethod(N.BRAINTREE);e&&e.clientToken&&e.initializationData&&this._braintreeSdk.initialize(e.clientToken)})}}function V(e){if(!function(e){return\"ApplePaySession\"in e}(e))throw new Error(\"Apple pay is not supported\")}class j{create(e){return V(window),new ApplePaySession(1,e)}}class q{constructor(e){this.scriptLoader=e,this.sdkVersion=\"1.latest\"}loadSdk(){return e=this,t=void 0,n=function*(){yield this.scriptLoader.loadScript(`https://applepay.cdn-apple.com/jsapi/${this.sdkVersion}/apple-pay-sdk.js`),V(window)},new((i=void 0)||(i=Promise))(function(a,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}l((n=n.apply(e,t||[])).next())});// removed by dead control flow\n var e, t, i, n; }}const H=D(n=>{const{getHost:a}=n.getState(),o=new c(n);return new R((0,_bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_0__.createRequestSender)({host:a()}),n,new j,new T(new O((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),window,o)),new q(new _bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.ScriptLoader))},[{id:\"applepay\"}]);class W extends z{constructor(e){let t=\"Unable to submit payment for the order because the payload is invalid.\";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(\", \")}.`),super(t),this.name=\"PaymentArgumentInvalidError\"}}class G extends h{constructor(){super(\"The current order does not need to be finalized at this stage.\"),this.name=\"OrderFinalizationNotRequiredError\",this.type=\"order_finalization_not_required\"}}var $,K=function(e,t,i,n){return new(i||(i=Promise))(function(a,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}l((n=n.apply(e,t||[])).next())})};!function(e){e.Shipping=\"Shipping\",e.Subtotal=\"Subtotal\",e.StoreCredit=\"Store Credit\"}($||($={}));class X{constructor(e,t,i,n,a){this._requestSender=e,this._paymentIntegrationService=t,this._sessionFactory=i,this._braintreeSdk=n,this._applePayScriptLoader=a,this._shippingLabel=$.Shipping,this._subTotalLabel=$.Subtotal,this._storeCreditLabel=$.StoreCredit}initialize(e){var t,i,n,a;return K(this,void 0,void 0,function*(){if(!(null==e?void 0:e.methodId))throw new z('Unable to submit payment because \"options.methodId\" argument is not provided.');const{methodId:o}=e;yield this._applePayScriptLoader.loadSdk(),this._shippingLabel=(null===(t=e.applepay)||void 0===t?void 0:t.shippingLabel)||$.Shipping,this._subTotalLabel=(null===(i=e.applepay)||void 0===i?void 0:i.subtotalLabel)||$.Subtotal,this._storeCreditLabel=(null===(n=e.applepay)||void 0===n?void 0:n.storeCreditLabel)||$.StoreCredit;const r=(yield this._paymentIntegrationService.loadPaymentMethod(o)).getPaymentMethodOrThrow(o);(null===(a=r.initializationData)||void 0===a?void 0:a.gateway)===N.BRAINTREE&&(yield this._initializeBraintreeSdk())})}execute(e,t){return K(this,void 0,void 0,function*(){const{payment:i}=e,n=this._paymentIntegrationService.getState();if(!i)throw new W([\"payment\"]);const{methodId:a}=i,o=n.getPaymentMethodOrThrow(a),r=this._getBaseRequest(n,o),s=this._sessionFactory.create(r);return yield this._paymentIntegrationService.submitOrder({useStoreCredit:e.useStoreCredit},t),s.begin(),new Promise((e,t)=>{this._handleApplePayEvents(s,o,{resolve:e,reject:t})})})}finalize(){return Promise.reject(new G)}deinitialize(){return Promise.resolve()}_getBaseRequest(e,t){const i=e.getCheckoutOrThrow(),n=e.getCartOrThrow(),a=e.getStoreConfigOrThrow(),{storeProfile:{storeCountryCode:o,storeName:r}}=a,{currency:{code:s,decimalPlaces:l}}=n,{initializationData:{merchantCapabilities:d,supportedNetworks:c}}=t,{grandTotal:h,isStoreCreditApplied:u,outstandingBalance:p}=i,m=[{label:this._subTotalLabel,amount:`${i.subtotal.toFixed(l)}`}];if(i.taxes.forEach(e=>m.push({label:e.name,amount:`${e.amount.toFixed(l)}`})),m.push({label:this._shippingLabel,amount:`${i.shippingCostTotal.toFixed(l)}`}),u){const{storeCredit:t}=e.getCustomerOrThrow();m.push({label:this._storeCreditLabel,amount:`-${Math.min(h,t).toFixed(l)}`})}return{countryCode:o,currencyCode:s,merchantCapabilities:d,supportedNetworks:c,lineItems:m,total:{label:r,amount:`${p.toFixed(l)}`,type:\"final\"}}}_handleApplePayEvents(e,t,i){e.onvalidatemerchant=i=>K(this,void 0,void 0,function*(){try{const{body:n}=yield this._onValidateMerchant(t,i);e.completeMerchantValidation(n)}catch(e){throw new Error(\"Merchant validation failed\")}}),e.oncancel=()=>K(this,void 0,void 0,function*(){return i.reject(new x(\"Continue with applepay\"))}),e.onpaymentauthorized=n=>this._onPaymentAuthorized(n,e,t,i)}_onValidateMerchant(e,t){return K(this,void 0,void 0,function*(){const i=[`validationUrl=${t.validationURL}`,`merchantIdentifier=${e.initializationData.merchantId}`,`displayName=${e.initializationData.storeName}`,`domainName=${window.location.hostname}`].join(\"&\");return this._requestSender.post(`${e.initializationData.paymentsUrl}/api/public/v1/payments/applepay/validate_merchant`,{credentials:!1,headers:{Accept:\"application/json\",\"Content-Type\":\"application/x-www-form-urlencoded\",\"X-XSRF-TOKEN\":null},body:i})})}_onPaymentAuthorized(e,t,i,n){var a;return K(this,void 0,void 0,function*(){const{token:o}=e.payment;let r;(null===(a=i.initializationData)||void 0===a?void 0:a.gateway)===N.BRAINTREE&&(r=yield this._getBraintreeDeviceData());const s={methodId:i.id,paymentData:{deviceSessionId:r,formattedPayload:{apple_pay_token:{payment_data:o.paymentData,payment_method:o.paymentMethod,transaction_id:o.transactionIdentifier}}}};try{return yield this._paymentIntegrationService.submitPayment(s),t.completePayment(ApplePaySession.STATUS_SUCCESS),n.resolve()}catch(e){return t.completePayment(ApplePaySession.STATUS_FAILURE),n.reject(new f(p.PaymentNotInitialized))}})}_getBraintreeDeviceData(){return K(this,void 0,void 0,function*(){try{const{deviceData:e}=yield this._braintreeSdk.getDataCollectorOrThrow();return e}catch(e){}})}_initializeBraintreeSdk(){return K(this,void 0,void 0,function*(){const e=this._paymentIntegrationService.getState();let t=e.getPaymentMethod(N.BRAINTREE_FASTLANE)||e.getPaymentMethod(N.BRAINTREE);t||(yield this._paymentIntegrationService.loadPaymentMethod(N.BRAINTREE),t=e.getPaymentMethod(N.BRAINTREE)),t&&t.clientToken&&t.initializationData&&this._braintreeSdk.initialize(t.clientToken)})}}const Y=D(n=>{const{getHost:a}=n.getState(),o=new c(n);return new X((0,_bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_0__.createRequestSender)({host:a()}),n,new j,new T(new O((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),window,o)),new q(new _bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.ScriptLoader))},[{id:\"applepay\"}]);class Q extends h{constructor(e){super(e||\"An unexpected error has occurred during buy now cart creation process. Please try again later.\"),this.name=\"BuyNowCartCreationError\",this.type=\"buy_now_cart_creation_error\"}}var Z,J,ee=function(e,t,i,n){return new(i||(i=Promise))(function(a,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function s(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}l((n=n.apply(e,t||[])).next())})};!function(e){e.Subtotal=\"Subtotal\",e.Shipping=\"Shipping\"}(Z||(Z={})),function(e){e.Black=\"black\",e.White=\"white\",e.WhiteBorder=\"white-border\"}(J||(J={}));class te{constructor(e,t,i,n,o){this._requestSender=e,this._paymentIntegrationService=t,this._sessionFactory=i,this._braintreeSdk=n,this._applePayScriptLoader=o,this._onAuthorizeCallback=lodash__WEBPACK_IMPORTED_MODULE_2__.noop,this._subTotalLabel=Z.Subtotal,this._shippingLabel=Z.Shipping}initialize(e){var t,i;return ee(this,void 0,void 0,function*(){const{methodId:n,containerId:a,applepay:o}=e;if(!n||!o)throw new B(M.MissingPaymentMethod);yield this._applePayScriptLoader.loadSdk();const{onPaymentAuthorize:r,buyNowInitializeOptions:s,requiresShipping:l}=o;this._requiresShipping=l,this._buyNowInitializeOptions=s,this._onAuthorizeCallback=r,s||(yield this._paymentIntegrationService.loadDefaultCheckout()),yield this._paymentIntegrationService.loadPaymentMethod(n);const d=this._paymentIntegrationService.getState();return this._paymentMethod=d.getPaymentMethodOrThrow(n),d.getCart()&&(yield this._paymentIntegrationService.verifyCheckoutSpamProtection()),(null===(t=this._paymentMethod.initializationData)||void 0===t?void 0:t.gateway)===N.BRAINTREE&&(yield this._initializeBraintreeSdk()),this._applePayButton=this._createButton(a,null===(i=this._paymentMethod.initializationData)||void 0===i?void 0:i.styleOption),this._applePayButton.addEventListener(\"click\",this._handleWalletButtonClick.bind(this)),Promise.resolve()})}deinitialize(){return Promise.resolve()}_createButton(e,t){const i=document.getElementById(e);if(!i)throw new z(\"Unable to create wallet button without valid container ID.\");const n=this._createApplePayButtonElement(t);return i.appendChild(n),n}_createApplePayButtonElement(e){const t=document.createElement(\"apple-pay-button\");return t.setAttribute(\"buttonstyle\",(e=>{switch(e){case J.White:return\"white\";case J.WhiteBorder:return\"white-outline\";case J.Black:default:return\"black\"}})(e)),t.setAttribute(\"type\",\"plain\"),t.setAttribute(\"style\",\"--apple-pay-button-width: 100%; --apple-pay-button-height: 40px; --apple-pay-button-border-radius: 4px;\"),t}_handleWalletButtonClick(e){var t;return ee(this,void 0,void 0,function*(){if(e.preventDefault(),!this._paymentMethod||!this._paymentMethod.initializationData)throw new B(M.MissingPaymentMethod);if(this._buyNowInitializeOptions&&\"function\"==typeof this._buyNowInitializeOptions.getBuyNowCartRequestBody){const{countryCode:e,currencyCode:i,merchantCapabilities:n,supportedNetworks:a,storeName:o}=this._paymentMethod.initializationData,r=this._getRequestWithEmptyTotal(e,i,a,n);this._requiresShipping&&(null===(t=r.requiredShippingContactFields)||void 0===t||t.push(\"postalAddress\"));const s=this._sessionFactory.create(r);this._handleApplePayEvents(s,this._paymentMethod,o),s.begin()}else{const e=this._paymentIntegrationService.getState(),t=e.getCartOrThrow(),i=e.getStoreConfigOrThrow(),n=e.getCheckoutOrThrow(),a=this._getBaseRequest(t,n,i,this._paymentMethod),o=this._sessionFactory.create(a);this._handleApplePayEvents(o,this._paymentMethod,i.storeProfile.storeName),o.begin()}})}_getRequestWithEmptyTotal(e,t,i,n){return{countryCode:e,currencyCode:t,supportedNetworks:i,merchantCapabilities:n,total:{label:\"\",amount:\"0\",type:\"pending\"},requiredBillingContactFields:[\"postalAddress\"],requiredShippingContactFields:[\"email\",\"phone\"]}}_getBaseRequest(e,t,i,n){var a;const{storeProfile:{storeCountryCode:o,storeName:r}}=i,{currency:{code:s,decimalPlaces:l}}=e,{initializationData:{merchantCapabilities:d,supportedNetworks:c}}=n,h=e.lineItems.physicalItems.length>0,u={requiredBillingContactFields:[\"postalAddress\"],requiredShippingContactFields:[\"email\",\"phone\"],countryCode:o,currencyCode:s,merchantCapabilities:d,supportedNetworks:c,lineItems:[],total:h?{label:r,amount:`${t.grandTotal.toFixed(l)}`,type:\"pending\"}:{label:r,amount:`${t.grandTotal.toFixed(l)}`,type:\"final\"}};if(h)null===(a=u.requiredShippingContactFields)||void 0===a||a.push(\"postalAddress\");else{const e=[{label:this._subTotalLabel,amount:`${t.subtotal.toFixed(l)}`}];t.taxes.forEach(t=>e.push({label:t.name,amount:`${t.amount.toFixed(l)}`})),u.lineItems=e}return u}_handleApplePayEvents(e,t,i){e.onvalidatemerchant=i=>ee(this,void 0,void 0,function*(){try{const{body:n}=yield this._onValidateMerchant(t,i);e.completeMerchantValidation(n)}catch(e){throw new Error(\"Merchant validation failed\")}}),this._buyNowInitializeOptions&&!this._requiresShipping&&(e.onpaymentmethodselected=()=>ee(this,void 0,void 0,function*(){yield this._createBuyNowCart(),this._handlePaymentMethodSelected(e)})),e.onshippingcontactselected=t=>ee(this,void 0,void 0,function*(){this._buyNowInitializeOptions&&this._requiresShipping&&(yield this._createBuyNowCart()),yield this._handleShippingContactSelected(e,i,t)}),e.onshippingmethodselected=t=>ee(this,void 0,void 0,function*(){yield this._handleShippingMethodSelected(e,i,t)}),e.oncancel=()=>ee(this,void 0,void 0,function*(){try{const e=`/remote-checkout/${t.id}/signout`;return yield this._requestSender.get(e),yield this._paymentIntegrationService.loadCheckout()}catch(e){throw new x}}),e.onpaymentauthorized=i=>ee(this,void 0,void 0,function*(){return this._onPaymentAuthorized(i,e,t)})}_createBuyNowCart(){var e,t;return ee(this,void 0,void 0,function*(){try{const i=null===(t=null===(e=this._buyNowInitializeOptions)||void 0===e?void 0:e.getBuyNowCartRequestBody)||void 0===t?void 0:t.call(e);if(!i)throw new B(M.MissingCart);const n=yield this._paymentIntegrationService.createBuyNowCart(i);yield this._paymentIntegrationService.loadCheckout(n.id);const a=this._paymentIntegrationService.getState(),{shouldExecuteSpamCheck:o}=a.getCheckoutOrThrow();o&&(yield this._paymentIntegrationService.verifyCheckoutSpamProtection())}catch(e){throw new Q}})}_handlePaymentMethodSelected(e){const t=this._paymentIntegrationService.getState(),i=t.getCartOrThrow(),n=t.getStoreConfigOrThrow(),a=t.getCheckoutOrThrow();if(!this._paymentMethod||!this._paymentMethod.initializationData)throw new B(M.MissingPaymentMethod);const o=this._getBaseRequest(i,a,n,this._paymentMethod);delete o.total.type,e.completePaymentMethodSelection({newTotal:o.total,newLineItems:o.lineItems})}_handleShippingContactSelected(e,t,i){var n;return ee(this,void 0,void 0,function*(){const a=this._transformContactToAddress(i.shippingContact);try{yield this._paymentIntegrationService.updateShippingAddress(a)}catch(t){throw e.abort(),new Error(\"Shipping address update failed\")}let o=this._paymentIntegrationService.getState();const{currency:{decimalPlaces:r}}=o.getCartOrThrow();let s=o.getCheckoutOrThrow();const l=null===(n=s.consignments[0].selectedShippingOption)||void 0===n?void 0:n.id,d=s.consignments[0].availableShippingOptions,c=null==d?void 0:d.find(({id:e})=>e===l),h=null==d?void 0:d.filter(e=>e.id!==l),u=c?[{label:c.description,amount:`${c.cost.toFixed(r)}`,detail:c.additionalDescription,identifier:c.id}]:[];if(h&&[...h.filter(e=>e.isRecommended),...h.filter(e=>!e.isRecommended)].forEach(e=>u.push({label:e.description,amount:`${e.cost.toFixed(r)}`,detail:e.additionalDescription,identifier:e.id})),!(d instanceof Array))throw new Error(\"Shipping options not available.\");if(0===d.length)return void e.completeShippingContactSelection(ApplePaySession.STATUS_INVALID_SHIPPING_POSTAL_ADDRESS,[],{type:\"pending\",label:t,amount:`${s.grandTotal.toFixed(r)}`},[]);const p=d.find(e=>e.isRecommended),m=p?p.id:d[0].id,y=c?c.id:m;try{yield this._updateShippingOption(y)}catch(e){throw new Error(\"Shipping options update failed\")}o=this._paymentIntegrationService.getState(),s=o.getCheckoutOrThrow(),e.completeShippingContactSelection({newShippingMethods:u,newTotal:{type:\"final\",label:t,amount:`${s.grandTotal.toFixed(r)}`},newLineItems:this._getUpdatedLineItems(s,r)})})}_handleShippingMethodSelected(e,t,i){return ee(this,void 0,void 0,function*(){const{shippingMethod:{identifier:n}}=i;try{yield this._updateShippingOption(n)}catch(t){throw e.abort(),new Error(\"Shipping option selection update failed.\")}const a=this._paymentIntegrationService.getState(),{currency:{decimalPlaces:o}}=a.getCartOrThrow(),r=a.getCheckoutOrThrow();e.completeShippingMethodSelection({newTotal:{type:\"final\",label:t,amount:`${r.grandTotal.toFixed(o)}`},newLineItems:this._getUpdatedLineItems(r,o)})})}_getUpdatedLineItems(e,t){const i=[{label:this._subTotalLabel,amount:`${e.subtotal.toFixed(t)}`}];return e.taxes.forEach(e=>i.push({label:e.name,amount:`${e.amount.toFixed(t)}`})),i.push({label:this._shippingLabel,amount:`${e.shippingCostTotal.toFixed(t)}`}),i}_updateShippingOption(e){return ee(this,void 0,void 0,function*(){return this._paymentIntegrationService.selectShippingOption(e)})}_onValidateMerchant(e,t){return ee(this,void 0,void 0,function*(){const i=[`validationUrl=${t.validationURL}`,`merchantIdentifier=${e.initializationData.merchantId}`,`displayName=${e.initializationData.storeName}`,`domainName=${window.location.hostname}`].join(\"&\");return this._requestSender.post(`${e.initializationData.paymentsUrl}/api/public/v1/payments/applepay/validate_merchant`,{credentials:!1,headers:{Accept:\"application/json\",\"Content-Type\":\"application/x-www-form-urlencoded\",\"X-XSRF-TOKEN\":null},body:i})})}_onPaymentAuthorized(e,t,i){var n;return ee(this,void 0,void 0,function*(){const{token:a,billingContact:o,shippingContact:r}=e.payment,s=this._paymentIntegrationService.getState().getCartOrThrow().lineItems.physicalItems.length>0;let l;(null===(n=i.initializationData)||void 0===n?void 0:n.gateway)===N.BRAINTREE&&(l=yield this._getBraintreeDeviceData());const d={methodId:i.id,paymentData:{deviceSessionId:l,formattedPayload:{apple_pay_token:{payment_data:a.paymentData,payment_method:a.paymentMethod,transaction_id:a.transactionIdentifier}}}},c=this._transformContactToAddress(o),h=this._transformContactToAddress(r),u=null==r?void 0:r.emailAddress,p=(null==r?void 0:r.phoneNumber)||\"\";try{return yield this._paymentIntegrationService.updateBillingAddress(Object.assign(Object.assign({},c),{email:u,phone:p})),s&&(yield this._paymentIntegrationService.updateShippingAddress(h)),yield this._paymentIntegrationService.submitOrder({useStoreCredit:!1}),yield this._paymentIntegrationService.submitPayment(d),t.completePayment(ApplePaySession.STATUS_SUCCESS),this._onAuthorizeCallback()}catch(e){throw t.completePayment(ApplePaySession.STATUS_FAILURE),new Error(\"Payment cannot complete\")}})}_transformContactToAddress(e){return{firstName:(null==e?void 0:e.givenName)||\"\",lastName:(null==e?void 0:e.familyName)||\"\",city:(null==e?void 0:e.locality)||\"\",company:\"\",address1:(null==e?void 0:e.addressLines)&&e.addressLines[0]||\"\",address2:(null==e?void 0:e.addressLines)&&e.addressLines[1]||\"\",postalCode:(null==e?void 0:e.postalCode)||\"\",countryCode:(null==e?void 0:e.countryCode)||\"\",phone:(null==e?void 0:e.phoneNumber)||\"\",stateOrProvince:(null==e?void 0:e.administrativeArea)||\"\",stateOrProvinceCode:(null==e?void 0:e.administrativeArea)||\"\",customFields:[]}}_getBraintreeDeviceData(){return ee(this,void 0,void 0,function*(){try{const{deviceData:e}=yield this._braintreeSdk.getDataCollectorOrThrow();return e}catch(e){}})}_initializeBraintreeSdk(){return ee(this,void 0,void 0,function*(){yield this._paymentIntegrationService.loadPaymentMethod(N.BRAINTREE);const e=this._paymentIntegrationService.getState().getPaymentMethod(N.BRAINTREE);e&&e.clientToken&&e.initializationData&&this._braintreeSdk.initialize(e.clientToken)})}}const ie=D(n=>{const{getHost:a}=n.getState(),o=new c(n);return new te((0,_bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_0__.createRequestSender)({host:a()}),n,new j,new T(new O((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),window,o)),new q(new _bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.ScriptLoader))},[{id:\"applepay\"}]);\n//# sourceMappingURL=apple-pay.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vY2hlY2tvdXQtc2RrLWpzL2Rpc3QvZXNtL2ludGVncmF0aW9ucy9hcHBsZS1wYXkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF5TCxTQUFTLHFCQUFxQixNQUFNLHVDQUF1QyxZQUFZLCtEQUErRCx1QkFBdUIsRUFBRSxzREFBc0QsMENBQTBDLFFBQVEsZUFBZSw2REFBNkQsZ0JBQWdCLHNIQUFzSCxxSkFBcUoseUJBQXlCLHVDQUF1QyxNQUFNLFFBQVEsNENBQUMsa0NBQWtDLGtDQUFrQyxzQkFBc0IsZUFBZSxNQUFNLHVUQUF1VCxrQkFBa0IsZUFBZSwyR0FBMkcsb0JBQW9CLGFBQWEseVNBQXlTLFNBQVMsR0FBRyxrQkFBa0IsZUFBZSxrQkFBa0IsVUFBVSx3SEFBd0gsc0hBQXNILHdIQUF3SCw2SEFBNkgsNEZBQTRGLGlGQUFpRixhQUFhLG9GQUFvRixTQUFTLGVBQWUsOERBQThELFNBQVMsZUFBZSxvQkFBb0IsU0FBUyxlQUFlLCtGQUErRixTQUFTLGVBQWUsMEdBQTBHLFNBQVMsZUFBZSxxREFBcUQsU0FBUyxlQUFlLHFQQUFxUCxTQUFTLEdBQUcsOEJBQThCLHlDQUF5QyxjQUFjLElBQUksYUFBYSxTQUFTLE1BQU0sY0FBYyxJQUFJLGNBQWMsU0FBUyxNQUFNLGNBQWMsTUFBTSxnRUFBZ0UsS0FBSyxhQUFhLCtCQUErQixHQUFHLFFBQVEsZUFBZSw2QkFBNkIsY0FBYyx1QkFBdUIsZUFBZSx3Q0FBd0Msd0VBQXdFLEVBQUUsWUFBWSx3Q0FBd0MsaUJBQWlCLHFGQUFxRiw0QkFBNEIsZ0JBQWdCLEVBQUUsbUJBQW1CLEVBQUUsMkJBQTJCLHdDQUF3QyxTQUFTLGtEQUFrRCwyQkFBMkIsdUdBQXVHLGtCQUFrQixJQUFJLHFDQUFxQyxTQUFTLGVBQWUsc0ZBQXNGLHlDQUF5QyxRQUFRLDBCQUEwQixFQUFFLDRCQUE0Qix3Q0FBd0Msd0JBQXdCLGdHQUFnRyxtQ0FBbUMsU0FBUyxFQUFFLDBCQUEwQixFQUFFLHNCQUFzQix3Q0FBd0Msa0JBQWtC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TUFBTSwyQ0FBMkMsMEdBQTBHLE1BQU0sdUhBQXVILFNBQVMsMkJBQTJCLG9DQUFvQyxpQkFBaUIsb0dBQW9HLGdKQUFnSixJQUFJLGdHQUFnRyxLQUFLLGdCQUFnQiwwSEFBMEgsa0JBQWtCLHVJQUF1SSxTQUFTLDhGQUE4RixFQUFFLDhCQUE4QixPQUFPLG9oQkFBb2hCLDBCQUEwQix5Q0FBeUMsSUFBSSxNQUFNLGFBQWEsb0RBQW9ELFNBQVMsV0FBVyxFQUFFLDBCQUEwQix5Q0FBeUMscUVBQXFFLGlGQUFpRixxRkFBcUYsR0FBRyxlQUFlLE1BQU0sVUFBVSx5QkFBeUIsY0FBYyxnRkFBQyxFQUFFLFNBQVMsc0JBQXNCLDJFQUFDLHdCQUF3QixvRUFBQyxHQUFHLEdBQUcsY0FBYyxHQUFxSDtBQUNqOTNDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2hlY2tvdXQvLi4vY2hlY2tvdXQtc2RrLWpzL2Rpc3QvZXNtL2ludGVncmF0aW9ucy9hcHBsZS1wYXkuanM/NTUxZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnR7Y3JlYXRlUmVxdWVzdFNlbmRlciBhcyBlfWZyb21cIkBiaWdjb21tZXJjZS9yZXF1ZXN0LXNlbmRlclwiO2ltcG9ydHtTY3JpcHRMb2FkZXIgYXMgdCxnZXRTY3JpcHRMb2FkZXIgYXMgaX1mcm9tXCJAYmlnY29tbWVyY2Uvc2NyaXB0LWxvYWRlclwiO2ltcG9ydHtmaW5kIGFzIG4sbm9vcCBhcyBhfWZyb21cImxvZGFzaFwiO3ZhciBvPXt9O2Z1bmN0aW9uIHIoZSx0LGk9ITApe3ZhciBuO3JldHVybiBudWxsIT09KG49ZVt0XSkmJnZvaWQgMCE9PW4/bjppfW8uZD0oZSx0KT0+e2Zvcih2YXIgaSBpbiB0KW8ubyh0LGkpJiYhby5vKGUsaSkmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLGkse2VudW1lcmFibGU6ITAsZ2V0OnRbaV19KX0sby5vPShlLHQpPT5PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KTtjb25zdCBzPVwiMy4xMjguMFwiLGw9XCIzLjEyMy4yXCIsZD1cIjMuMTA2LjBcIjtjbGFzcyBje2NvbnN0cnVjdG9yKGUpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlV2luZG93PXdpbmRvd31nZXRTREtWZXJzaW9uKCl7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRTdG9yZUNvbmZpZygpLHQ9KG51bGw9PWU/dm9pZCAwOmUuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcyl8fHt9O3JldHVybiB0aGlzLmdldFByZWxvYWRlZFNES1ZlcnNpb24oKXx8KHIodCxcIlBBWVBBTC01ODA5LmJyYWludHJlZV9ob3N0ZWRfZmllbGRzX2ZpeF92ZXJzaW9uXCIpP3M6cih0LFwiUEFZUEFMLTU2MzYudXBkYXRlX2JyYWludHJlZV9zZGtfdmVyc2lvblwiKT9sOmQpfWdldFByZWxvYWRlZFNES1ZlcnNpb24oKXtjb25zdCBlPXRoaXMuYnJhaW50cmVlV2luZG93LmJyYWludHJlZTtpZihlKXtjb25zdCB0PW4oT2JqZWN0LnZhbHVlcyhlKSxlPT4hIWUuVkVSU0lPTik7cmV0dXJuIG51bGw9PXQ/dm9pZCAwOnQuVkVSU0lPTn19fWNsYXNzIGggZXh0ZW5kcyBFcnJvcntjb25zdHJ1Y3RvcihlKXt2YXIgdDtzdXBlcihlfHxcIkFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFzIG9jY3VycmVkLlwiKSx0aGlzLm5hbWU9XCJTdGFuZGFyZEVycm9yXCIsdGhpcy50eXBlPVwic3RhbmRhcmRcIix0PW5ldy50YXJnZXQucHJvdG90eXBlLE9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyx0KTp0aGlzLl9fcHJvdG9fXz10LFwiZnVuY3Rpb25cIj09dHlwZW9mIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlP0Vycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsbmV3LnRhcmdldCk6dGhpcy5zdGFjaz1uZXcgRXJyb3IodGhpcy5tZXNzYWdlKS5zdGFja319Y2xhc3MgdSBleHRlbmRzIGh7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJVbnN1cHBvcnRlZCBicm93c2VyIGVycm9yXCIpLHRoaXMubmFtZT1cIlVuc3VwcG9ydGVkQnJvd3NlckVycm9yXCIsdGhpcy50eXBlPVwidW5zdXBwb3J0ZWRfYnJvd3NlclwifX12YXIgcCxtLHksZyx2LFMsYixDOyFmdW5jdGlvbihlKXtlW2UuQ2hlY2tvdXRCdXR0b25Ob3RJbml0aWFsaXplZD0wXT1cIkNoZWNrb3V0QnV0dG9uTm90SW5pdGlhbGl6ZWRcIixlW2UuQ3VzdG9tZXJOb3RJbml0aWFsaXplZD0xXT1cIkN1c3RvbWVyTm90SW5pdGlhbGl6ZWRcIixlW2UuUGF5bWVudE5vdEluaXRpYWxpemVkPTJdPVwiUGF5bWVudE5vdEluaXRpYWxpemVkXCIsZVtlLlNoaXBwaW5nTm90SW5pdGlhbGl6ZWQ9M109XCJTaGlwcGluZ05vdEluaXRpYWxpemVkXCIsZVtlLlNwYW1Qcm90ZWN0aW9uTm90SW5pdGlhbGl6ZWQ9NF09XCJTcGFtUHJvdGVjdGlvbk5vdEluaXRpYWxpemVkXCJ9KHB8fChwPXt9KSk7Y2xhc3MgZiBleHRlbmRzIGh7Y29uc3RydWN0b3IoZSl7c3VwZXIoZnVuY3Rpb24oZSl7c3dpdGNoKGUpe2Nhc2UgcC5DdXN0b21lck5vdEluaXRpYWxpemVkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgY3VzdG9tZXIgc3RlcCBvZiBjaGVja291dCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCI7Y2FzZSBwLlBheW1lbnROb3RJbml0aWFsaXplZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHBheW1lbnQgc3RlcCBvZiBjaGVja291dCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCI7Y2FzZSBwLlNoaXBwaW5nTm90SW5pdGlhbGl6ZWQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBzaGlwcGluZyBzdGVwIG9mIGNoZWNrb3V0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtjYXNlIHAuU3BhbVByb3RlY3Rpb25Ob3RJbml0aWFsaXplZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIGNoZWNrb3V0IHNwYW0gcHJvdGVjdGlvbiBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCI7ZGVmYXVsdDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHJlcXVpcmVkIGNvbXBvbmVudCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCJ9fShlKSksdGhpcy5zdWJ0eXBlPWUsdGhpcy5uYW1lPVwiTm90SW5pdGlhbGl6ZWRFcnJvclwiLHRoaXMudHlwZT1cIm5vdF9pbml0aWFsaXplZFwifX0hZnVuY3Rpb24oZSl7ZS5FU1RJTUFURUQ9XCJFU1RJTUFURURcIixlLkZJTkFMPVwiRklOQUxcIixlLk5PVF9DVVJSRU5UTFlfS05PV049XCJOT1RfQ1VSUkVOVExZX0tOT1dOXCJ9KG18fChtPXt9KSksZnVuY3Rpb24oZSl7ZS5Db21wbGV0ZWQ9XCJDT01QTEVURURcIixlLlBlbmRpbmc9XCJQRU5ESU5HXCIsZS5GYWlsZWQ9XCJGQUlMRURcIn0oeXx8KHk9e30pKSxmdW5jdGlvbihlKXtlLlRSVVNUTFk9XCJ0cnVzdGx5XCJ9KGd8fChnPXt9KSksZnVuY3Rpb24oZSl7ZS5TVUNDRUVERUQ9XCJzdWNjZWVkZWRcIixlLkZBSUxFRD1cImZhaWxlZFwiLGUuQ0FOQ0VMRUQ9XCJjYW5jZWxsZWRcIixlLlVOUkVDT0dOSVpFRD1cInVucmVjb2duaXplZFwifSh2fHwodj17fSkpLGZ1bmN0aW9uKGUpe2UuQ3VzdG9tZXI9XCJDVVNUT01FUlwiLGUuTWVyY2hhbnQ9XCJNRVJDSEFOVFwiLGUuTmV0d29yaz1cIk5FVFdPUktcIixlLkludGVybmFsPVwiSU5URVJOQUxcIixlLlVua25vd249XCJVTktOT1dOXCJ9KFN8fChTPXt9KSksZnVuY3Rpb24oZSl7ZS5Lb3VudE5vdEVuYWJsZWQ9XCJEQVRBX0NPTExFQ1RPUl9LT1VOVF9OT1RfRU5BQkxFRFwifShifHwoYj17fSkpLGZ1bmN0aW9uKGUpe2UuVmlzYT1cInZpc2FcIixlLk1hc3RlcmNhcmQ9XCJtYXN0ZXJjYXJkXCIsZS5BbWVyaWNhbkV4cHJlc3M9XCJhbWVyaWNhbi1leHByZXNzXCIsZS5EaW5lcnNDbHViPVwiZGluZXJzLWNsdWJcIixlLkRpc2NvdmVyPVwiZGlzY292ZXJcIixlLkpjYj1cImpjYlwiLGUuVW5pb25QYXk9XCJ1bmlvbi1wYXlcIixlLk1hZXN0cm89XCJtYWVzdHJvXCIsZS5FbG89XCJlbG9cIixlLk1pcj1cIm1pclwiLGUuSGlwZXI9XCJoaXBlclwiLGUuSGlwZXJjYXJkPVwiaGlwZXJjYXJkXCJ9KEN8fChDPXt9KSk7dmFyIF8sdyxQLEk9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24oYSxvKXtmdW5jdGlvbiByKGUpe3RyeXtsKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7bChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBsKGUpe3ZhciB0O2UuZG9uZT9hKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4ocixzKX1sKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgVHtjb25zdHJ1Y3RvcihlKXt0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlcj1lfWluaXRpYWxpemUoZSl7dGhpcy5zZXRDbGllbnRUb2tlbihlKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gSSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy50ZWFyZG93bk1vZHVsZSh0aGlzLmRhdGFDb2xsZWN0b3IpLHRoaXMuZGF0YUNvbGxlY3Rvcj12b2lkIDB9KX1nZXRDbGllbnQoKXtyZXR1cm4gSSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuY2xpZW50KXtjb25zdCBlPXRoaXMuZ2V0Q2xpZW50VG9rZW5PclRocm93KCksdD15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkQ2xpZW50KCk7dGhpcy5jbGllbnQ9eWllbGQgdC5jcmVhdGUoe2F1dGhvcml6YXRpb246ZX0pfXJldHVybiB0aGlzLmNsaWVudH0pfWdldERhdGFDb2xsZWN0b3JPclRocm93KGUpe3JldHVybiBJKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXtkZXZpY2VEYXRhOnZvaWQgMCx0ZWFyZG93bjooKT0+UHJvbWlzZS5yZXNvbHZlKCl9O2lmKCF0aGlzLmRhdGFDb2xsZWN0b3IpdHJ5e2NvbnN0IHQ9eWllbGQgdGhpcy5nZXRDbGllbnQoKSxpPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWREYXRhQ29sbGVjdG9yKCksbj1PYmplY3QuYXNzaWduKHtjbGllbnQ6dCxrb3VudDohMH0sZSk7dGhpcy5kYXRhQ29sbGVjdG9yPXlpZWxkIGkuY3JlYXRlKG4pfWNhdGNoKGUpe2lmKGZ1bmN0aW9uKGUpe3JldHVybiBCb29sZWFuKFwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmKFwidHlwZVwiaW4gZXx8XCJtZXNzYWdlXCJpbiBlfHxcImNvZGVcImluIGUpKX0oZSkmJmUuY29kZT09PWIuS291bnROb3RFbmFibGVkKXJldHVybiB0O3Rocm93IGV9cmV0dXJuIHRoaXMuZGF0YUNvbGxlY3Rvcn0pfWdldEJyYWludHJlZUdvb2dsZVBheW1lbnQoKXtyZXR1cm4gSSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuZ29vZ2xlUGF5bWVudCl7Y29uc3RbZSx0XT15aWVsZCBQcm9taXNlLmFsbChbdGhpcy5nZXRDbGllbnQoKSx0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkR29vZ2xlUGF5bWVudCgpXSk7dGhpcy5nb29nbGVQYXltZW50PXlpZWxkIHQuY3JlYXRlKHtjbGllbnQ6ZX0pfXJldHVybiB0aGlzLmdvb2dsZVBheW1lbnR9KX1nZXRCcmFpbnRyZWVUaHJlZURTKCl7cmV0dXJuIEkodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLnRocmVlRFMpe2NvbnN0W2UsdF09eWllbGQgUHJvbWlzZS5hbGwoW3RoaXMuZ2V0Q2xpZW50KCksdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZDNEUygpXSk7dGhpcy50aHJlZURTPXlpZWxkIHQuY3JlYXRlKHtjbGllbnQ6ZSx2ZXJzaW9uOjJ9KX1yZXR1cm4gdGhpcy50aHJlZURTfSl9Z2V0QnJhaW50cmVlTG9jYWxQYXltZW50KGUpe3JldHVybiBJKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5icmFpbnRyZWVMb2NhbFBheW1lbnQpe2NvbnN0W3QsaV09eWllbGQgUHJvbWlzZS5hbGwoW3RoaXMuZ2V0Q2xpZW50KCksdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZExvY2FsUGF5bWVudCgpXSk7dGhpcy5icmFpbnRyZWVMb2NhbFBheW1lbnQ9eWllbGQgbmV3IFByb21pc2UoKG4sYSk9PntpLmNyZWF0ZSh7Y2xpZW50OnQsbWVyY2hhbnRBY2NvdW50SWQ6ZX0sKGUsdCk9PntlJiZhKGUpLG4odCl9KX0pfXJldHVybiB0aGlzLmJyYWludHJlZUxvY2FsUGF5bWVudH0pfWdldFVzQmFua0FjY291bnQoKXtyZXR1cm4gSSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMudXNCYW5rQWNjb3VudCl7Y29uc3QgZT15aWVsZCB0aGlzLmdldENsaWVudCgpLHQ9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZFVzQmFua0FjY291bnQoKTt0aGlzLnVzQmFua0FjY291bnQ9eWllbGQgdC5jcmVhdGUoe2NsaWVudDplfSl9cmV0dXJuIHRoaXMudXNCYW5rQWNjb3VudH0pfWdldEJyYWludHJlZVZpc2FDaGVja291dCgpe3JldHVybiB0aGlzLnZpc2FDaGVja291dHx8KHRoaXMudmlzYUNoZWNrb3V0PVByb21pc2UuYWxsKFt0aGlzLmdldENsaWVudCgpLHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRWaXNhQ2hlY2tvdXQoKV0pLnRoZW4oKFtlLHRdKT0+dC5jcmVhdGUoe2NsaWVudDplfSkpKSx0aGlzLnZpc2FDaGVja291dH1nZXRWaXNhQ2hlY2tvdXRTZGsoZSl7cmV0dXJuIEkodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLnZpc2FDaGVja291dFNES3x8KHRoaXMudmlzYUNoZWNrb3V0U0RLPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRWaXNhQ2hlY2tvdXRTZGsoZSkpLHRoaXMudmlzYUNoZWNrb3V0U0RLfSl9Z2V0VmVubW9DaGVja291dE9yVGhyb3coKXtyZXR1cm4gSSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuYnJhaW50cmVlVmVubW8pe2NvbnN0IGU9eWllbGQgdGhpcy5nZXRDbGllbnQoKSx0PXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRWZW5tb0NoZWNrb3V0KCksaT17Y2xpZW50OmUsYWxsb3dEZXNrdG9wOiEwLHBheW1lbnRNZXRob2RVc2FnZTpcIm11bHRpX3VzZVwifSxuPXlpZWxkIHQuY3JlYXRlKGkpO2lmKCFuLmlzQnJvd3NlclN1cHBvcnRlZCgpKXRocm93IG5ldyB1O3RoaXMuYnJhaW50cmVlVmVubW89bn1yZXR1cm4gdGhpcy5icmFpbnRyZWVWZW5tb30pfXNldENsaWVudFRva2VuKGUpe3RoaXMuY2xpZW50VG9rZW49ZX1nZXRDbGllbnRUb2tlbk9yVGhyb3coKXtpZighdGhpcy5jbGllbnRUb2tlbil0aHJvdyBuZXcgZihwLlBheW1lbnROb3RJbml0aWFsaXplZCk7cmV0dXJuIHRoaXMuY2xpZW50VG9rZW59dGVhcmRvd25Nb2R1bGUoZSl7cmV0dXJuIGU/ZS50ZWFyZG93bigpOlByb21pc2UucmVzb2x2ZSgpfX1jbGFzcyBrIGV4dGVuZHMgaHtjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIGNsaWVudCBsaWJyYXJ5IG9mIGEgcGF5bWVudCBtZXRob2QgaXMgbm90IGxvYWRlZCBvciByZWFkeSB0byBiZSB1c2VkLlwiKSx0aGlzLm5hbWU9XCJQYXltZW50TWV0aG9kQ2xpZW50VW5hdmFpbGFibGVFcnJvclwiLHRoaXMudHlwZT1cInBheW1lbnRfbWV0aG9kX2NsaWVudF91bmF2YWlsYWJsZVwifX0hZnVuY3Rpb24oZSl7ZS5TYW5kYm94PVwic2FuZGJveFwiLGUuUHJvZHVjdGlvbj1cInByb2R1Y3Rpb25cIn0oX3x8KF89e30pKSxmdW5jdGlvbihlKXtlLkNsaWVudD1cImNsaWVudFwiLGUuRGF0YUNvbGxlY3Rvcj1cImRhdGFDb2xsZWN0b3JcIixlLkZhc3RsYW5lPVwiZmFzdGxhbmVcIixlLkdvb2dsZVBheW1lbnQ9XCJnb29nbGVQYXltZW50XCIsZS5Ib3N0ZWRGaWVsZHM9XCJob3N0ZWRGaWVsZHNcIixlLkxvY2FsUGF5bWVudD1cImxvY2FsUGF5bWVudFwiLGUuUGF5cGFsPVwicGF5cGFsXCIsZS5QYXlwYWxDaGVja291dD1cInBheXBhbENoZWNrb3V0XCIsZS5UaHJlZURTZWN1cmU9XCJ0aHJlZURTZWN1cmVcIixlLlVzQmFua0FjY291bnQ9XCJ1c0JhbmtBY2NvdW50XCIsZS5WZW5tbz1cInZlbm1vXCIsZS5WaXNhQ2hlY2tvdXQ9XCJ2aXNhQ2hlY2tvdXRcIn0od3x8KHc9e30pKSxmdW5jdGlvbihlKXtlLkNhcmRDb2RlPVwiY2FyZENvZGVcIixlLkNhcmRDb2RlVmVyaWZpY2F0aW9uPVwiY2FyZENvZGVWZXJpZmljYXRpb25cIixlLkNhcmRFeHBpcnk9XCJjYXJkRXhwaXJ5XCIsZS5DYXJkTmFtZT1cImNhcmROYW1lXCIsZS5DYXJkTnVtYmVyPVwiY2FyZE51bWJlclwiLGUuQ2FyZE51bWJlclZlcmlmaWNhdGlvbj1cImNhcmROdW1iZXJWZXJpZmljYXRpb25cIn0oUHx8KFA9e30pKTtjb25zdCBBPXtbZF06e1t3LkNsaWVudF06XCJzaGEzODQtMjZCWERObkpJMjNKWVJ5RkJqNHhlNHNWTnJVU1NpU1N1MTFreFZYTk0vdkVQT05tNEx1TDAwdzZaYVRnUWV3dFwiLFt3LlBheXBhbENoZWNrb3V0XTpcInNoYTM4NC1CK3Z6Ylp3blF0eldCdGhwa1Q0VFhLVWliTzY1dHllSzdlQ3hTdnBibGdwclRlcDIrSUFYQjJDeHhqcm43MTBPXCIsW3cuUGF5cGFsXTpcInNoYTM4NC11eUFHTDEvMytYSkFIbkdvTnk0ZUNvWGR6SjRmN0lsenArNnc5UE5uRWpzNkRDQ3o5V015SmpNTjFnemM3OFUrXCIsW3cuTG9jYWxQYXltZW50XTpcInNoYTM4NC1MSXZPRU1rSVZFd1Z1WUJkVk9RYzFBQzVZYkdHbHd5ZlVoZVMwQUNLMjE4RDJTVHVWWVFsWjRGeUVQb3dBRWZUXCIsW3cuRGF0YUNvbGxlY3Rvcl06XCJzaGEzODQtMWJvOUpEeitLc2N0aGMwODVjQ0tXdXI4Q0x3VW9CcG9OeXhzRGk3OTMybUNsMHpGcTNBNW12K0ZRTHc5R0hwVlwiLFt3LlVzQmFua0FjY291bnRdOlwic2hhMzg0LXhtSEJWYVUrdzc0VitPZWJEM0FhUE9ORnhIVUdNZitRUnM4Ry9KeFZQWE5OUDdNRGEyakwwSUNXSEllMnRUZkpcIixbdy5Hb29nbGVQYXltZW50XTpcInNoYTM4NC1XS0RKbDhtcW9QODJxWnBNR0g2QWJaeG52WG5TVzhJTFY0TTY0Q3lNTGl1Z0dNd3U3THlQODl3akNrSHFzaUJlXCIsW3cuVGhyZWVEU2VjdXJlXTpcInNoYTM4NC1WUVVscEdIenNHdnM1WGVpR0ZpcDdFWFJzdm9IV0VYRFZtZ0NhY2ZieWllWkk5bWRCT3FxM05Tb3lvMjhPQ09CXCIsW3cuVmlzYUNoZWNrb3V0XTpcInNoYTM4NC15eDdtQURmelROMFQ0M1E2cmxINDlMSWcxRUowaVVaZ0JwL0Vjelg5TFhzVUdreVNneHJEK25XSFFSQmt5Zm9UXCIsW3cuVmVubW9dOlwic2hhMzg0LVFYNHJQam9qMVpEaHVHMGFTeUtzNTZsRUtEcVRNVGNqWXhVSFkxU3pPNVZaRHNxSUUyTlRrcW90N0tOU0N5b3ZcIixbdy5Ib3N0ZWRGaWVsZHNdOlwic2hhMzg0LVZ2WUJBQ2ZTdTBDci9KMzJ1S214RzdBWGNOT0pFMUF6SUlMM2tiaWt5UzdZS3A1Zno1SXMrTnpOUC9seWF1TnlcIixbdy5GYXN0bGFuZV06XCJzaGEzODQtOW9Hc1pNUlp3cEd0REVEWWEvZEZ0NzZkRUNxajF4QW5pOWdJS2djM0tmTUlpUm5SNzNuRWVlVURMaUJ6eGhGYVwifSxbbF06e1t3LkNsaWVudF06XCJzaGEzODQtbytuYlFHY3dOTnhJQmVYZXUzK1htYlNxK0NnOFIzRU4zTjBsNWhYQ2dNTVUyUkdZMHQxejBMcm9TRUlBYmZBT1wiLFt3LlBheXBhbENoZWNrb3V0XTpcInNoYTM4NC1XcmZiV1BCUzRtSDg2R0FveWNQU2dpSDhoUThLSDdBNjdDOTNIamh1bnYveGhOazJZcEJuM3diRkE0RmhnOVUvXCIsW3cuUGF5cGFsXTpcInNoYTM4NC1WRjM4OW52dnJSVWdEc1RYTXhUWU9SRHRWZWdCOUlRYTNDeHIvL0R5Sm5MWW56OC9YOFZDekV2Y2syYytNZWd0XCIsW3cuTG9jYWxQYXltZW50XTpcInNoYTM4NC10Wkt4MnJFUWJmbVpwb1BTWTVWUG1KRWhhcTRYNzVkTHZ3SE1zM1ZFOVUrQzhsUHl3K2hXVElMMStHUHZXQ0lIXCIsW3cuRGF0YUNvbGxlY3Rvcl06XCJzaGEzODQtRTZrM3dPcFA3c3lDRER3YVJETEYwNjk0MlkwME5rYndKdldpMk9RWHd3S3pHd0c1ZmQzRTdSRlV2Q0NlY2Z2T1wiLFt3LlVzQmFua0FjY291bnRdOlwic2hhMzg0LTI1OEZPTjhMWkdHMFc5UWF6NEppajgzcFpIdTMwWW5LakpBN2dOdWxMQmg2Q2Nsa3VjZ0YrdEhEUXVZRlJZZldcIixbdy5Hb29nbGVQYXltZW50XTpcInNoYTM4NC10YUoycC8wK24wVkgzMjhQT0FvQml1RWJMM3RuSFVURTlTNDJoSzFWK1R4czNYK1FZalpPeUtXMzVKZ0hSRmZPXCIsW3cuVGhyZWVEU2VjdXJlXTpcInNoYTM4NC0rTlNaSDRaajNzTzViZFd2UEtoVTVOMTZRRHhldWVUVlRuVVZlbGVlRVNraExTYXo0T2IxaGgvNW15ZWNjOVltXCIsW3cuVmlzYUNoZWNrb3V0XTpcInNoYTM4NC02NkRpQmpnaHhrMU9tQmo4YWtzTjhnYlErQ3dvUWN4MXZQZmlYVU4wOGcxaVFWTStCd2V3RjBwN3RvTTNpN1NTXCIsW3cuVmVubW9dOlwic2hhMzg0LUI1VXdZNDJrRTRSb0xvV2JRN1lwcW9zVWxVYWQyL0RsR1dpdzBIaG9aYlNQazMwQ1FBYVNBMTBvaHlMRFRrRFVcIixbdy5Ib3N0ZWRGaWVsZHNdOlwic2hhMzg0LUF3OUVlc1NhVWVXeGUzNlBxRUhpT3lPeU9xOE02Q0liMWd3Ny95SE5WUFJ6R3RGWFhjZDJPUThxWHJJbE9qMlBcIixbdy5GYXN0bGFuZV06XCJzaGEzODQtcmhCTDFocFo3MUpxRysyVHNUMERpaDQ3bWJqeDhjakpDcGVaams5dHczZGYxZ0ZNS2ZDVG1NeVp1bmhyN0g0WVwifSxbc106e1t3LkNsaWVudF06XCJzaGEzODQtMFdOeGtzSXBSUCtmWVppSWRyMTJnNkRCVVFmTER6WUNRSlp0Ui9DOEtrY3dTR2hQSGZjRnAzdFRhR2NNeUZUcVwiLFt3LlBheXBhbENoZWNrb3V0XTpcInNoYTM4NC1sV00xams0Qk94b0ROVjZLb3A3dFZOdlFnSU5sbUVWejBjL093TStITkhLM1FDOHhxd2Q1NE92cnQyUVJEVGpoXCIsW3cuUGF5cGFsXTpcInNoYTM4NC1mWFVtVnhDMkVNWkJEWFo3ZVRIU1RML0xGQnJIZWovTVNYVC92VEJYdnJhNGx6Z0xOR3ZSRUFwK3gwR1lPYnVIXCIsW3cuTG9jYWxQYXltZW50XTpcInNoYTM4NC1waGExeEd1R1NrbVpINXg5YXFIdlJhTzR4TGVhN3JtUS83OVBGajl6eE56eHVGY09XWmc3Z09QN0ZpYnlnT0VDXCIsW3cuRGF0YUNvbGxlY3Rvcl06XCJzaGEzODQtUTZQSTJGOWVla1diQXhocm95YmwrYUVjdnFoZG93Ti9FUWxHd0JVeUpPelBGbjk5ODJ1OXhsNlNVNlhmR0t6Y1wiLFt3LlVzQmFua0FjY291bnRdOlwic2hhMzg0LVczUkxRU0tKTDF0UTMrWTdtUDZ0bWthbXRaOGJWNFl3L1h4TDlKajVKdFhIcmFEOGxvTUY4aEFJRzVtMnpLN0ZcIixbdy5Hb29nbGVQYXltZW50XTpcInNoYTM4NC1USVRRTXNGV0EzZWxETkdQMm1XejJvS0JvNHFqdCtUbHF6b3ZjYVBvZUJpQWgvd1BCaTZuYWU1MEFEZGdVMS9pXCIsW3cuVGhyZWVEU2VjdXJlXTpcInNoYTM4NC1ZaXljWU44OVpsTC9FdmNhcTR5MWFqVzFtaGQ3SllmWkJEdU93SHRJbjQvSm5tMjBHTCsvWENNK3pZQXdXRDhEXCIsW3cuVmlzYUNoZWNrb3V0XTpcInNoYTM4NC0vT2RhVHY5cXJrS3pqT2J0VWU2eXpmRGhIb3pGVy8rdVhsclNsNzM2c09aUkpwakdRRVR2cFlYcU1GRmc2OXh2XCIsW3cuVmVubW9dOlwic2hhMzg0LWRBK29qZFc5dmJKUzRKYXZjWHlPczlkNXVaSEpnNWROdFl1cG9QU0gyenNYSWlZRFZTNWFtTGIvdThxbVE2b3pcIixbdy5Ib3N0ZWRGaWVsZHNdOlwic2hhMzg0LTMxWmtTNTgraWFXc1cwNmZ0VzUyenpWWkZwNDNXUGQ3cE5ZUmlkZFl5blNOZzZPaDdXR2JTRkdvckFVSDZUMXpcIixbdy5GYXN0bGFuZV06XCJzaGEzODQtamxicndOdkwzSHZMQVVDdExTbXJuUTJHSDF1ZENVclJTL2JWbVJlQVM1ZnVJVnZjVzhQa28vR2tnODJ0bGd0clwifX07dmFyIE0sTixFPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKGEsbyl7ZnVuY3Rpb24gcihlKXt0cnl7bChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2wobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gbChlKXt2YXIgdDtlLmRvbmU/YShlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHIscyl9bCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIE97Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMuc2NyaXB0TG9hZGVyPWUsdGhpcy5icmFpbnRyZWVIb3N0V2luZG93PXQsdGhpcy5icmFpbnRyZWVTREtWZXJzaW9uTWFuYWdlcj1pfWxvYWRDbGllbnQoKXtyZXR1cm4gRSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3cody5DbGllbnQsXCJjbGllbnQubWluLmpzXCIpfSl9bG9hZEZhc3RsYW5lKCl7cmV0dXJuIEUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHcuRmFzdGxhbmUsXCJmYXN0bGFuZS5taW4uanNcIil9KX1sb2FkUGF5cGFsQ2hlY2tvdXQoKXtyZXR1cm4gRSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3cody5QYXlwYWxDaGVja291dCxcInBheXBhbC1jaGVja291dC5taW4uanNcIil9KX1sb2FkUGF5cGFsKCl7cmV0dXJuIEUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHcuUGF5cGFsLFwicGF5cGFsLm1pbi5qc1wiKX0pfWxvYWRMb2NhbFBheW1lbnQoKXtyZXR1cm4gRSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3cody5Mb2NhbFBheW1lbnQsXCJsb2NhbC1wYXltZW50Lm1pbi5qc1wiKX0pfWxvYWREYXRhQ29sbGVjdG9yKCl7cmV0dXJuIEUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHcuRGF0YUNvbGxlY3RvcixcImRhdGEtY29sbGVjdG9yLm1pbi5qc1wiKX0pfWxvYWRVc0JhbmtBY2NvdW50KCl7cmV0dXJuIEUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHcuVXNCYW5rQWNjb3VudCxcInVzLWJhbmstYWNjb3VudC5taW4uanNcIil9KX1sb2FkR29vZ2xlUGF5bWVudCgpe3JldHVybiBFKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh3Lkdvb2dsZVBheW1lbnQsXCJnb29nbGUtcGF5bWVudC5taW4uanNcIil9KX1sb2FkM0RTKCl7cmV0dXJuIEUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHcuVGhyZWVEU2VjdXJlLFwidGhyZWUtZC1zZWN1cmUubWluLmpzXCIpfSl9bG9hZFZpc2FDaGVja291dCgpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHcuVmlzYUNoZWNrb3V0LFwidmlzYS1jaGVja291dC5taW4uanNcIil9bG9hZFZlbm1vQ2hlY2tvdXQoKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh3LlZlbm1vLFwidmVubW8ubWluLmpzXCIpfWxvYWRIb3N0ZWRGaWVsZHMoKXtyZXR1cm4gRSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3cody5Ib3N0ZWRGaWVsZHMsXCJob3N0ZWQtZmllbGRzLm1pbi5qc1wiKX0pfWxvYWRWaXNhQ2hlY2tvdXRTZGsoZSl7cmV0dXJuIEUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5WKXJldHVybiB0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cuVjtjb25zdCB0PWU/XCJzaGEzODQtMGV1MXMxR3RxelhsTDlEdExnbXd6QzVXV2xFSC9BRFJNMG4zOGNWUWt2dFQrVy9nZXk5NnJjYjFMd3VVT1BEbVwiOlwic2hhMzg0LTFmMWNzdlAzWkZ4ZzRkSUxIMUdhWTRMSGxaMG9YN1JrODNyeG1MbHdibklpNFRNME5ZelhvZXYxVm9FaVZEUzZcIjtyZXR1cm4gdGhpcy5zY3JpcHRMb2FkZXIubG9hZFNjcmlwdChgLy8ke2U/XCJzYW5kYm94LVwiOlwiXCJ9YXNzZXRzLnNlY3VyZS5jaGVja291dC52aXNhLmNvbS9jaGVja291dC13aWRnZXQvcmVzb3VyY2VzL2pzL2ludGVncmF0aW9uL3YxL3Nkay5qc2Ase2FzeW5jOiEwLGF0dHJpYnV0ZXM6e2ludGVncml0eTp0LGNyb3Nzb3JpZ2luOlwiYW5vbnltb3VzXCJ9fSkudGhlbigoKT0+e2lmKCF0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cuVil0aHJvdyBuZXcgaztyZXR1cm4gdGhpcy5icmFpbnRyZWVIb3N0V2luZG93LlZ9KX0pfWxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KGUsdCl7cmV0dXJuIEUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2xldCBpPXRoaXMuZ2V0QnJhaW50cmVlTW9kdWxlKGUpO2lmKGkpcmV0dXJuIGk7Y29uc3Qgbj10aGlzLmJyYWludHJlZVNES1ZlcnNpb25NYW5hZ2VyLmdldFNES1ZlcnNpb24oKSxhPWAvL2pzLmJyYWludHJlZWdhdGV3YXkuY29tL3dlYi8ke259L2pzLyR7dH1gLG89biBpbiBBP3RoaXMuZ2V0SW50ZWdyaXR5VmFsdWVzQnlNb2R1bGVOYW1lKGUsbik6dm9pZCAwO2lmKHlpZWxkIHRoaXMuc2NyaXB0TG9hZGVyLmxvYWRTY3JpcHQoYSxvP3thc3luYzohMCxhdHRyaWJ1dGVzOntpbnRlZ3JpdHk6byxjcm9zc29yaWdpbjpcImFub255bW91c1wifX06dm9pZCAwKSxpPXRoaXMuZ2V0QnJhaW50cmVlTW9kdWxlKGUpLCFpKXRocm93IG5ldyBrO3JldHVybiBpfSl9Z2V0QnJhaW50cmVlTW9kdWxlKGUpe3ZhciB0O3JldHVybiBudWxsPT09KHQ9dGhpcy5icmFpbnRyZWVIb3N0V2luZG93LmJyYWludHJlZSl8fHZvaWQgMD09PXQ/dm9pZCAwOnRbZV19Z2V0SW50ZWdyaXR5VmFsdWVzQnlNb2R1bGVOYW1lKGUsdCl7Y29uc3QgaT1BW3RdW2VdO2lmKCFpKXRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQgZmlsZU5hbWUgdmFsdWVcIik7cmV0dXJuIGl9fWZ1bmN0aW9uIEQoZSx0KXtyZXR1cm4gT2JqZWN0LmFzc2lnbihlLHtyZXNvbHZlSWRzOnR9KX0hZnVuY3Rpb24oZSl7ZVtlLk1pc3NpbmdCaWxsaW5nQWRkcmVzcz0wXT1cIk1pc3NpbmdCaWxsaW5nQWRkcmVzc1wiLGVbZS5NaXNzaW5nQ2FydD0xXT1cIk1pc3NpbmdDYXJ0XCIsZVtlLk1pc3NpbmdDaGVja291dD0yXT1cIk1pc3NpbmdDaGVja291dFwiLGVbZS5NaXNzaW5nQ29uc2lnbm1lbnRzPTNdPVwiTWlzc2luZ0NvbnNpZ25tZW50c1wiLGVbZS5NaXNzaW5nQ3VzdG9tZXI9NF09XCJNaXNzaW5nQ3VzdG9tZXJcIixlW2UuTWlzc2luZ0NoZWNrb3V0Q29uZmlnPTVdPVwiTWlzc2luZ0NoZWNrb3V0Q29uZmlnXCIsZVtlLk1pc3NpbmdPcmRlcj02XT1cIk1pc3NpbmdPcmRlclwiLGVbZS5NaXNzaW5nT3JkZXJDb25maWc9N109XCJNaXNzaW5nT3JkZXJDb25maWdcIixlW2UuTWlzc2luZ09yZGVySWQ9OF09XCJNaXNzaW5nT3JkZXJJZFwiLGVbZS5NaXNzaW5nUGF5bWVudD05XT1cIk1pc3NpbmdQYXltZW50XCIsZVtlLk1pc3NpbmdQYXltZW50SWQ9MTBdPVwiTWlzc2luZ1BheW1lbnRJZFwiLGVbZS5NaXNzaW5nUGF5bWVudEluc3RydW1lbnQ9MTFdPVwiTWlzc2luZ1BheW1lbnRJbnN0cnVtZW50XCIsZVtlLk1pc3NpbmdQYXltZW50TWV0aG9kPTEyXT1cIk1pc3NpbmdQYXltZW50TWV0aG9kXCIsZVtlLk1pc3NpbmdQYXltZW50UmVkaXJlY3RVcmw9MTNdPVwiTWlzc2luZ1BheW1lbnRSZWRpcmVjdFVybFwiLGVbZS5NaXNzaW5nUGF5bWVudFN0YXR1cz0xNF09XCJNaXNzaW5nUGF5bWVudFN0YXR1c1wiLGVbZS5NaXNzaW5nUGF5bWVudFRva2VuPTE1XT1cIk1pc3NpbmdQYXltZW50VG9rZW5cIixlW2UuTWlzc2luZ1NoaXBwaW5nQWRkcmVzcz0xNl09XCJNaXNzaW5nU2hpcHBpbmdBZGRyZXNzXCJ9KE18fChNPXt9KSk7Y2xhc3MgQiBleHRlbmRzIGh7Y29uc3RydWN0b3IoZSl7c3VwZXIoZnVuY3Rpb24oZSl7c3dpdGNoKGUpe2Nhc2UgTS5NaXNzaW5nQmlsbGluZ0FkZHJlc3M6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGJpbGxpbmcgYWRkcmVzcyBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgTS5NaXNzaW5nQ2FydDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY2FydCBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgTS5NaXNzaW5nQ29uc2lnbm1lbnRzOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBjb25zaWdubWVudHMgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIE0uTWlzc2luZ0NoZWNrb3V0OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBjaGVja291dCBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgTS5NaXNzaW5nQ3VzdG9tZXI6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGN1c3RvbWVyIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBNLk1pc3NpbmdDaGVja291dENvbmZpZzpjYXNlIE0uTWlzc2luZ09yZGVyQ29uZmlnOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBjb25maWd1cmF0aW9uIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBNLk1pc3NpbmdPcmRlcjpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2Ugb3JkZXIgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIE0uTWlzc2luZ09yZGVySWQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIG9yZGVyIElEIGlzIHVuYXZhaWxhYmxlIG9yIG5vdCBnZW5lcmF0ZWQgeWV0LlwiO2Nhc2UgTS5NaXNzaW5nUGF5bWVudDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgcGF5bWVudCBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgTS5NaXNzaW5nUGF5bWVudFRva2VuOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgdG9rZW4gcmVxdWlyZWQgdG8gc3VibWl0IGEgcGF5bWVudCBpcyBtaXNzaW5nLlwiO2Nhc2UgTS5NaXNzaW5nUGF5bWVudE1ldGhvZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgcGF5bWVudCBtZXRob2QgZGF0YSBpcyB1bmF2YWlsYWJsZSBvciBub3QgcHJvcGVybHkgY29uZmlndXJlZC5cIjtjYXNlIE0uTWlzc2luZ1NoaXBwaW5nQWRkcmVzczpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2Ugc2hpcHBpbmcgYWRkcmVzcyBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2RlZmF1bHQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSByZXF1aXJlZCBkYXRhIGlzIHVuYXZhaWxhYmxlLlwifX0oZSkpLHRoaXMuc3VidHlwZT1lLHRoaXMubmFtZT1cIk1pc3NpbmdEYXRhRXJyb3JcIix0aGlzLnR5cGU9XCJtaXNzaW5nX2RhdGFcIn19Y2xhc3MgTCBleHRlbmRzIGh7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJOb3QgaW1wbGVtZW50ZWQuXCIpLHRoaXMubmFtZT1cIk5vdEltcGxlbWVudGVkRXJyb3JcIix0aGlzLnR5cGU9XCJub3RfaW1wbGVtZW50ZWRcIn19Y2xhc3MgeiBleHRlbmRzIGh7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJJbnZhbGlkIGFyZ3VtZW50cyBoYXZlIGJlZW4gcHJvdmlkZWQuXCIpLHRoaXMubmFtZT1cIkludmFsaWRBcmd1bWVudEVycm9yXCIsdGhpcy50eXBlPVwiaW52YWxpZF9hcmd1bWVudFwifX1jbGFzcyB4IGV4dGVuZHMgaHtjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIlBheW1lbnQgcHJvY2VzcyB3YXMgY2FuY2VsbGVkLlwiKSx0aGlzLm5hbWU9XCJQYXltZW50TWV0aG9kQ2FuY2VsbGVkRXJyb3JcIix0aGlzLnR5cGU9XCJwYXltZW50X2NhbmNlbGxlZFwifX0hZnVuY3Rpb24oZSl7ZS5CUkFJTlRSRUU9XCJicmFpbnRyZWVcIixlLkJSQUlOVFJFRV9GQVNUTEFORT1cImJyYWludHJlZWFjY2VsZXJhdGVkY2hlY2tvdXRcIn0oTnx8KE49e30pKTt2YXIgVSxGPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKGEsbyl7ZnVuY3Rpb24gcihlKXt0cnl7bChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2wobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gbChlKXt2YXIgdDtlLmRvbmU/YShlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHIscyl9bCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9OyFmdW5jdGlvbihlKXtlLlN1YnRvdGFsPVwiU3VidG90YWxcIixlLlNoaXBwaW5nPVwiU2hpcHBpbmdcIn0oVXx8KFU9e30pKTtjbGFzcyBSe2NvbnN0cnVjdG9yKGUsdCxpLG4sbyl7dGhpcy5fcmVxdWVzdFNlbmRlcj1lLHRoaXMuX3BheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9dCx0aGlzLl9zZXNzaW9uRmFjdG9yeT1pLHRoaXMuX2JyYWludHJlZVNkaz1uLHRoaXMuX2FwcGxlUGF5U2NyaXB0TG9hZGVyPW8sdGhpcy5fb25BdXRob3JpemVDYWxsYmFjaz1hLHRoaXMuX29uRXJyb3I9YSx0aGlzLl9vbkNsaWNrPWEsdGhpcy5fc3ViVG90YWxMYWJlbD1VLlN1YnRvdGFsLHRoaXMuX3NoaXBwaW5nTGFiZWw9VS5TaGlwcGluZyx0aGlzLl9oYXNBcHBsZVBheVNlc3Npb249ITF9aW5pdGlhbGl6ZShlKXt2YXIgdDtyZXR1cm4gRih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6aSxhcHBsZXBheTpufT1lO2lmKCFpfHwhbil0aHJvdyBuZXcgQihNLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdHtjb250YWluZXI6byxzaGlwcGluZ0xhYmVsOnIsc3VidG90YWxMYWJlbDpzLG9uRXJyb3I6bD1hLG9uQ2xpY2s6ZD1hLG9uUGF5bWVudEF1dGhvcml6ZTpjfT1uO3RoaXMuX3NoaXBwaW5nTGFiZWw9cnx8VS5TaGlwcGluZyx0aGlzLl9zdWJUb3RhbExhYmVsPXN8fFUuU3VidG90YWwsdGhpcy5fb25BdXRob3JpemVDYWxsYmFjaz1jLHRoaXMuX29uRXJyb3I9bCx0aGlzLl9vbkNsaWNrPWQ7bGV0IGg9dGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3lpZWxkIHRoaXMuX2FwcGxlUGF5U2NyaXB0TG9hZGVyLmxvYWRTZGsoKTt0cnl7dGhpcy5fcGF5bWVudE1ldGhvZD1oLmdldFBheW1lbnRNZXRob2RPclRocm93KGkpfWNhdGNoKGUpe2g9eWllbGQgdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKSx0aGlzLl9wYXltZW50TWV0aG9kPWguZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSl9eWllbGQgdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS52ZXJpZnlDaGVja291dFNwYW1Qcm90ZWN0aW9uKCksdGhpcy5fYXBwbGVQYXlCdXR0b249dGhpcy5fY3JlYXRlQnV0dG9uKG8pLHRoaXMuX2FwcGxlUGF5QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLHRoaXMuX2hhbmRsZVdhbGxldEJ1dHRvbkNsaWNrLmJpbmQodGhpcykpLChudWxsPT09KHQ9dGhpcy5fcGF5bWVudE1ldGhvZC5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmdhdGV3YXkpPT09Ti5CUkFJTlRSRUUmJih5aWVsZCB0aGlzLl9pbml0aWFsaXplQnJhaW50cmVlU2RrKCkpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXNpZ25Jbigpe3Rocm93IG5ldyBMKCdJbiBvcmRlciB0byBzaWduIGluIHZpYSBBcHBsZSwgdGhlIHNob3BwZXIgbXVzdCBjbGljayBvbiBcIkFwcGxlIFBheVwiIGJ1dHRvbi4nKX1zaWduT3V0KCl7dGhyb3cgbmV3IEwoXCJOZWVkIHRvIGRvIHNpZ25vdXQgdmlhIGFwcGxlLlwiKX1leGVjdXRlUGF5bWVudE1ldGhvZENoZWNrb3V0KGUpe3ZhciB0O3JldHVybiBudWxsPT09KHQ9bnVsbD09ZT92b2lkIDA6ZS5jb250aW51ZVdpdGhDaGVja291dENhbGxiYWNrKXx8dm9pZCAwPT09dHx8dC5jYWxsKGUpLFByb21pc2UucmVzb2x2ZSgpfV9jcmVhdGVCdXR0b24oZSl7Y29uc3QgdD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChlKTtpZighdCl0aHJvdyBuZXcgeihcIlVuYWJsZSB0byBjcmVhdGUgc2lnbi1pbiBidXR0b24gd2l0aG91dCB2YWxpZCBjb250YWluZXIgSUQuXCIpO2NvbnN0IGk9dGhpcy5fY3JlYXRlQXBwbGVQYXlCdXR0b25FbGVtZW50KCk7cmV0dXJuIHQuYXBwZW5kQ2hpbGQoaSksaX1fY3JlYXRlQXBwbGVQYXlCdXR0b25FbGVtZW50KCl7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYXBwbGUtcGF5LWJ1dHRvblwiKTtyZXR1cm4gZS5zZXRBdHRyaWJ1dGUoXCJidXR0b25zdHlsZVwiLFwiYmxhY2tcIiksZS5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsXCJwbGFpblwiKSxlLnNldEF0dHJpYnV0ZShcInN0eWxlXCIsXCItLWFwcGxlLXBheS1idXR0b24td2lkdGg6IDEwMCU7IC0tYXBwbGUtcGF5LWJ1dHRvbi1oZWlnaHQ6IDM2cHg7IC0tYXBwbGUtcGF5LWJ1dHRvbi1ib3JkZXItcmFkaXVzOiA0cHg7XCIpLGV9X2hhbmRsZVdhbGxldEJ1dHRvbkNsaWNrKGUpe2lmKGUucHJldmVudERlZmF1bHQoKSx0aGlzLl9oYXNBcHBsZVBheVNlc3Npb24pcmV0dXJuO3RoaXMuX29uQ2xpY2soKTtjb25zdCB0PXRoaXMuX3BheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxpPXQuZ2V0Q2FydE9yVGhyb3coKSxuPXQuZ2V0U3RvcmVDb25maWdPclRocm93KCksYT10LmdldENoZWNrb3V0T3JUaHJvdygpO2lmKCF0aGlzLl9wYXltZW50TWV0aG9kfHwhdGhpcy5fcGF5bWVudE1ldGhvZC5pbml0aWFsaXphdGlvbkRhdGEpdGhyb3cgbmV3IEIoTS5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3Qgbz10aGlzLl9nZXRCYXNlUmVxdWVzdChpLGEsbix0aGlzLl9wYXltZW50TWV0aG9kKSxyPXRoaXMuX3Nlc3Npb25GYWN0b3J5LmNyZWF0ZShvKTt0aGlzLl9oYW5kbGVBcHBsZVBheUV2ZW50cyhyLHRoaXMuX3BheW1lbnRNZXRob2Qsbiksci5iZWdpbigpLHRoaXMuX2hhc0FwcGxlUGF5U2Vzc2lvbj0hMH1fZ2V0QmFzZVJlcXVlc3QoZSx0LGksbil7dmFyIGE7Y29uc3R7c3RvcmVQcm9maWxlOntzdG9yZUNvdW50cnlDb2RlOm8sc3RvcmVOYW1lOnJ9fT1pLHtjdXJyZW5jeTp7Y29kZTpzLGRlY2ltYWxQbGFjZXM6bH19PWUse2luaXRpYWxpemF0aW9uRGF0YTp7bWVyY2hhbnRDYXBhYmlsaXRpZXM6ZCxzdXBwb3J0ZWROZXR3b3JrczpjfX09bixoPWUubGluZUl0ZW1zLnBoeXNpY2FsSXRlbXMubGVuZ3RoPjAsdT17cmVxdWlyZWRCaWxsaW5nQ29udGFjdEZpZWxkczpbXCJwb3N0YWxBZGRyZXNzXCJdLHJlcXVpcmVkU2hpcHBpbmdDb250YWN0RmllbGRzOltcImVtYWlsXCIsXCJwaG9uZVwiXSxjb3VudHJ5Q29kZTpvLGN1cnJlbmN5Q29kZTpzLG1lcmNoYW50Q2FwYWJpbGl0aWVzOmQsc3VwcG9ydGVkTmV0d29ya3M6YyxsaW5lSXRlbXM6W10sdG90YWw6aD97bGFiZWw6cixhbW91bnQ6YCR7dC5ncmFuZFRvdGFsLnRvRml4ZWQobCl9YCx0eXBlOlwicGVuZGluZ1wifTp7bGFiZWw6cixhbW91bnQ6YCR7dC5ncmFuZFRvdGFsLnRvRml4ZWQobCl9YCx0eXBlOlwiZmluYWxcIn19O2lmKGgpbnVsbD09PShhPXUucmVxdWlyZWRTaGlwcGluZ0NvbnRhY3RGaWVsZHMpfHx2b2lkIDA9PT1hfHxhLnB1c2goXCJwb3N0YWxBZGRyZXNzXCIpO2Vsc2V7Y29uc3QgZT1be2xhYmVsOnRoaXMuX3N1YlRvdGFsTGFiZWwsYW1vdW50OmAke3Quc3VidG90YWwudG9GaXhlZChsKX1gfV07dC50YXhlcy5mb3JFYWNoKHQ9PmUucHVzaCh7bGFiZWw6dC5uYW1lLGFtb3VudDpgJHt0LmFtb3VudC50b0ZpeGVkKGwpfWB9KSksdS5saW5lSXRlbXM9ZX1yZXR1cm4gdX1faGFuZGxlQXBwbGVQYXlFdmVudHMoZSx0LGkpe2Uub252YWxpZGF0ZW1lcmNoYW50PWk9PkYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdHtib2R5Om59PXlpZWxkIHRoaXMuX29uVmFsaWRhdGVNZXJjaGFudCh0LGkpO2UuY29tcGxldGVNZXJjaGFudFZhbGlkYXRpb24obil9Y2F0Y2goZSl7dGhpcy5fb25FcnJvcihlKX19KSxlLm9uc2hpcHBpbmdjb250YWN0c2VsZWN0ZWQ9dD0+Rih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMuX2hhbmRsZVNoaXBwaW5nQ29udGFjdFNlbGVjdGVkKGUsaSx0KX0pLGUub25zaGlwcGluZ21ldGhvZHNlbGVjdGVkPXQ9PkYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLl9oYW5kbGVTaGlwcGluZ01ldGhvZFNlbGVjdGVkKGUsaSx0KX0pLGUub25jYW5jZWw9KCk9PkYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RoaXMuX2hhc0FwcGxlUGF5U2Vzc2lvbj0hMTt0cnl7Y29uc3QgZT1gL3JlbW90ZS1jaGVja291dC8ke3QuaWR9L3NpZ25vdXRgO3JldHVybiB5aWVsZCB0aGlzLl9yZXF1ZXN0U2VuZGVyLmdldChlKSx5aWVsZCB0aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRDaGVja291dCgpfWNhdGNoKGUpe3JldHVybiB0aGlzLl9vbkVycm9yKG5ldyB4KX19KSxlLm9ucGF5bWVudGF1dGhvcml6ZWQ9aT0+Rih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMuX29uUGF5bWVudEF1dGhvcml6ZWQoaSxlLHQpfSl9X2hhbmRsZVNoaXBwaW5nQ29udGFjdFNlbGVjdGVkKGUsdCxpKXt2YXIgbjtyZXR1cm4gRih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgYT10aGlzLl90cmFuc2Zvcm1Db250YWN0VG9BZGRyZXNzKGkuc2hpcHBpbmdDb250YWN0KTt0cnl7eWllbGQgdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVTaGlwcGluZ0FkZHJlc3MoYSl9Y2F0Y2godCl7cmV0dXJuIGUuYWJvcnQoKSx0aGlzLl9oYXNBcHBsZVBheVNlc3Npb249ITEsdGhpcy5fb25FcnJvcih0KX1jb25zdHtzdG9yZVByb2ZpbGU6e3N0b3JlTmFtZTpvfX09dDtsZXQgcj10aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCk7Y29uc3R7Y3VycmVuY3k6e2RlY2ltYWxQbGFjZXM6c319PXIuZ2V0Q2FydE9yVGhyb3coKTtsZXQgbD1yLmdldENoZWNrb3V0T3JUaHJvdygpO2NvbnN0IGQ9bnVsbD09PShuPWwuY29uc2lnbm1lbnRzWzBdLnNlbGVjdGVkU2hpcHBpbmdPcHRpb24pfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmlkLGM9bC5jb25zaWdubWVudHNbMF0uYXZhaWxhYmxlU2hpcHBpbmdPcHRpb25zLGg9bnVsbD09Yz92b2lkIDA6Yy5maW5kKCh7aWQ6ZX0pPT5lPT09ZCksdT1udWxsPT1jP3ZvaWQgMDpjLmZpbHRlcihlPT5lLmlkIT09ZCkscD1oP1t7bGFiZWw6aC5kZXNjcmlwdGlvbixhbW91bnQ6YCR7aC5jb3N0LnRvRml4ZWQocyl9YCxkZXRhaWw6aC5hZGRpdGlvbmFsRGVzY3JpcHRpb24saWRlbnRpZmllcjpoLmlkfV06W107aWYodSYmWy4uLnUuZmlsdGVyKGU9PmUuaXNSZWNvbW1lbmRlZCksLi4udS5maWx0ZXIoZT0+IWUuaXNSZWNvbW1lbmRlZCldLmZvckVhY2goZT0+cC5wdXNoKHtsYWJlbDplLmRlc2NyaXB0aW9uLGFtb3VudDpgJHtlLmNvc3QudG9GaXhlZChzKX1gLGRldGFpbDplLmFkZGl0aW9uYWxEZXNjcmlwdGlvbixpZGVudGlmaWVyOmUuaWR9KSksIShjIGluc3RhbmNlb2YgQXJyYXkpKXRocm93IG5ldyBFcnJvcihcIlNoaXBwaW5nIG9wdGlvbnMgbm90IGF2YWlsYWJsZS5cIik7aWYoMD09PWMubGVuZ3RoKXJldHVybiB2b2lkIGUuY29tcGxldGVTaGlwcGluZ0NvbnRhY3RTZWxlY3Rpb24oQXBwbGVQYXlTZXNzaW9uLlNUQVRVU19JTlZBTElEX1NISVBQSU5HX1BPU1RBTF9BRERSRVNTLFtdLHt0eXBlOlwicGVuZGluZ1wiLGxhYmVsOm8sYW1vdW50OmAke2wuZ3JhbmRUb3RhbC50b0ZpeGVkKHMpfWB9LFtdKTtjb25zdCBtPWMuZmluZChlPT5lLmlzUmVjb21tZW5kZWQpLHk9bT9tLmlkOmNbMF0uaWQsZz1oP2guaWQ6eTt0cnl7eWllbGQgdGhpcy5fdXBkYXRlU2hpcHBpbmdPcHRpb24oZyl9Y2F0Y2goZSl7cmV0dXJuIHRoaXMuX29uRXJyb3IoZSl9cj10aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksbD1yLmdldENoZWNrb3V0T3JUaHJvdygpLGUuY29tcGxldGVTaGlwcGluZ0NvbnRhY3RTZWxlY3Rpb24oe25ld1NoaXBwaW5nTWV0aG9kczpwLG5ld1RvdGFsOnt0eXBlOlwiZmluYWxcIixsYWJlbDpvLGFtb3VudDpgJHtsLmdyYW5kVG90YWwudG9GaXhlZChzKX1gfSxuZXdMaW5lSXRlbXM6dGhpcy5fZ2V0VXBkYXRlZExpbmVJdGVtcyhsLHMpfSl9KX1faGFuZGxlU2hpcHBpbmdNZXRob2RTZWxlY3RlZChlLHQsaSl7cmV0dXJuIEYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3N0b3JlUHJvZmlsZTp7c3RvcmVOYW1lOm59fT10LHtzaGlwcGluZ01ldGhvZDp7aWRlbnRpZmllcjphfX09aTt0cnl7eWllbGQgdGhpcy5fdXBkYXRlU2hpcHBpbmdPcHRpb24oYSl9Y2F0Y2godCl7cmV0dXJuIGUuYWJvcnQoKSx0aGlzLl9oYXNBcHBsZVBheVNlc3Npb249ITEsdGhpcy5fb25FcnJvcih0KX1jb25zdCBvPXRoaXMuX3BheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx7Y3VycmVuY3k6e2RlY2ltYWxQbGFjZXM6cn19PW8uZ2V0Q2FydE9yVGhyb3coKSxzPW8uZ2V0Q2hlY2tvdXRPclRocm93KCk7ZS5jb21wbGV0ZVNoaXBwaW5nTWV0aG9kU2VsZWN0aW9uKHtuZXdUb3RhbDp7dHlwZTpcImZpbmFsXCIsbGFiZWw6bixhbW91bnQ6YCR7cy5ncmFuZFRvdGFsLnRvRml4ZWQocil9YH0sbmV3TGluZUl0ZW1zOnRoaXMuX2dldFVwZGF0ZWRMaW5lSXRlbXMocyxyKX0pfSl9X2dldFVwZGF0ZWRMaW5lSXRlbXMoZSx0KXtjb25zdCBpPVt7bGFiZWw6dGhpcy5fc3ViVG90YWxMYWJlbCxhbW91bnQ6YCR7ZS5zdWJ0b3RhbC50b0ZpeGVkKHQpfWB9XTtyZXR1cm4gZS50YXhlcy5mb3JFYWNoKGU9PmkucHVzaCh7bGFiZWw6ZS5uYW1lLGFtb3VudDpgJHtlLmFtb3VudC50b0ZpeGVkKHQpfWB9KSksaS5wdXNoKHtsYWJlbDp0aGlzLl9zaGlwcGluZ0xhYmVsLGFtb3VudDpgJHtlLnNoaXBwaW5nQ29zdFRvdGFsLnRvRml4ZWQodCl9YH0pLGl9X3VwZGF0ZVNoaXBwaW5nT3B0aW9uKGUpe3JldHVybiBGKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5zZWxlY3RTaGlwcGluZ09wdGlvbihlKX0pfV9vblZhbGlkYXRlTWVyY2hhbnQoZSx0KXtyZXR1cm4gRih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgaT1bYHZhbGlkYXRpb25Vcmw9JHt0LnZhbGlkYXRpb25VUkx9YCxgbWVyY2hhbnRJZGVudGlmaWVyPSR7ZS5pbml0aWFsaXphdGlvbkRhdGEubWVyY2hhbnRJZH1gLGBkaXNwbGF5TmFtZT0ke2UuaW5pdGlhbGl6YXRpb25EYXRhLnN0b3JlTmFtZX1gLGBkb21haW5OYW1lPSR7d2luZG93LmxvY2F0aW9uLmhvc3RuYW1lfWBdLmpvaW4oXCImXCIpO3JldHVybiB0aGlzLl9yZXF1ZXN0U2VuZGVyLnBvc3QoYCR7ZS5pbml0aWFsaXphdGlvbkRhdGEucGF5bWVudHNVcmx9L2FwaS9wdWJsaWMvdjEvcGF5bWVudHMvYXBwbGVwYXkvdmFsaWRhdGVfbWVyY2hhbnRgLHtjcmVkZW50aWFsczohMSxoZWFkZXJzOntBY2NlcHQ6XCJhcHBsaWNhdGlvbi9qc29uXCIsXCJDb250ZW50LVR5cGVcIjpcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLFwiWC1YU1JGLVRPS0VOXCI6bnVsbH0sYm9keTppfSl9KX1fb25QYXltZW50QXV0aG9yaXplZChlLHQsaSl7dmFyIG47cmV0dXJuIEYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3Rva2VuOmEsYmlsbGluZ0NvbnRhY3Q6byxzaGlwcGluZ0NvbnRhY3Q6cn09ZS5wYXltZW50LHM9dGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCkubGluZUl0ZW1zLnBoeXNpY2FsSXRlbXMubGVuZ3RoPjA7bGV0IGw7KG51bGw9PT0obj1pLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PW4/dm9pZCAwOm4uZ2F0ZXdheSk9PT1OLkJSQUlOVFJFRSYmKGw9eWllbGQgdGhpcy5fZ2V0QnJhaW50cmVlRGV2aWNlRGF0YSgpKTtjb25zdCBkPXttZXRob2RJZDppLmlkLHBheW1lbnREYXRhOntkZXZpY2VTZXNzaW9uSWQ6bCxmb3JtYXR0ZWRQYXlsb2FkOnthcHBsZV9wYXlfdG9rZW46e3BheW1lbnRfZGF0YTphLnBheW1lbnREYXRhLHBheW1lbnRfbWV0aG9kOmEucGF5bWVudE1ldGhvZCx0cmFuc2FjdGlvbl9pZDphLnRyYW5zYWN0aW9uSWRlbnRpZmllcn19fX0sYz10aGlzLl90cmFuc2Zvcm1Db250YWN0VG9BZGRyZXNzKG8pLGg9dGhpcy5fdHJhbnNmb3JtQ29udGFjdFRvQWRkcmVzcyhyKSx1PW51bGw9PXI/dm9pZCAwOnIuZW1haWxBZGRyZXNzLHA9KG51bGw9PXI/dm9pZCAwOnIucGhvbmVOdW1iZXIpfHxcIlwiO3RyeXtyZXR1cm4geWllbGQgdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVCaWxsaW5nQWRkcmVzcyhPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sYykse2VtYWlsOnUscGhvbmU6cH0pKSxzJiYoeWllbGQgdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVTaGlwcGluZ0FkZHJlc3MoaCkpLHlpZWxkIHRoaXMuX3BheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIoe3VzZVN0b3JlQ3JlZGl0OiExfSkseWllbGQgdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGQpLHQuY29tcGxldGVQYXltZW50KEFwcGxlUGF5U2Vzc2lvbi5TVEFUVVNfU1VDQ0VTUyksdGhpcy5fb25BdXRob3JpemVDYWxsYmFjaygpfWNhdGNoKGUpe3JldHVybiB0LmNvbXBsZXRlUGF5bWVudChBcHBsZVBheVNlc3Npb24uU1RBVFVTX0ZBSUxVUkUpLHRoaXMuX29uRXJyb3IoZSl9fSl9X3RyYW5zZm9ybUNvbnRhY3RUb0FkZHJlc3MoZSl7cmV0dXJue2ZpcnN0TmFtZToobnVsbD09ZT92b2lkIDA6ZS5naXZlbk5hbWUpfHxcIlwiLGxhc3ROYW1lOihudWxsPT1lP3ZvaWQgMDplLmZhbWlseU5hbWUpfHxcIlwiLGNpdHk6KG51bGw9PWU/dm9pZCAwOmUubG9jYWxpdHkpfHxcIlwiLGNvbXBhbnk6XCJcIixhZGRyZXNzMToobnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzTGluZXMpJiZlLmFkZHJlc3NMaW5lc1swXXx8XCJcIixhZGRyZXNzMjoobnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzTGluZXMpJiZlLmFkZHJlc3NMaW5lc1sxXXx8XCJcIixwb3N0YWxDb2RlOihudWxsPT1lP3ZvaWQgMDplLnBvc3RhbENvZGUpfHxcIlwiLGNvdW50cnlDb2RlOihudWxsPT1lP3ZvaWQgMDplLmNvdW50cnlDb2RlKXx8XCJcIixwaG9uZToobnVsbD09ZT92b2lkIDA6ZS5waG9uZU51bWJlcil8fFwiXCIsc3RhdGVPclByb3ZpbmNlOihudWxsPT1lP3ZvaWQgMDplLmFkbWluaXN0cmF0aXZlQXJlYSl8fFwiXCIsc3RhdGVPclByb3ZpbmNlQ29kZToobnVsbD09ZT92b2lkIDA6ZS5hZG1pbmlzdHJhdGl2ZUFyZWEpfHxcIlwiLGN1c3RvbUZpZWxkczpbXX19X2dldEJyYWludHJlZURldmljZURhdGEoKXtyZXR1cm4gRih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e2NvbnN0e2RldmljZURhdGE6ZX09eWllbGQgdGhpcy5fYnJhaW50cmVlU2RrLmdldERhdGFDb2xsZWN0b3JPclRocm93KCk7cmV0dXJuIGV9Y2F0Y2goZSl7fX0pfV9pbml0aWFsaXplQnJhaW50cmVlU2RrKCl7cmV0dXJuIEYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMuX3BheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoTi5CUkFJTlRSRUUpO2NvbnN0IGU9dGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2QoTi5CUkFJTlRSRUUpO2UmJmUuY2xpZW50VG9rZW4mJmUuaW5pdGlhbGl6YXRpb25EYXRhJiZ0aGlzLl9icmFpbnRyZWVTZGsuaW5pdGlhbGl6ZShlLmNsaWVudFRva2VuKX0pfX1mdW5jdGlvbiBWKGUpe2lmKCFmdW5jdGlvbihlKXtyZXR1cm5cIkFwcGxlUGF5U2Vzc2lvblwiaW4gZX0oZSkpdGhyb3cgbmV3IEVycm9yKFwiQXBwbGUgcGF5IGlzIG5vdCBzdXBwb3J0ZWRcIil9Y2xhc3MgantjcmVhdGUoZSl7cmV0dXJuIFYod2luZG93KSxuZXcgQXBwbGVQYXlTZXNzaW9uKDEsZSl9fWNsYXNzIHF7Y29uc3RydWN0b3IoZSl7dGhpcy5zY3JpcHRMb2FkZXI9ZSx0aGlzLnNka1ZlcnNpb249XCIxLmxhdGVzdFwifWxvYWRTZGsoKXtyZXR1cm4gZT10aGlzLHQ9dm9pZCAwLG49ZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5zY3JpcHRMb2FkZXIubG9hZFNjcmlwdChgaHR0cHM6Ly9hcHBsZXBheS5jZG4tYXBwbGUuY29tL2pzYXBpLyR7dGhpcy5zZGtWZXJzaW9ufS9hcHBsZS1wYXktc2RrLmpzYCksVih3aW5kb3cpfSxuZXcoKGk9dm9pZCAwKXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKGEsbyl7ZnVuY3Rpb24gcihlKXt0cnl7bChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2wobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gbChlKXt2YXIgdDtlLmRvbmU/YShlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHIscyl9bCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSk7dmFyIGUsdCxpLG59fWNvbnN0IEg9RChuPT57Y29uc3R7Z2V0SG9zdDphfT1uLmdldFN0YXRlKCksbz1uZXcgYyhuKTtyZXR1cm4gbmV3IFIoZSh7aG9zdDphKCl9KSxuLG5ldyBqLG5ldyBUKG5ldyBPKGkoKSx3aW5kb3csbykpLG5ldyBxKG5ldyB0KSl9LFt7aWQ6XCJhcHBsZXBheVwifV0pO2NsYXNzIFcgZXh0ZW5kcyB6e2NvbnN0cnVjdG9yKGUpe2xldCB0PVwiVW5hYmxlIHRvIHN1Ym1pdCBwYXltZW50IGZvciB0aGUgb3JkZXIgYmVjYXVzZSB0aGUgcGF5bG9hZCBpcyBpbnZhbGlkLlwiO2UmJih0PWAke3R9IE1ha2Ugc3VyZSB0aGUgZm9sbG93aW5nIGZpZWxkcyBhcmUgcHJvdmlkZWQgY29ycmVjdGx5OiAke2Uuam9pbihcIiwgXCIpfS5gKSxzdXBlcih0KSx0aGlzLm5hbWU9XCJQYXltZW50QXJndW1lbnRJbnZhbGlkRXJyb3JcIn19Y2xhc3MgRyBleHRlbmRzIGh7Y29uc3RydWN0b3IoKXtzdXBlcihcIlRoZSBjdXJyZW50IG9yZGVyIGRvZXMgbm90IG5lZWQgdG8gYmUgZmluYWxpemVkIGF0IHRoaXMgc3RhZ2UuXCIpLHRoaXMubmFtZT1cIk9yZGVyRmluYWxpemF0aW9uTm90UmVxdWlyZWRFcnJvclwiLHRoaXMudHlwZT1cIm9yZGVyX2ZpbmFsaXphdGlvbl9ub3RfcmVxdWlyZWRcIn19dmFyICQsSz1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihhLG8pe2Z1bmN0aW9uIHIoZSl7dHJ5e2wobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtsKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGwoZSl7dmFyIHQ7ZS5kb25lP2EoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihyLHMpfWwoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTshZnVuY3Rpb24oZSl7ZS5TaGlwcGluZz1cIlNoaXBwaW5nXCIsZS5TdWJ0b3RhbD1cIlN1YnRvdGFsXCIsZS5TdG9yZUNyZWRpdD1cIlN0b3JlIENyZWRpdFwifSgkfHwoJD17fSkpO2NsYXNzIFh7Y29uc3RydWN0b3IoZSx0LGksbixhKXt0aGlzLl9yZXF1ZXN0U2VuZGVyPWUsdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZT10LHRoaXMuX3Nlc3Npb25GYWN0b3J5PWksdGhpcy5fYnJhaW50cmVlU2RrPW4sdGhpcy5fYXBwbGVQYXlTY3JpcHRMb2FkZXI9YSx0aGlzLl9zaGlwcGluZ0xhYmVsPSQuU2hpcHBpbmcsdGhpcy5fc3ViVG90YWxMYWJlbD0kLlN1YnRvdGFsLHRoaXMuX3N0b3JlQ3JlZGl0TGFiZWw9JC5TdG9yZUNyZWRpdH1pbml0aWFsaXplKGUpe3ZhciB0LGksbixhO3JldHVybiBLKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighKG51bGw9PWU/dm9pZCAwOmUubWV0aG9kSWQpKXRocm93IG5ldyB6KCdVbmFibGUgdG8gc3VibWl0IHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7Y29uc3R7bWV0aG9kSWQ6b309ZTt5aWVsZCB0aGlzLl9hcHBsZVBheVNjcmlwdExvYWRlci5sb2FkU2RrKCksdGhpcy5fc2hpcHBpbmdMYWJlbD0obnVsbD09PSh0PWUuYXBwbGVwYXkpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LnNoaXBwaW5nTGFiZWwpfHwkLlNoaXBwaW5nLHRoaXMuX3N1YlRvdGFsTGFiZWw9KG51bGw9PT0oaT1lLmFwcGxlcGF5KXx8dm9pZCAwPT09aT92b2lkIDA6aS5zdWJ0b3RhbExhYmVsKXx8JC5TdWJ0b3RhbCx0aGlzLl9zdG9yZUNyZWRpdExhYmVsPShudWxsPT09KG49ZS5hcHBsZXBheSl8fHZvaWQgMD09PW4/dm9pZCAwOm4uc3RvcmVDcmVkaXRMYWJlbCl8fCQuU3RvcmVDcmVkaXQ7Y29uc3Qgcj0oeWllbGQgdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChvKSkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3cobyk7KG51bGw9PT0oYT1yLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PWE/dm9pZCAwOmEuZ2F0ZXdheSk9PT1OLkJSQUlOVFJFRSYmKHlpZWxkIHRoaXMuX2luaXRpYWxpemVCcmFpbnRyZWVTZGsoKSl9KX1leGVjdXRlKGUsdCl7cmV0dXJuIEsodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6aX09ZSxuPXRoaXMuX3BheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTtpZighaSl0aHJvdyBuZXcgVyhbXCJwYXltZW50XCJdKTtjb25zdHttZXRob2RJZDphfT1pLG89bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhhKSxyPXRoaXMuX2dldEJhc2VSZXF1ZXN0KG4sbykscz10aGlzLl9zZXNzaW9uRmFjdG9yeS5jcmVhdGUocik7cmV0dXJuIHlpZWxkIHRoaXMuX3BheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIoe3VzZVN0b3JlQ3JlZGl0OmUudXNlU3RvcmVDcmVkaXR9LHQpLHMuYmVnaW4oKSxuZXcgUHJvbWlzZSgoZSx0KT0+e3RoaXMuX2hhbmRsZUFwcGxlUGF5RXZlbnRzKHMsbyx7cmVzb2x2ZTplLHJlamVjdDp0fSl9KX0pfWZpbmFsaXplKCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBHKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9X2dldEJhc2VSZXF1ZXN0KGUsdCl7Y29uc3QgaT1lLmdldENoZWNrb3V0T3JUaHJvdygpLG49ZS5nZXRDYXJ0T3JUaHJvdygpLGE9ZS5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKSx7c3RvcmVQcm9maWxlOntzdG9yZUNvdW50cnlDb2RlOm8sc3RvcmVOYW1lOnJ9fT1hLHtjdXJyZW5jeTp7Y29kZTpzLGRlY2ltYWxQbGFjZXM6bH19PW4se2luaXRpYWxpemF0aW9uRGF0YTp7bWVyY2hhbnRDYXBhYmlsaXRpZXM6ZCxzdXBwb3J0ZWROZXR3b3JrczpjfX09dCx7Z3JhbmRUb3RhbDpoLGlzU3RvcmVDcmVkaXRBcHBsaWVkOnUsb3V0c3RhbmRpbmdCYWxhbmNlOnB9PWksbT1be2xhYmVsOnRoaXMuX3N1YlRvdGFsTGFiZWwsYW1vdW50OmAke2kuc3VidG90YWwudG9GaXhlZChsKX1gfV07aWYoaS50YXhlcy5mb3JFYWNoKGU9Pm0ucHVzaCh7bGFiZWw6ZS5uYW1lLGFtb3VudDpgJHtlLmFtb3VudC50b0ZpeGVkKGwpfWB9KSksbS5wdXNoKHtsYWJlbDp0aGlzLl9zaGlwcGluZ0xhYmVsLGFtb3VudDpgJHtpLnNoaXBwaW5nQ29zdFRvdGFsLnRvRml4ZWQobCl9YH0pLHUpe2NvbnN0e3N0b3JlQ3JlZGl0OnR9PWUuZ2V0Q3VzdG9tZXJPclRocm93KCk7bS5wdXNoKHtsYWJlbDp0aGlzLl9zdG9yZUNyZWRpdExhYmVsLGFtb3VudDpgLSR7TWF0aC5taW4oaCx0KS50b0ZpeGVkKGwpfWB9KX1yZXR1cm57Y291bnRyeUNvZGU6byxjdXJyZW5jeUNvZGU6cyxtZXJjaGFudENhcGFiaWxpdGllczpkLHN1cHBvcnRlZE5ldHdvcmtzOmMsbGluZUl0ZW1zOm0sdG90YWw6e2xhYmVsOnIsYW1vdW50OmAke3AudG9GaXhlZChsKX1gLHR5cGU6XCJmaW5hbFwifX19X2hhbmRsZUFwcGxlUGF5RXZlbnRzKGUsdCxpKXtlLm9udmFsaWRhdGVtZXJjaGFudD1pPT5LKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3R7Ym9keTpufT15aWVsZCB0aGlzLl9vblZhbGlkYXRlTWVyY2hhbnQodCxpKTtlLmNvbXBsZXRlTWVyY2hhbnRWYWxpZGF0aW9uKG4pfWNhdGNoKGUpe3Rocm93IG5ldyBFcnJvcihcIk1lcmNoYW50IHZhbGlkYXRpb24gZmFpbGVkXCIpfX0pLGUub25jYW5jZWw9KCk9PksodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiBpLnJlamVjdChuZXcgeChcIkNvbnRpbnVlIHdpdGggYXBwbGVwYXlcIikpfSksZS5vbnBheW1lbnRhdXRob3JpemVkPW49PnRoaXMuX29uUGF5bWVudEF1dGhvcml6ZWQobixlLHQsaSl9X29uVmFsaWRhdGVNZXJjaGFudChlLHQpe3JldHVybiBLKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPVtgdmFsaWRhdGlvblVybD0ke3QudmFsaWRhdGlvblVSTH1gLGBtZXJjaGFudElkZW50aWZpZXI9JHtlLmluaXRpYWxpemF0aW9uRGF0YS5tZXJjaGFudElkfWAsYGRpc3BsYXlOYW1lPSR7ZS5pbml0aWFsaXphdGlvbkRhdGEuc3RvcmVOYW1lfWAsYGRvbWFpbk5hbWU9JHt3aW5kb3cubG9jYXRpb24uaG9zdG5hbWV9YF0uam9pbihcIiZcIik7cmV0dXJuIHRoaXMuX3JlcXVlc3RTZW5kZXIucG9zdChgJHtlLmluaXRpYWxpemF0aW9uRGF0YS5wYXltZW50c1VybH0vYXBpL3B1YmxpYy92MS9wYXltZW50cy9hcHBsZXBheS92YWxpZGF0ZV9tZXJjaGFudGAse2NyZWRlbnRpYWxzOiExLGhlYWRlcnM6e0FjY2VwdDpcImFwcGxpY2F0aW9uL2pzb25cIixcIkNvbnRlbnQtVHlwZVwiOlwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIsXCJYLVhTUkYtVE9LRU5cIjpudWxsfSxib2R5Oml9KX0pfV9vblBheW1lbnRBdXRob3JpemVkKGUsdCxpLG4pe3ZhciBhO3JldHVybiBLKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHt0b2tlbjpvfT1lLnBheW1lbnQ7bGV0IHI7KG51bGw9PT0oYT1pLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PWE/dm9pZCAwOmEuZ2F0ZXdheSk9PT1OLkJSQUlOVFJFRSYmKHI9eWllbGQgdGhpcy5fZ2V0QnJhaW50cmVlRGV2aWNlRGF0YSgpKTtjb25zdCBzPXttZXRob2RJZDppLmlkLHBheW1lbnREYXRhOntkZXZpY2VTZXNzaW9uSWQ6cixmb3JtYXR0ZWRQYXlsb2FkOnthcHBsZV9wYXlfdG9rZW46e3BheW1lbnRfZGF0YTpvLnBheW1lbnREYXRhLHBheW1lbnRfbWV0aG9kOm8ucGF5bWVudE1ldGhvZCx0cmFuc2FjdGlvbl9pZDpvLnRyYW5zYWN0aW9uSWRlbnRpZmllcn19fX07dHJ5e3JldHVybiB5aWVsZCB0aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQocyksdC5jb21wbGV0ZVBheW1lbnQoQXBwbGVQYXlTZXNzaW9uLlNUQVRVU19TVUNDRVNTKSxuLnJlc29sdmUoKX1jYXRjaChlKXtyZXR1cm4gdC5jb21wbGV0ZVBheW1lbnQoQXBwbGVQYXlTZXNzaW9uLlNUQVRVU19GQUlMVVJFKSxuLnJlamVjdChuZXcgZihwLlBheW1lbnROb3RJbml0aWFsaXplZCkpfX0pfV9nZXRCcmFpbnRyZWVEZXZpY2VEYXRhKCl7cmV0dXJuIEsodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdHtkZXZpY2VEYXRhOmV9PXlpZWxkIHRoaXMuX2JyYWludHJlZVNkay5nZXREYXRhQ29sbGVjdG9yT3JUaHJvdygpO3JldHVybiBlfWNhdGNoKGUpe319KX1faW5pdGlhbGl6ZUJyYWludHJlZVNkaygpe3JldHVybiBLKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBlPXRoaXMuX3BheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTtsZXQgdD1lLmdldFBheW1lbnRNZXRob2QoTi5CUkFJTlRSRUVfRkFTVExBTkUpfHxlLmdldFBheW1lbnRNZXRob2QoTi5CUkFJTlRSRUUpO3R8fCh5aWVsZCB0aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKE4uQlJBSU5UUkVFKSx0PWUuZ2V0UGF5bWVudE1ldGhvZChOLkJSQUlOVFJFRSkpLHQmJnQuY2xpZW50VG9rZW4mJnQuaW5pdGlhbGl6YXRpb25EYXRhJiZ0aGlzLl9icmFpbnRyZWVTZGsuaW5pdGlhbGl6ZSh0LmNsaWVudFRva2VuKX0pfX1jb25zdCBZPUQobj0+e2NvbnN0e2dldEhvc3Q6YX09bi5nZXRTdGF0ZSgpLG89bmV3IGMobik7cmV0dXJuIG5ldyBYKGUoe2hvc3Q6YSgpfSksbixuZXcgaixuZXcgVChuZXcgTyhpKCksd2luZG93LG8pKSxuZXcgcShuZXcgdCkpfSxbe2lkOlwiYXBwbGVwYXlcIn1dKTtjbGFzcyBRIGV4dGVuZHMgaHtjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIkFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFzIG9jY3VycmVkIGR1cmluZyBidXkgbm93IGNhcnQgY3JlYXRpb24gcHJvY2Vzcy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiksdGhpcy5uYW1lPVwiQnV5Tm93Q2FydENyZWF0aW9uRXJyb3JcIix0aGlzLnR5cGU9XCJidXlfbm93X2NhcnRfY3JlYXRpb25fZXJyb3JcIn19dmFyIFosSixlZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihhLG8pe2Z1bmN0aW9uIHIoZSl7dHJ5e2wobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtsKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGwoZSl7dmFyIHQ7ZS5kb25lP2EoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihyLHMpfWwoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTshZnVuY3Rpb24oZSl7ZS5TdWJ0b3RhbD1cIlN1YnRvdGFsXCIsZS5TaGlwcGluZz1cIlNoaXBwaW5nXCJ9KFp8fChaPXt9KSksZnVuY3Rpb24oZSl7ZS5CbGFjaz1cImJsYWNrXCIsZS5XaGl0ZT1cIndoaXRlXCIsZS5XaGl0ZUJvcmRlcj1cIndoaXRlLWJvcmRlclwifShKfHwoSj17fSkpO2NsYXNzIHRle2NvbnN0cnVjdG9yKGUsdCxpLG4sbyl7dGhpcy5fcmVxdWVzdFNlbmRlcj1lLHRoaXMuX3BheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9dCx0aGlzLl9zZXNzaW9uRmFjdG9yeT1pLHRoaXMuX2JyYWludHJlZVNkaz1uLHRoaXMuX2FwcGxlUGF5U2NyaXB0TG9hZGVyPW8sdGhpcy5fb25BdXRob3JpemVDYWxsYmFjaz1hLHRoaXMuX3N1YlRvdGFsTGFiZWw9Wi5TdWJ0b3RhbCx0aGlzLl9zaGlwcGluZ0xhYmVsPVouU2hpcHBpbmd9aW5pdGlhbGl6ZShlKXt2YXIgdCxpO3JldHVybiBlZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6bixjb250YWluZXJJZDphLGFwcGxlcGF5Om99PWU7aWYoIW58fCFvKXRocm93IG5ldyBCKE0uTWlzc2luZ1BheW1lbnRNZXRob2QpO3lpZWxkIHRoaXMuX2FwcGxlUGF5U2NyaXB0TG9hZGVyLmxvYWRTZGsoKTtjb25zdHtvblBheW1lbnRBdXRob3JpemU6cixidXlOb3dJbml0aWFsaXplT3B0aW9uczpzLHJlcXVpcmVzU2hpcHBpbmc6bH09bzt0aGlzLl9yZXF1aXJlc1NoaXBwaW5nPWwsdGhpcy5fYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnM9cyx0aGlzLl9vbkF1dGhvcml6ZUNhbGxiYWNrPXIsc3x8KHlpZWxkIHRoaXMuX3BheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZERlZmF1bHRDaGVja291dCgpKSx5aWVsZCB0aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKG4pO2NvbnN0IGQ9dGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3JldHVybiB0aGlzLl9wYXltZW50TWV0aG9kPWQuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3cobiksZC5nZXRDYXJ0KCkmJih5aWVsZCB0aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnZlcmlmeUNoZWNrb3V0U3BhbVByb3RlY3Rpb24oKSksKG51bGw9PT0odD10aGlzLl9wYXltZW50TWV0aG9kLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuZ2F0ZXdheSk9PT1OLkJSQUlOVFJFRSYmKHlpZWxkIHRoaXMuX2luaXRpYWxpemVCcmFpbnRyZWVTZGsoKSksdGhpcy5fYXBwbGVQYXlCdXR0b249dGhpcy5fY3JlYXRlQnV0dG9uKGEsbnVsbD09PShpPXRoaXMuX3BheW1lbnRNZXRob2QuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09aT92b2lkIDA6aS5zdHlsZU9wdGlvbiksdGhpcy5fYXBwbGVQYXlCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsdGhpcy5faGFuZGxlV2FsbGV0QnV0dG9uQ2xpY2suYmluZCh0aGlzKSksUHJvbWlzZS5yZXNvbHZlKCl9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9X2NyZWF0ZUJ1dHRvbihlLHQpe2NvbnN0IGk9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk7aWYoIWkpdGhyb3cgbmV3IHooXCJVbmFibGUgdG8gY3JlYXRlIHdhbGxldCBidXR0b24gd2l0aG91dCB2YWxpZCBjb250YWluZXIgSUQuXCIpO2NvbnN0IG49dGhpcy5fY3JlYXRlQXBwbGVQYXlCdXR0b25FbGVtZW50KHQpO3JldHVybiBpLmFwcGVuZENoaWxkKG4pLG59X2NyZWF0ZUFwcGxlUGF5QnV0dG9uRWxlbWVudChlKXtjb25zdCB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhcHBsZS1wYXktYnV0dG9uXCIpO3JldHVybiB0LnNldEF0dHJpYnV0ZShcImJ1dHRvbnN0eWxlXCIsKGU9Pntzd2l0Y2goZSl7Y2FzZSBKLldoaXRlOnJldHVyblwid2hpdGVcIjtjYXNlIEouV2hpdGVCb3JkZXI6cmV0dXJuXCJ3aGl0ZS1vdXRsaW5lXCI7Y2FzZSBKLkJsYWNrOmRlZmF1bHQ6cmV0dXJuXCJibGFja1wifX0pKGUpKSx0LnNldEF0dHJpYnV0ZShcInR5cGVcIixcInBsYWluXCIpLHQuc2V0QXR0cmlidXRlKFwic3R5bGVcIixcIi0tYXBwbGUtcGF5LWJ1dHRvbi13aWR0aDogMTAwJTsgLS1hcHBsZS1wYXktYnV0dG9uLWhlaWdodDogNDBweDsgLS1hcHBsZS1wYXktYnV0dG9uLWJvcmRlci1yYWRpdXM6IDRweDtcIiksdH1faGFuZGxlV2FsbGV0QnV0dG9uQ2xpY2soZSl7dmFyIHQ7cmV0dXJuIGVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZihlLnByZXZlbnREZWZhdWx0KCksIXRoaXMuX3BheW1lbnRNZXRob2R8fCF0aGlzLl9wYXltZW50TWV0aG9kLmluaXRpYWxpemF0aW9uRGF0YSl0aHJvdyBuZXcgQihNLk1pc3NpbmdQYXltZW50TWV0aG9kKTtpZih0aGlzLl9idXlOb3dJbml0aWFsaXplT3B0aW9ucyYmXCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5fYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnMuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5KXtjb25zdHtjb3VudHJ5Q29kZTplLGN1cnJlbmN5Q29kZTppLG1lcmNoYW50Q2FwYWJpbGl0aWVzOm4sc3VwcG9ydGVkTmV0d29ya3M6YSxzdG9yZU5hbWU6b309dGhpcy5fcGF5bWVudE1ldGhvZC5pbml0aWFsaXphdGlvbkRhdGEscj10aGlzLl9nZXRSZXF1ZXN0V2l0aEVtcHR5VG90YWwoZSxpLGEsbik7dGhpcy5fcmVxdWlyZXNTaGlwcGluZyYmKG51bGw9PT0odD1yLnJlcXVpcmVkU2hpcHBpbmdDb250YWN0RmllbGRzKXx8dm9pZCAwPT09dHx8dC5wdXNoKFwicG9zdGFsQWRkcmVzc1wiKSk7Y29uc3Qgcz10aGlzLl9zZXNzaW9uRmFjdG9yeS5jcmVhdGUocik7dGhpcy5faGFuZGxlQXBwbGVQYXlFdmVudHMocyx0aGlzLl9wYXltZW50TWV0aG9kLG8pLHMuYmVnaW4oKX1lbHNle2NvbnN0IGU9dGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHQ9ZS5nZXRDYXJ0T3JUaHJvdygpLGk9ZS5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKSxuPWUuZ2V0Q2hlY2tvdXRPclRocm93KCksYT10aGlzLl9nZXRCYXNlUmVxdWVzdCh0LG4saSx0aGlzLl9wYXltZW50TWV0aG9kKSxvPXRoaXMuX3Nlc3Npb25GYWN0b3J5LmNyZWF0ZShhKTt0aGlzLl9oYW5kbGVBcHBsZVBheUV2ZW50cyhvLHRoaXMuX3BheW1lbnRNZXRob2QsaS5zdG9yZVByb2ZpbGUuc3RvcmVOYW1lKSxvLmJlZ2luKCl9fSl9X2dldFJlcXVlc3RXaXRoRW1wdHlUb3RhbChlLHQsaSxuKXtyZXR1cm57Y291bnRyeUNvZGU6ZSxjdXJyZW5jeUNvZGU6dCxzdXBwb3J0ZWROZXR3b3JrczppLG1lcmNoYW50Q2FwYWJpbGl0aWVzOm4sdG90YWw6e2xhYmVsOlwiXCIsYW1vdW50OlwiMFwiLHR5cGU6XCJwZW5kaW5nXCJ9LHJlcXVpcmVkQmlsbGluZ0NvbnRhY3RGaWVsZHM6W1wicG9zdGFsQWRkcmVzc1wiXSxyZXF1aXJlZFNoaXBwaW5nQ29udGFjdEZpZWxkczpbXCJlbWFpbFwiLFwicGhvbmVcIl19fV9nZXRCYXNlUmVxdWVzdChlLHQsaSxuKXt2YXIgYTtjb25zdHtzdG9yZVByb2ZpbGU6e3N0b3JlQ291bnRyeUNvZGU6byxzdG9yZU5hbWU6cn19PWkse2N1cnJlbmN5Ontjb2RlOnMsZGVjaW1hbFBsYWNlczpsfX09ZSx7aW5pdGlhbGl6YXRpb25EYXRhOnttZXJjaGFudENhcGFiaWxpdGllczpkLHN1cHBvcnRlZE5ldHdvcmtzOmN9fT1uLGg9ZS5saW5lSXRlbXMucGh5c2ljYWxJdGVtcy5sZW5ndGg+MCx1PXtyZXF1aXJlZEJpbGxpbmdDb250YWN0RmllbGRzOltcInBvc3RhbEFkZHJlc3NcIl0scmVxdWlyZWRTaGlwcGluZ0NvbnRhY3RGaWVsZHM6W1wiZW1haWxcIixcInBob25lXCJdLGNvdW50cnlDb2RlOm8sY3VycmVuY3lDb2RlOnMsbWVyY2hhbnRDYXBhYmlsaXRpZXM6ZCxzdXBwb3J0ZWROZXR3b3JrczpjLGxpbmVJdGVtczpbXSx0b3RhbDpoP3tsYWJlbDpyLGFtb3VudDpgJHt0LmdyYW5kVG90YWwudG9GaXhlZChsKX1gLHR5cGU6XCJwZW5kaW5nXCJ9OntsYWJlbDpyLGFtb3VudDpgJHt0LmdyYW5kVG90YWwudG9GaXhlZChsKX1gLHR5cGU6XCJmaW5hbFwifX07aWYoaCludWxsPT09KGE9dS5yZXF1aXJlZFNoaXBwaW5nQ29udGFjdEZpZWxkcyl8fHZvaWQgMD09PWF8fGEucHVzaChcInBvc3RhbEFkZHJlc3NcIik7ZWxzZXtjb25zdCBlPVt7bGFiZWw6dGhpcy5fc3ViVG90YWxMYWJlbCxhbW91bnQ6YCR7dC5zdWJ0b3RhbC50b0ZpeGVkKGwpfWB9XTt0LnRheGVzLmZvckVhY2godD0+ZS5wdXNoKHtsYWJlbDp0Lm5hbWUsYW1vdW50OmAke3QuYW1vdW50LnRvRml4ZWQobCl9YH0pKSx1LmxpbmVJdGVtcz1lfXJldHVybiB1fV9oYW5kbGVBcHBsZVBheUV2ZW50cyhlLHQsaSl7ZS5vbnZhbGlkYXRlbWVyY2hhbnQ9aT0+ZWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdHtib2R5Om59PXlpZWxkIHRoaXMuX29uVmFsaWRhdGVNZXJjaGFudCh0LGkpO2UuY29tcGxldGVNZXJjaGFudFZhbGlkYXRpb24obil9Y2F0Y2goZSl7dGhyb3cgbmV3IEVycm9yKFwiTWVyY2hhbnQgdmFsaWRhdGlvbiBmYWlsZWRcIil9fSksdGhpcy5fYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnMmJiF0aGlzLl9yZXF1aXJlc1NoaXBwaW5nJiYoZS5vbnBheW1lbnRtZXRob2RzZWxlY3RlZD0oKT0+ZWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMuX2NyZWF0ZUJ1eU5vd0NhcnQoKSx0aGlzLl9oYW5kbGVQYXltZW50TWV0aG9kU2VsZWN0ZWQoZSl9KSksZS5vbnNoaXBwaW5nY29udGFjdHNlbGVjdGVkPXQ9PmVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0aGlzLl9idXlOb3dJbml0aWFsaXplT3B0aW9ucyYmdGhpcy5fcmVxdWlyZXNTaGlwcGluZyYmKHlpZWxkIHRoaXMuX2NyZWF0ZUJ1eU5vd0NhcnQoKSkseWllbGQgdGhpcy5faGFuZGxlU2hpcHBpbmdDb250YWN0U2VsZWN0ZWQoZSxpLHQpfSksZS5vbnNoaXBwaW5nbWV0aG9kc2VsZWN0ZWQ9dD0+ZWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMuX2hhbmRsZVNoaXBwaW5nTWV0aG9kU2VsZWN0ZWQoZSxpLHQpfSksZS5vbmNhbmNlbD0oKT0+ZWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdCBlPWAvcmVtb3RlLWNoZWNrb3V0LyR7dC5pZH0vc2lnbm91dGA7cmV0dXJuIHlpZWxkIHRoaXMuX3JlcXVlc3RTZW5kZXIuZ2V0KGUpLHlpZWxkIHRoaXMuX3BheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZENoZWNrb3V0KCl9Y2F0Y2goZSl7dGhyb3cgbmV3IHh9fSksZS5vbnBheW1lbnRhdXRob3JpemVkPWk9PmVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5fb25QYXltZW50QXV0aG9yaXplZChpLGUsdCl9KX1fY3JlYXRlQnV5Tm93Q2FydCgpe3ZhciBlLHQ7cmV0dXJuIGVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3QgaT1udWxsPT09KHQ9bnVsbD09PShlPXRoaXMuX2J1eU5vd0luaXRpYWxpemVPcHRpb25zKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmNhbGwoZSk7aWYoIWkpdGhyb3cgbmV3IEIoTS5NaXNzaW5nQ2FydCk7Y29uc3Qgbj15aWVsZCB0aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZUJ1eU5vd0NhcnQoaSk7eWllbGQgdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkQ2hlY2tvdXQobi5pZCk7Y29uc3QgYT10aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkse3Nob3VsZEV4ZWN1dGVTcGFtQ2hlY2s6b309YS5nZXRDaGVja291dE9yVGhyb3coKTtvJiYoeWllbGQgdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS52ZXJpZnlDaGVja291dFNwYW1Qcm90ZWN0aW9uKCkpfWNhdGNoKGUpe3Rocm93IG5ldyBRfX0pfV9oYW5kbGVQYXltZW50TWV0aG9kU2VsZWN0ZWQoZSl7Y29uc3QgdD10aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksaT10LmdldENhcnRPclRocm93KCksbj10LmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLGE9dC5nZXRDaGVja291dE9yVGhyb3coKTtpZighdGhpcy5fcGF5bWVudE1ldGhvZHx8IXRoaXMuX3BheW1lbnRNZXRob2QuaW5pdGlhbGl6YXRpb25EYXRhKXRocm93IG5ldyBCKE0uTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0IG89dGhpcy5fZ2V0QmFzZVJlcXVlc3QoaSxhLG4sdGhpcy5fcGF5bWVudE1ldGhvZCk7ZGVsZXRlIG8udG90YWwudHlwZSxlLmNvbXBsZXRlUGF5bWVudE1ldGhvZFNlbGVjdGlvbih7bmV3VG90YWw6by50b3RhbCxuZXdMaW5lSXRlbXM6by5saW5lSXRlbXN9KX1faGFuZGxlU2hpcHBpbmdDb250YWN0U2VsZWN0ZWQoZSx0LGkpe3ZhciBuO3JldHVybiBlZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgYT10aGlzLl90cmFuc2Zvcm1Db250YWN0VG9BZGRyZXNzKGkuc2hpcHBpbmdDb250YWN0KTt0cnl7eWllbGQgdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVTaGlwcGluZ0FkZHJlc3MoYSl9Y2F0Y2godCl7dGhyb3cgZS5hYm9ydCgpLG5ldyBFcnJvcihcIlNoaXBwaW5nIGFkZHJlc3MgdXBkYXRlIGZhaWxlZFwiKX1sZXQgbz10aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCk7Y29uc3R7Y3VycmVuY3k6e2RlY2ltYWxQbGFjZXM6cn19PW8uZ2V0Q2FydE9yVGhyb3coKTtsZXQgcz1vLmdldENoZWNrb3V0T3JUaHJvdygpO2NvbnN0IGw9bnVsbD09PShuPXMuY29uc2lnbm1lbnRzWzBdLnNlbGVjdGVkU2hpcHBpbmdPcHRpb24pfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmlkLGQ9cy5jb25zaWdubWVudHNbMF0uYXZhaWxhYmxlU2hpcHBpbmdPcHRpb25zLGM9bnVsbD09ZD92b2lkIDA6ZC5maW5kKCh7aWQ6ZX0pPT5lPT09bCksaD1udWxsPT1kP3ZvaWQgMDpkLmZpbHRlcihlPT5lLmlkIT09bCksdT1jP1t7bGFiZWw6Yy5kZXNjcmlwdGlvbixhbW91bnQ6YCR7Yy5jb3N0LnRvRml4ZWQocil9YCxkZXRhaWw6Yy5hZGRpdGlvbmFsRGVzY3JpcHRpb24saWRlbnRpZmllcjpjLmlkfV06W107aWYoaCYmWy4uLmguZmlsdGVyKGU9PmUuaXNSZWNvbW1lbmRlZCksLi4uaC5maWx0ZXIoZT0+IWUuaXNSZWNvbW1lbmRlZCldLmZvckVhY2goZT0+dS5wdXNoKHtsYWJlbDplLmRlc2NyaXB0aW9uLGFtb3VudDpgJHtlLmNvc3QudG9GaXhlZChyKX1gLGRldGFpbDplLmFkZGl0aW9uYWxEZXNjcmlwdGlvbixpZGVudGlmaWVyOmUuaWR9KSksIShkIGluc3RhbmNlb2YgQXJyYXkpKXRocm93IG5ldyBFcnJvcihcIlNoaXBwaW5nIG9wdGlvbnMgbm90IGF2YWlsYWJsZS5cIik7aWYoMD09PWQubGVuZ3RoKXJldHVybiB2b2lkIGUuY29tcGxldGVTaGlwcGluZ0NvbnRhY3RTZWxlY3Rpb24oQXBwbGVQYXlTZXNzaW9uLlNUQVRVU19JTlZBTElEX1NISVBQSU5HX1BPU1RBTF9BRERSRVNTLFtdLHt0eXBlOlwicGVuZGluZ1wiLGxhYmVsOnQsYW1vdW50OmAke3MuZ3JhbmRUb3RhbC50b0ZpeGVkKHIpfWB9LFtdKTtjb25zdCBwPWQuZmluZChlPT5lLmlzUmVjb21tZW5kZWQpLG09cD9wLmlkOmRbMF0uaWQseT1jP2MuaWQ6bTt0cnl7eWllbGQgdGhpcy5fdXBkYXRlU2hpcHBpbmdPcHRpb24oeSl9Y2F0Y2goZSl7dGhyb3cgbmV3IEVycm9yKFwiU2hpcHBpbmcgb3B0aW9ucyB1cGRhdGUgZmFpbGVkXCIpfW89dGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHM9by5nZXRDaGVja291dE9yVGhyb3coKSxlLmNvbXBsZXRlU2hpcHBpbmdDb250YWN0U2VsZWN0aW9uKHtuZXdTaGlwcGluZ01ldGhvZHM6dSxuZXdUb3RhbDp7dHlwZTpcImZpbmFsXCIsbGFiZWw6dCxhbW91bnQ6YCR7cy5ncmFuZFRvdGFsLnRvRml4ZWQocil9YH0sbmV3TGluZUl0ZW1zOnRoaXMuX2dldFVwZGF0ZWRMaW5lSXRlbXMocyxyKX0pfSl9X2hhbmRsZVNoaXBwaW5nTWV0aG9kU2VsZWN0ZWQoZSx0LGkpe3JldHVybiBlZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7c2hpcHBpbmdNZXRob2Q6e2lkZW50aWZpZXI6bn19PWk7dHJ5e3lpZWxkIHRoaXMuX3VwZGF0ZVNoaXBwaW5nT3B0aW9uKG4pfWNhdGNoKHQpe3Rocm93IGUuYWJvcnQoKSxuZXcgRXJyb3IoXCJTaGlwcGluZyBvcHRpb24gc2VsZWN0aW9uIHVwZGF0ZSBmYWlsZWQuXCIpfWNvbnN0IGE9dGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHtjdXJyZW5jeTp7ZGVjaW1hbFBsYWNlczpvfX09YS5nZXRDYXJ0T3JUaHJvdygpLHI9YS5nZXRDaGVja291dE9yVGhyb3coKTtlLmNvbXBsZXRlU2hpcHBpbmdNZXRob2RTZWxlY3Rpb24oe25ld1RvdGFsOnt0eXBlOlwiZmluYWxcIixsYWJlbDp0LGFtb3VudDpgJHtyLmdyYW5kVG90YWwudG9GaXhlZChvKX1gfSxuZXdMaW5lSXRlbXM6dGhpcy5fZ2V0VXBkYXRlZExpbmVJdGVtcyhyLG8pfSl9KX1fZ2V0VXBkYXRlZExpbmVJdGVtcyhlLHQpe2NvbnN0IGk9W3tsYWJlbDp0aGlzLl9zdWJUb3RhbExhYmVsLGFtb3VudDpgJHtlLnN1YnRvdGFsLnRvRml4ZWQodCl9YH1dO3JldHVybiBlLnRheGVzLmZvckVhY2goZT0+aS5wdXNoKHtsYWJlbDplLm5hbWUsYW1vdW50OmAke2UuYW1vdW50LnRvRml4ZWQodCl9YH0pKSxpLnB1c2goe2xhYmVsOnRoaXMuX3NoaXBwaW5nTGFiZWwsYW1vdW50OmAke2Uuc2hpcHBpbmdDb3N0VG90YWwudG9GaXhlZCh0KX1gfSksaX1fdXBkYXRlU2hpcHBpbmdPcHRpb24oZSl7cmV0dXJuIGVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5zZWxlY3RTaGlwcGluZ09wdGlvbihlKX0pfV9vblZhbGlkYXRlTWVyY2hhbnQoZSx0KXtyZXR1cm4gZWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9W2B2YWxpZGF0aW9uVXJsPSR7dC52YWxpZGF0aW9uVVJMfWAsYG1lcmNoYW50SWRlbnRpZmllcj0ke2UuaW5pdGlhbGl6YXRpb25EYXRhLm1lcmNoYW50SWR9YCxgZGlzcGxheU5hbWU9JHtlLmluaXRpYWxpemF0aW9uRGF0YS5zdG9yZU5hbWV9YCxgZG9tYWluTmFtZT0ke3dpbmRvdy5sb2NhdGlvbi5ob3N0bmFtZX1gXS5qb2luKFwiJlwiKTtyZXR1cm4gdGhpcy5fcmVxdWVzdFNlbmRlci5wb3N0KGAke2UuaW5pdGlhbGl6YXRpb25EYXRhLnBheW1lbnRzVXJsfS9hcGkvcHVibGljL3YxL3BheW1lbnRzL2FwcGxlcGF5L3ZhbGlkYXRlX21lcmNoYW50YCx7Y3JlZGVudGlhbHM6ITEsaGVhZGVyczp7QWNjZXB0OlwiYXBwbGljYXRpb24vanNvblwiLFwiQ29udGVudC1UeXBlXCI6XCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIixcIlgtWFNSRi1UT0tFTlwiOm51bGx9LGJvZHk6aX0pfSl9X29uUGF5bWVudEF1dGhvcml6ZWQoZSx0LGkpe3ZhciBuO3JldHVybiBlZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7dG9rZW46YSxiaWxsaW5nQ29udGFjdDpvLHNoaXBwaW5nQ29udGFjdDpyfT1lLnBheW1lbnQscz10aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKS5saW5lSXRlbXMucGh5c2ljYWxJdGVtcy5sZW5ndGg+MDtsZXQgbDsobnVsbD09PShuPWkuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09bj92b2lkIDA6bi5nYXRld2F5KT09PU4uQlJBSU5UUkVFJiYobD15aWVsZCB0aGlzLl9nZXRCcmFpbnRyZWVEZXZpY2VEYXRhKCkpO2NvbnN0IGQ9e21ldGhvZElkOmkuaWQscGF5bWVudERhdGE6e2RldmljZVNlc3Npb25JZDpsLGZvcm1hdHRlZFBheWxvYWQ6e2FwcGxlX3BheV90b2tlbjp7cGF5bWVudF9kYXRhOmEucGF5bWVudERhdGEscGF5bWVudF9tZXRob2Q6YS5wYXltZW50TWV0aG9kLHRyYW5zYWN0aW9uX2lkOmEudHJhbnNhY3Rpb25JZGVudGlmaWVyfX19fSxjPXRoaXMuX3RyYW5zZm9ybUNvbnRhY3RUb0FkZHJlc3MobyksaD10aGlzLl90cmFuc2Zvcm1Db250YWN0VG9BZGRyZXNzKHIpLHU9bnVsbD09cj92b2lkIDA6ci5lbWFpbEFkZHJlc3MscD0obnVsbD09cj92b2lkIDA6ci5waG9uZU51bWJlcil8fFwiXCI7dHJ5e3JldHVybiB5aWVsZCB0aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZUJpbGxpbmdBZGRyZXNzKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxjKSx7ZW1haWw6dSxwaG9uZTpwfSkpLHMmJih5aWVsZCB0aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVNoaXBwaW5nQWRkcmVzcyhoKSkseWllbGQgdGhpcy5fcGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcih7dXNlU3RvcmVDcmVkaXQ6ITF9KSx5aWVsZCB0aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoZCksdC5jb21wbGV0ZVBheW1lbnQoQXBwbGVQYXlTZXNzaW9uLlNUQVRVU19TVUNDRVNTKSx0aGlzLl9vbkF1dGhvcml6ZUNhbGxiYWNrKCl9Y2F0Y2goZSl7dGhyb3cgdC5jb21wbGV0ZVBheW1lbnQoQXBwbGVQYXlTZXNzaW9uLlNUQVRVU19GQUlMVVJFKSxuZXcgRXJyb3IoXCJQYXltZW50IGNhbm5vdCBjb21wbGV0ZVwiKX19KX1fdHJhbnNmb3JtQ29udGFjdFRvQWRkcmVzcyhlKXtyZXR1cm57Zmlyc3ROYW1lOihudWxsPT1lP3ZvaWQgMDplLmdpdmVuTmFtZSl8fFwiXCIsbGFzdE5hbWU6KG51bGw9PWU/dm9pZCAwOmUuZmFtaWx5TmFtZSl8fFwiXCIsY2l0eToobnVsbD09ZT92b2lkIDA6ZS5sb2NhbGl0eSl8fFwiXCIsY29tcGFueTpcIlwiLGFkZHJlc3MxOihudWxsPT1lP3ZvaWQgMDplLmFkZHJlc3NMaW5lcykmJmUuYWRkcmVzc0xpbmVzWzBdfHxcIlwiLGFkZHJlc3MyOihudWxsPT1lP3ZvaWQgMDplLmFkZHJlc3NMaW5lcykmJmUuYWRkcmVzc0xpbmVzWzFdfHxcIlwiLHBvc3RhbENvZGU6KG51bGw9PWU/dm9pZCAwOmUucG9zdGFsQ29kZSl8fFwiXCIsY291bnRyeUNvZGU6KG51bGw9PWU/dm9pZCAwOmUuY291bnRyeUNvZGUpfHxcIlwiLHBob25lOihudWxsPT1lP3ZvaWQgMDplLnBob25lTnVtYmVyKXx8XCJcIixzdGF0ZU9yUHJvdmluY2U6KG51bGw9PWU/dm9pZCAwOmUuYWRtaW5pc3RyYXRpdmVBcmVhKXx8XCJcIixzdGF0ZU9yUHJvdmluY2VDb2RlOihudWxsPT1lP3ZvaWQgMDplLmFkbWluaXN0cmF0aXZlQXJlYSl8fFwiXCIsY3VzdG9tRmllbGRzOltdfX1fZ2V0QnJhaW50cmVlRGV2aWNlRGF0YSgpe3JldHVybiBlZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e2NvbnN0e2RldmljZURhdGE6ZX09eWllbGQgdGhpcy5fYnJhaW50cmVlU2RrLmdldERhdGFDb2xsZWN0b3JPclRocm93KCk7cmV0dXJuIGV9Y2F0Y2goZSl7fX0pfV9pbml0aWFsaXplQnJhaW50cmVlU2RrKCl7cmV0dXJuIGVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLl9wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKE4uQlJBSU5UUkVFKTtjb25zdCBlPXRoaXMuX3BheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50TWV0aG9kKE4uQlJBSU5UUkVFKTtlJiZlLmNsaWVudFRva2VuJiZlLmluaXRpYWxpemF0aW9uRGF0YSYmdGhpcy5fYnJhaW50cmVlU2RrLmluaXRpYWxpemUoZS5jbGllbnRUb2tlbil9KX19Y29uc3QgaWU9RChuPT57Y29uc3R7Z2V0SG9zdDphfT1uLmdldFN0YXRlKCksbz1uZXcgYyhuKTtyZXR1cm4gbmV3IHRlKGUoe2hvc3Q6YSgpfSksbixuZXcgaixuZXcgVChuZXcgTyhpKCksd2luZG93LG8pKSxuZXcgcShuZXcgdCkpfSxbe2lkOlwiYXBwbGVwYXlcIn1dKTtleHBvcnR7aWUgYXMgY3JlYXRlQXBwbGVQYXlCdXR0b25TdHJhdGVneSxIIGFzIGNyZWF0ZUFwcGxlUGF5Q3VzdG9tZXJTdHJhdGVneSxZIGFzIGNyZWF0ZUFwcGxlUGF5UGF5bWVudFN0cmF0ZWd5fTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcGxlLXBheS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///../checkout-sdk-js/dist/esm/integrations/apple-pay.js\n\n}");

/***/ }),

/***/ "./packages/core/src/app/customer/CheckoutButton.tsx":
/*!***********************************************************!*\
  !*** ./packages/core/src/app/customer/CheckoutButton.tsx ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash */ \"./node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n\n\nconst WALLET_BUTTON_HEIGHT = 36;\nconst CheckoutButton = ({ containerId, methodId, isShowingWalletButtonsOnTop, deinitialize, initialize, onError, onClick = lodash__WEBPACK_IMPORTED_MODULE_0__.noop, }) => {\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(() => {\n        const heightOption = isShowingWalletButtonsOnTop && (methodId === 'braintreepaypal' || methodId === 'braintreepaypalcredit')\n            ? { buttonHeight: WALLET_BUTTON_HEIGHT }\n            : {};\n        initialize({\n            methodId,\n            [methodId]: Object.assign(Object.assign({}, heightOption), { container: containerId, onError, onClick: () => onClick(methodId) }),\n        });\n        return () => {\n            deinitialize({ methodId });\n        };\n    }, []);\n    return react__WEBPACK_IMPORTED_MODULE_1___default().createElement(\"div\", { \"data-test\": containerId, id: containerId });\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CheckoutButton);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvY3VzdG9tZXIvQ2hlY2tvdXRCdXR0b24udHN4IiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQzhCO0FBQzhCO0FBRTVELE1BQU0sb0JBQW9CLEdBQUcsRUFBRSxDQUFDO0FBWWhDLE1BQU0sY0FBYyxHQUFHLENBQUMsRUFDcEIsV0FBVyxFQUNYLFFBQVEsRUFDUiwyQkFBMkIsRUFDM0IsWUFBWSxFQUNaLFVBQVUsRUFDVixPQUFPLEVBQ1AsT0FBTyxHQUFHLHdDQUFJLEdBQ0ksRUFBZ0IsRUFBRTtJQUNwQyxnREFBUyxDQUFDLEdBQUcsRUFBRTtRQUNYLE1BQU0sWUFBWSxHQUFHLDJCQUEyQixJQUFJLENBQUMsUUFBUSxLQUFLLGlCQUFpQixJQUFJLFFBQVEsS0FBSyx1QkFBdUIsQ0FBRTtZQUN6SCxDQUFDLENBQUMsRUFBRSxZQUFZLEVBQUUsb0JBQW9CLEVBQUU7WUFDeEMsQ0FBQyxDQUFDLEVBQUUsQ0FBQztRQUVULFVBQVUsQ0FBQztZQUNQLFFBQVE7WUFDUixDQUFDLFFBQVEsQ0FBQyxrQ0FDSCxZQUFZLEtBQ2YsU0FBUyxFQUFFLFdBQVcsRUFDdEIsT0FBTyxFQUNQLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLEdBQ25DO1NBQ0osQ0FBQyxDQUFDO1FBRUgsT0FBTyxHQUFHLEVBQUU7WUFDUixZQUFZLENBQUMsRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDO1FBQy9CLENBQUMsQ0FBQztJQUNOLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUVQLE9BQU8saUZBQWdCLFdBQVcsRUFBRSxFQUFFLEVBQUUsV0FBVyxHQUFJLENBQUM7QUFDNUQsQ0FBQyxDQUFDO0FBRUYsaUVBQWUsY0FBYyxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2hlY2tvdXQvLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvY3VzdG9tZXIvQ2hlY2tvdXRCdXR0b24udHN4P2NjZTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdHlwZSBDdXN0b21lckluaXRpYWxpemVPcHRpb25zLCB0eXBlIEN1c3RvbWVyUmVxdWVzdE9wdGlvbnMgfSBmcm9tICdAYmlnY29tbWVyY2UvY2hlY2tvdXQtc2RrJztcbmltcG9ydCB7IG5vb3AgfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IFJlYWN0LCB7IHR5cGUgUmVhY3RFbGVtZW50LCB1c2VFZmZlY3QgfSBmcm9tICdyZWFjdCc7XG5cbmNvbnN0IFdBTExFVF9CVVRUT05fSEVJR0hUID0gMzY7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hlY2tvdXRCdXR0b25Qcm9wcyB7XG4gICAgY29udGFpbmVySWQ6IHN0cmluZztcbiAgICBtZXRob2RJZDogc3RyaW5nO1xuICAgIGlzU2hvd2luZ1dhbGxldEJ1dHRvbnNPblRvcD86IGJvb2xlYW47XG4gICAgZGVpbml0aWFsaXplKG9wdGlvbnM6IEN1c3RvbWVyUmVxdWVzdE9wdGlvbnMpOiB2b2lkO1xuICAgIGluaXRpYWxpemUob3B0aW9uczogQ3VzdG9tZXJJbml0aWFsaXplT3B0aW9ucyk6IHZvaWQ7XG4gICAgb25FcnJvcj8oZXJyb3I6IEVycm9yKTogdm9pZDtcbiAgICBvbkNsaWNrPyhtZXRob2RJZDogc3RyaW5nKTogdm9pZDtcbn1cblxuY29uc3QgQ2hlY2tvdXRCdXR0b24gPSAoe1xuICAgIGNvbnRhaW5lcklkLFxuICAgIG1ldGhvZElkLFxuICAgIGlzU2hvd2luZ1dhbGxldEJ1dHRvbnNPblRvcCxcbiAgICBkZWluaXRpYWxpemUsXG4gICAgaW5pdGlhbGl6ZSxcbiAgICBvbkVycm9yLFxuICAgIG9uQ2xpY2sgPSBub29wLFxufTogQ2hlY2tvdXRCdXR0b25Qcm9wcyk6IFJlYWN0RWxlbWVudCA9PiB7XG4gICAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgY29uc3QgaGVpZ2h0T3B0aW9uID0gaXNTaG93aW5nV2FsbGV0QnV0dG9uc09uVG9wICYmIChtZXRob2RJZCA9PT0gJ2JyYWludHJlZXBheXBhbCcgfHwgbWV0aG9kSWQgPT09ICdicmFpbnRyZWVwYXlwYWxjcmVkaXQnIClcbiAgICAgICAgICAgID8geyBidXR0b25IZWlnaHQ6IFdBTExFVF9CVVRUT05fSEVJR0hUIH1cbiAgICAgICAgICAgIDoge307XG5cbiAgICAgICAgaW5pdGlhbGl6ZSh7XG4gICAgICAgICAgICBtZXRob2RJZCxcbiAgICAgICAgICAgIFttZXRob2RJZF06IHtcbiAgICAgICAgICAgICAgICAuLi5oZWlnaHRPcHRpb24sXG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiBjb250YWluZXJJZCxcbiAgICAgICAgICAgICAgICBvbkVycm9yLFxuICAgICAgICAgICAgICAgIG9uQ2xpY2s6ICgpID0+IG9uQ2xpY2sobWV0aG9kSWQpLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgICAgIGRlaW5pdGlhbGl6ZSh7IG1ldGhvZElkIH0pO1xuICAgICAgICB9O1xuICAgIH0sIFtdKTtcblxuICAgIHJldHVybiA8ZGl2IGRhdGEtdGVzdD17Y29udGFpbmVySWR9IGlkPXtjb250YWluZXJJZH0gLz47XG59O1xuXG5leHBvcnQgZGVmYXVsdCBDaGVja291dEJ1dHRvbjtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./packages/core/src/app/customer/CheckoutButton.tsx\n\n}");

/***/ }),

/***/ "./packages/core/src/app/customer/WalletButtonV1Resolver.tsx":
/*!*******************************************************************!*\
  !*** ./packages/core/src/app/customer/WalletButtonV1Resolver.tsx ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.mjs\");\n/* harmony import */ var _bigcommerce_checkout_sdk_integrations_bigcommerce_payments__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @bigcommerce/checkout-sdk/integrations/bigcommerce-payments */ \"../checkout-sdk-js/dist/esm/integrations/bigcommerce-payments.js\");\n/* harmony import */ var _bigcommerce_checkout_sdk_integrations_bolt__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @bigcommerce/checkout-sdk/integrations/bolt */ \"../checkout-sdk-js/dist/esm/integrations/bolt.js\");\n/* harmony import */ var _bigcommerce_checkout_sdk_integrations_braintree__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @bigcommerce/checkout-sdk/integrations/braintree */ \"../checkout-sdk-js/dist/esm/integrations/braintree.js\");\n/* harmony import */ var _bigcommerce_checkout_sdk_integrations_paypal_commerce__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @bigcommerce/checkout-sdk/integrations/paypal-commerce */ \"../checkout-sdk-js/dist/esm/integrations/paypal-commerce.js\");\n/* harmony import */ var _bigcommerce_checkout_sdk_integrations_stripe__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @bigcommerce/checkout-sdk/integrations/stripe */ \"../checkout-sdk-js/dist/esm/integrations/stripe.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _CheckoutButton__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./CheckoutButton */ \"./packages/core/src/app/customer/CheckoutButton.tsx\");\n/* harmony import */ var _customWalletButton__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./customWalletButton */ \"./packages/core/src/app/customer/customWalletButton/ApplePayButton.tsx\");\n\n\n\n\n\n\n\n\n\nconst CheckoutButtonV1Resolver = (_a) => {\n    var { isShowingWalletButtonsOnTop = false, initialize, onError, methodId } = _a, rest = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__rest)(_a, [\"isShowingWalletButtonsOnTop\", \"initialize\", \"onError\", \"methodId\"]);\n    const initializeWithIntegrations = (0,react__WEBPACK_IMPORTED_MODULE_6__.useCallback)((options) => {\n        var _a;\n        return initialize(Object.assign(Object.assign({}, options), { integrations: [\n                ...(_a = options.integrations) !== null && _a !== void 0 ? _a : [],\n                _bigcommerce_checkout_sdk_integrations_bigcommerce_payments__WEBPACK_IMPORTED_MODULE_1__.createBigCommercePaymentsFastlaneCustomerStrategy,\n                _bigcommerce_checkout_sdk_integrations_bigcommerce_payments__WEBPACK_IMPORTED_MODULE_1__.createBigCommercePaymentsVenmoCustomerStrategy,\n                _bigcommerce_checkout_sdk_integrations_bolt__WEBPACK_IMPORTED_MODULE_2__.createBoltCustomerStrategy,\n                _bigcommerce_checkout_sdk_integrations_braintree__WEBPACK_IMPORTED_MODULE_3__.createBraintreePaypalCustomerStrategy,\n                _bigcommerce_checkout_sdk_integrations_braintree__WEBPACK_IMPORTED_MODULE_3__.createBraintreePaypalCreditCustomerStrategy,\n                _bigcommerce_checkout_sdk_integrations_braintree__WEBPACK_IMPORTED_MODULE_3__.createBraintreeFastlaneCustomerStrategy,\n                _bigcommerce_checkout_sdk_integrations_braintree__WEBPACK_IMPORTED_MODULE_3__.createBraintreeVisaCheckoutCustomerStrategy,\n                _bigcommerce_checkout_sdk_integrations_paypal_commerce__WEBPACK_IMPORTED_MODULE_4__.createPayPalCommerceVenmoCustomerStrategy,\n                _bigcommerce_checkout_sdk_integrations_paypal_commerce__WEBPACK_IMPORTED_MODULE_4__.createPayPalCommerceFastlaneCustomerStrategy,\n                _bigcommerce_checkout_sdk_integrations_stripe__WEBPACK_IMPORTED_MODULE_5__.createStripeUPECustomerStrategy,\n                _bigcommerce_checkout_sdk_integrations_stripe__WEBPACK_IMPORTED_MODULE_5__.createStripeLinkV2CustomerStrategy,\n            ] }));\n    }, [initialize]);\n    switch (methodId) {\n        case 'applepay':\n            return react__WEBPACK_IMPORTED_MODULE_6___default().createElement(_customWalletButton__WEBPACK_IMPORTED_MODULE_8__[\"default\"], Object.assign({ containerId: `${methodId}CheckoutButton`, initialize: initialize, key: methodId, methodId: methodId, onError: onError }, rest));\n    }\n    return react__WEBPACK_IMPORTED_MODULE_6___default().createElement(_CheckoutButton__WEBPACK_IMPORTED_MODULE_7__[\"default\"], Object.assign({ containerId: `${methodId}CheckoutButton`, initialize: initializeWithIntegrations, isShowingWalletButtonsOnTop: isShowingWalletButtonsOnTop, key: methodId, methodId: methodId, onError: onError }, rest));\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CheckoutButtonV1Resolver);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvY3VzdG9tZXIvV2FsbGV0QnV0dG9uVjFSZXNvbHZlci50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQ2dMO0FBQ3ZGO0FBQ21KO0FBQzNFO0FBQzdCO0FBQ2pFO0FBRXJCO0FBQ1E7QUFXdEQsTUFBTSx3QkFBd0IsR0FBcUQsQ0FBQyxFQU1uRixFQUFFLEVBQUU7UUFOK0UsRUFDaEYsMkJBQTJCLEdBQUUsS0FBSyxFQUNsQyxVQUFVLEVBQ1YsT0FBTyxFQUNQLFFBQVEsT0FFWCxFQURNLElBQUkscURBTHlFLG9FQU1uRixDQURVO0lBRVAsTUFBTSwwQkFBMEIsR0FBRyxrREFBVyxDQUMxQyxDQUFDLE9BQWtDLEVBQUUsRUFBRTs7UUFDbkMsT0FBTyxVQUFVLGlDQUNWLE9BQU8sS0FDVixZQUFZLEVBQUU7Z0JBQ1YsR0FBRyxhQUFPLENBQUMsWUFBWSxtQ0FBSSxFQUFFO2dCQUM3QiwwSUFBaUQ7Z0JBQ2pELHVJQUE4QztnQkFDOUMsbUdBQTBCO2dCQUMxQixtSEFBcUM7Z0JBQ3JDLHlIQUEyQztnQkFDM0MscUhBQXVDO2dCQUN2Qyx5SEFBMkM7Z0JBQzNDLDZIQUF5QztnQkFDekMsZ0lBQTRDO2dCQUM1QywwR0FBK0I7Z0JBQy9CLDZHQUFrQzthQUNyQyxJQUNILENBQUM7SUFDUCxDQUFDLEVBQ0QsQ0FBQyxVQUFVLENBQUMsQ0FDZixDQUFDO0lBRUYsUUFBUSxRQUFRLEVBQUUsQ0FBQztRQUNmLEtBQUssVUFBVTtZQUNYLE9BQU8sMkRBQUMsMkRBQWMsa0JBQ2xCLFdBQVcsRUFBRSxHQUFHLFFBQVEsZ0JBQWdCLEVBQ3hDLFVBQVUsRUFBRSxVQUFVLEVBQ3RCLEdBQUcsRUFBRSxRQUFRLEVBQ2IsUUFBUSxFQUFFLFFBQVEsRUFDbEIsT0FBTyxFQUFFLE9BQU8sSUFDWixJQUFJLEVBQ1YsQ0FBQztJQUNYLENBQUM7SUFFRCxPQUFPLDJEQUFDLHVEQUFjLGtCQUNkLFdBQVcsRUFBRSxHQUFHLFFBQVEsZ0JBQWdCLEVBQ3hDLFVBQVUsRUFBRSwwQkFBMEIsRUFDdEMsMkJBQTJCLEVBQUUsMkJBQTJCLEVBQ3hELEdBQUcsRUFBRSxRQUFRLEVBQ2IsUUFBUSxFQUFFLFFBQVEsRUFDbEIsT0FBTyxFQUFFLE9BQU8sSUFDWixJQUFJLEVBQ1YsQ0FBQztBQUNYLENBQUMsQ0FBQztBQUVGLGlFQUFlLHdCQUF3QixFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2hlY2tvdXQvLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvY3VzdG9tZXIvV2FsbGV0QnV0dG9uVjFSZXNvbHZlci50c3g/Mjk4NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0eXBlIEN1c3RvbWVySW5pdGlhbGl6ZU9wdGlvbnMsIHR5cGUgQ3VzdG9tZXJSZXF1ZXN0T3B0aW9ucyB9IGZyb20gXCJAYmlnY29tbWVyY2UvY2hlY2tvdXQtc2RrXCI7XG5pbXBvcnQgeyBjcmVhdGVCaWdDb21tZXJjZVBheW1lbnRzRmFzdGxhbmVDdXN0b21lclN0cmF0ZWd5LCBjcmVhdGVCaWdDb21tZXJjZVBheW1lbnRzVmVubW9DdXN0b21lclN0cmF0ZWd5IH0gZnJvbSBcIkBiaWdjb21tZXJjZS9jaGVja291dC1zZGsvaW50ZWdyYXRpb25zL2JpZ2NvbW1lcmNlLXBheW1lbnRzXCI7XG5pbXBvcnQgeyBjcmVhdGVCb2x0Q3VzdG9tZXJTdHJhdGVneSB9IGZyb20gXCJAYmlnY29tbWVyY2UvY2hlY2tvdXQtc2RrL2ludGVncmF0aW9ucy9ib2x0XCI7XG5pbXBvcnQgeyBjcmVhdGVCcmFpbnRyZWVGYXN0bGFuZUN1c3RvbWVyU3RyYXRlZ3ksIGNyZWF0ZUJyYWludHJlZVBheXBhbENyZWRpdEN1c3RvbWVyU3RyYXRlZ3ksIGNyZWF0ZUJyYWludHJlZVBheXBhbEN1c3RvbWVyU3RyYXRlZ3ksIGNyZWF0ZUJyYWludHJlZVZpc2FDaGVja291dEN1c3RvbWVyU3RyYXRlZ3kgfSBmcm9tIFwiQGJpZ2NvbW1lcmNlL2NoZWNrb3V0LXNkay9pbnRlZ3JhdGlvbnMvYnJhaW50cmVlXCI7XG5pbXBvcnQgeyBjcmVhdGVQYXlQYWxDb21tZXJjZUZhc3RsYW5lQ3VzdG9tZXJTdHJhdGVneSwgY3JlYXRlUGF5UGFsQ29tbWVyY2VWZW5tb0N1c3RvbWVyU3RyYXRlZ3kgfSBmcm9tIFwiQGJpZ2NvbW1lcmNlL2NoZWNrb3V0LXNkay9pbnRlZ3JhdGlvbnMvcGF5cGFsLWNvbW1lcmNlXCI7XG5pbXBvcnQgeyBjcmVhdGVTdHJpcGVMaW5rVjJDdXN0b21lclN0cmF0ZWd5LCBjcmVhdGVTdHJpcGVVUEVDdXN0b21lclN0cmF0ZWd5IH0gZnJvbSBcIkBiaWdjb21tZXJjZS9jaGVja291dC1zZGsvaW50ZWdyYXRpb25zL3N0cmlwZVwiO1xuaW1wb3J0IFJlYWN0LCB7IHR5cGUgRnVuY3Rpb25Db21wb25lbnQsIHVzZUNhbGxiYWNrIH0gZnJvbSBcInJlYWN0XCI7XG5cbmltcG9ydCBDaGVja291dEJ1dHRvbiBmcm9tIFwiLi9DaGVja291dEJ1dHRvblwiO1xuaW1wb3J0IHsgQXBwbGVQYXlCdXR0b24gfSBmcm9tIFwiLi9jdXN0b21XYWxsZXRCdXR0b25cIjtcblxuaW50ZXJmYWNlIENoZWNrb3V0QnV0dG9uVjFSZXNvbHZlclByb3BzIHtcbiAgICBtZXRob2RJZDogc3RyaW5nO1xuICAgIGRlaW5pdGlhbGl6ZShvcHRpb25zOiBDdXN0b21lclJlcXVlc3RPcHRpb25zKTogdm9pZDtcbiAgICBpc1Nob3dpbmdXYWxsZXRCdXR0b25zT25Ub3A/OiBib29sZWFuO1xuICAgIGluaXRpYWxpemUob3B0aW9uczogQ3VzdG9tZXJJbml0aWFsaXplT3B0aW9ucyk6IHZvaWQ7XG4gICAgb25FcnJvcj8oZXJyb3I6IEVycm9yKTogdm9pZDtcbiAgICBvbkNsaWNrPyhtZXRob2ROYW1lOiBzdHJpbmcpOiB2b2lkO1xufVxuXG5jb25zdCBDaGVja291dEJ1dHRvblYxUmVzb2x2ZXI6IEZ1bmN0aW9uQ29tcG9uZW50PENoZWNrb3V0QnV0dG9uVjFSZXNvbHZlclByb3BzPiA9ICh7XG4gICAgaXNTaG93aW5nV2FsbGV0QnV0dG9uc09uVG9wPSBmYWxzZSxcbiAgICBpbml0aWFsaXplLFxuICAgIG9uRXJyb3IsXG4gICAgbWV0aG9kSWQsXG4gICAgLi4ucmVzdFxufSkgPT4ge1xuICAgIGNvbnN0IGluaXRpYWxpemVXaXRoSW50ZWdyYXRpb25zID0gdXNlQ2FsbGJhY2soXG4gICAgICAgIChvcHRpb25zOiBDdXN0b21lckluaXRpYWxpemVPcHRpb25zKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gaW5pdGlhbGl6ZSh7XG4gICAgICAgICAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgICAgICAgICBpbnRlZ3JhdGlvbnM6IFtcbiAgICAgICAgICAgICAgICAgICAgLi4ub3B0aW9ucy5pbnRlZ3JhdGlvbnMgPz8gW10sXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZUN1c3RvbWVyU3RyYXRlZ3ksXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUJpZ0NvbW1lcmNlUGF5bWVudHNWZW5tb0N1c3RvbWVyU3RyYXRlZ3ksXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUJvbHRDdXN0b21lclN0cmF0ZWd5LFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVCcmFpbnRyZWVQYXlwYWxDdXN0b21lclN0cmF0ZWd5LFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVCcmFpbnRyZWVQYXlwYWxDcmVkaXRDdXN0b21lclN0cmF0ZWd5LFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVCcmFpbnRyZWVGYXN0bGFuZUN1c3RvbWVyU3RyYXRlZ3ksXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZUJyYWludHJlZVZpc2FDaGVja291dEN1c3RvbWVyU3RyYXRlZ3ksXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZVBheVBhbENvbW1lcmNlVmVubW9DdXN0b21lclN0cmF0ZWd5LFxuICAgICAgICAgICAgICAgICAgICBjcmVhdGVQYXlQYWxDb21tZXJjZUZhc3RsYW5lQ3VzdG9tZXJTdHJhdGVneSxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlU3RyaXBlVVBFQ3VzdG9tZXJTdHJhdGVneSxcbiAgICAgICAgICAgICAgICAgICAgY3JlYXRlU3RyaXBlTGlua1YyQ3VzdG9tZXJTdHJhdGVneSxcbiAgICAgICAgICAgICAgICBdLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIFtpbml0aWFsaXplXSxcbiAgICApO1xuXG4gICAgc3dpdGNoIChtZXRob2RJZCkge1xuICAgICAgICBjYXNlICdhcHBsZXBheSc6XG4gICAgICAgICAgICByZXR1cm4gPEFwcGxlUGF5QnV0dG9uXG4gICAgICAgICAgICAgICAgY29udGFpbmVySWQ9e2Ake21ldGhvZElkfUNoZWNrb3V0QnV0dG9uYH1cbiAgICAgICAgICAgICAgICBpbml0aWFsaXplPXtpbml0aWFsaXplfVxuICAgICAgICAgICAgICAgIGtleT17bWV0aG9kSWR9XG4gICAgICAgICAgICAgICAgbWV0aG9kSWQ9e21ldGhvZElkfVxuICAgICAgICAgICAgICAgIG9uRXJyb3I9e29uRXJyb3J9XG4gICAgICAgICAgICAgICAgey4uLnJlc3R9XG4gICAgICAgICAgICAvPjtcbiAgICB9XG5cbiAgICByZXR1cm4gPENoZWNrb3V0QnV0dG9uXG4gICAgICAgICAgICBjb250YWluZXJJZD17YCR7bWV0aG9kSWR9Q2hlY2tvdXRCdXR0b25gfVxuICAgICAgICAgICAgaW5pdGlhbGl6ZT17aW5pdGlhbGl6ZVdpdGhJbnRlZ3JhdGlvbnN9XG4gICAgICAgICAgICBpc1Nob3dpbmdXYWxsZXRCdXR0b25zT25Ub3A9e2lzU2hvd2luZ1dhbGxldEJ1dHRvbnNPblRvcH1cbiAgICAgICAgICAgIGtleT17bWV0aG9kSWR9XG4gICAgICAgICAgICBtZXRob2RJZD17bWV0aG9kSWR9XG4gICAgICAgICAgICBvbkVycm9yPXtvbkVycm9yfVxuICAgICAgICAgICAgey4uLnJlc3R9XG4gICAgICAgIC8+O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgQ2hlY2tvdXRCdXR0b25WMVJlc29sdmVyO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./packages/core/src/app/customer/WalletButtonV1Resolver.tsx\n\n}");

/***/ }),

/***/ "./packages/core/src/app/customer/customWalletButton/ApplePayButton.tsx":
/*!******************************************************************************!*\
  !*** ./packages/core/src/app/customer/customWalletButton/ApplePayButton.tsx ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.mjs\");\n/* harmony import */ var _bigcommerce_checkout_sdk_integrations_apple_pay__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @bigcommerce/checkout-sdk/integrations/apple-pay */ \"../checkout-sdk-js/dist/esm/integrations/apple-pay.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"./node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _bigcommerce_checkout_locale__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @bigcommerce/checkout/locale */ \"./packages/locale/src/LocaleContext.ts\");\n/* harmony import */ var _bigcommerce_checkout_utility__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @bigcommerce/checkout/utility */ \"./packages/utility/src/navigateToOrderConfirmation.ts\");\n/* harmony import */ var _CheckoutButton__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../CheckoutButton */ \"./packages/core/src/app/customer/CheckoutButton.tsx\");\n\n\n\n\n\n\n\nconst ApplePayButton = (_a) => {\n    var { initialize, onError, onClick = lodash__WEBPACK_IMPORTED_MODULE_2__.noop } = _a, rest = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__rest)(_a, [\"initialize\", \"onError\", \"onClick\"]);\n    const localeContext = (0,react__WEBPACK_IMPORTED_MODULE_3__.useContext)(_bigcommerce_checkout_locale__WEBPACK_IMPORTED_MODULE_4__[\"default\"]);\n    const initializeOptions = (0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)((options) => initialize(Object.assign(Object.assign({}, options), { integrations: [_bigcommerce_checkout_sdk_integrations_apple_pay__WEBPACK_IMPORTED_MODULE_1__.createApplePayCustomerStrategy], applepay: {\n            container: rest.containerId,\n            shippingLabel: localeContext === null || localeContext === void 0 ? void 0 : localeContext.language.translate('cart.shipping_text'),\n            subtotalLabel: localeContext === null || localeContext === void 0 ? void 0 : localeContext.language.translate('cart.subtotal_text'),\n            onError,\n            onClick: () => onClick(rest.methodId),\n            onPaymentAuthorize: _bigcommerce_checkout_utility__WEBPACK_IMPORTED_MODULE_5__[\"default\"],\n        } })), [initialize, localeContext, onError, rest.containerId]);\n    return react__WEBPACK_IMPORTED_MODULE_3___default().createElement(_CheckoutButton__WEBPACK_IMPORTED_MODULE_6__[\"default\"], Object.assign({ initialize: initializeOptions }, rest));\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ApplePayButton);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvY3VzdG9tZXIvY3VzdG9tV2FsbGV0QnV0dG9uL0FwcGxlUGF5QnV0dG9uLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUNrRztBQUNwRTtBQUNpRDtBQUVsQjtBQUNlO0FBRUM7QUFFN0UsTUFBTSxjQUFjLEdBQTJDLENBQUMsRUFLL0QsRUFBRSxFQUFFO1FBTDJELEVBQzVELFVBQVUsRUFDVixPQUFPLEVBQ1AsT0FBTyxHQUFHLHdDQUFJLE9BRWpCLEVBRE0sSUFBSSxxREFKcUQsb0NBSy9ELENBRFU7SUFFUCxNQUFNLGFBQWEsR0FBRyxpREFBVSxDQUFDLG9FQUFhLENBQUMsQ0FBQztJQUNoRCxNQUFNLGlCQUFpQixHQUFHLGtEQUFXLENBQ2pDLENBQUMsT0FBa0MsRUFBRSxFQUFFLENBQ25DLFVBQVUsaUNBQ0gsT0FBTyxLQUNWLFlBQVksRUFBRSxDQUFDLDRHQUE4QixDQUFDLEVBQzlDLFFBQVEsRUFBRTtZQUNOLFNBQVMsRUFBRSxJQUFJLENBQUMsV0FBVztZQUMzQixhQUFhLEVBQUUsYUFBYSxhQUFiLGFBQWEsdUJBQWIsYUFBYSxDQUFFLFFBQVEsQ0FBQyxTQUFTLENBQUMsb0JBQW9CLENBQUM7WUFDdEUsYUFBYSxFQUFFLGFBQWEsYUFBYixhQUFhLHVCQUFiLGFBQWEsQ0FBRSxRQUFRLENBQUMsU0FBUyxDQUFDLG9CQUFvQixDQUFDO1lBQ3RFLE9BQU87WUFDUCxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUM7WUFDckMsa0JBQWtCLEVBQUUscUVBQTJCO1NBQ2xELElBQ0gsRUFDTixDQUFDLFVBQVUsRUFBRSxhQUFhLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FDekQsQ0FBQztJQUVGLE9BQU8sMkRBQUMsdURBQWMsa0JBQUMsVUFBVSxFQUFFLGlCQUFpQixJQUFNLElBQUksRUFBSSxDQUFDO0FBQ3ZFLENBQUMsQ0FBQztBQUVGLGlFQUFlLGNBQWMsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2NoZWNrb3V0Ly4vcGFja2FnZXMvY29yZS9zcmMvYXBwL2N1c3RvbWVyL2N1c3RvbVdhbGxldEJ1dHRvbi9BcHBsZVBheUJ1dHRvbi50c3g/MzhjNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0eXBlIEN1c3RvbWVySW5pdGlhbGl6ZU9wdGlvbnMgfSBmcm9tICdAYmlnY29tbWVyY2UvY2hlY2tvdXQtc2RrJztcbmltcG9ydCB7IGNyZWF0ZUFwcGxlUGF5Q3VzdG9tZXJTdHJhdGVneSB9IGZyb20gJ0BiaWdjb21tZXJjZS9jaGVja291dC1zZGsvaW50ZWdyYXRpb25zL2FwcGxlLXBheSc7XG5pbXBvcnQgeyBub29wIH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBSZWFjdCwgeyB0eXBlIEZ1bmN0aW9uQ29tcG9uZW50LCB1c2VDYWxsYmFjaywgdXNlQ29udGV4dCB9IGZyb20gJ3JlYWN0JztcblxuaW1wb3J0IHsgTG9jYWxlQ29udGV4dCB9IGZyb20gJ0BiaWdjb21tZXJjZS9jaGVja291dC9sb2NhbGUnO1xuaW1wb3J0IHsgbmF2aWdhdGVUb09yZGVyQ29uZmlybWF0aW9uIH0gZnJvbSAnQGJpZ2NvbW1lcmNlL2NoZWNrb3V0L3V0aWxpdHknO1xuXG5pbXBvcnQgQ2hlY2tvdXRCdXR0b24sIHsgdHlwZSBDaGVja291dEJ1dHRvblByb3BzIH0gZnJvbSAnLi4vQ2hlY2tvdXRCdXR0b24nO1xuXG5jb25zdCBBcHBsZVBheUJ1dHRvbjogRnVuY3Rpb25Db21wb25lbnQ8Q2hlY2tvdXRCdXR0b25Qcm9wcz4gPSAoe1xuICAgIGluaXRpYWxpemUsXG4gICAgb25FcnJvcixcbiAgICBvbkNsaWNrID0gbm9vcCxcbiAgICAuLi5yZXN0XG59KSA9PiB7XG4gICAgY29uc3QgbG9jYWxlQ29udGV4dCA9IHVzZUNvbnRleHQoTG9jYWxlQ29udGV4dCk7XG4gICAgY29uc3QgaW5pdGlhbGl6ZU9wdGlvbnMgPSB1c2VDYWxsYmFjayhcbiAgICAgICAgKG9wdGlvbnM6IEN1c3RvbWVySW5pdGlhbGl6ZU9wdGlvbnMpID0+XG4gICAgICAgICAgICBpbml0aWFsaXplKHtcbiAgICAgICAgICAgICAgICAuLi5vcHRpb25zLFxuICAgICAgICAgICAgICAgIGludGVncmF0aW9uczogW2NyZWF0ZUFwcGxlUGF5Q3VzdG9tZXJTdHJhdGVneV0sXG4gICAgICAgICAgICAgICAgYXBwbGVwYXk6IHtcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiByZXN0LmNvbnRhaW5lcklkLFxuICAgICAgICAgICAgICAgICAgICBzaGlwcGluZ0xhYmVsOiBsb2NhbGVDb250ZXh0Py5sYW5ndWFnZS50cmFuc2xhdGUoJ2NhcnQuc2hpcHBpbmdfdGV4dCcpLFxuICAgICAgICAgICAgICAgICAgICBzdWJ0b3RhbExhYmVsOiBsb2NhbGVDb250ZXh0Py5sYW5ndWFnZS50cmFuc2xhdGUoJ2NhcnQuc3VidG90YWxfdGV4dCcpLFxuICAgICAgICAgICAgICAgICAgICBvbkVycm9yLFxuICAgICAgICAgICAgICAgICAgICBvbkNsaWNrOiAoKSA9PiBvbkNsaWNrKHJlc3QubWV0aG9kSWQpLFxuICAgICAgICAgICAgICAgICAgICBvblBheW1lbnRBdXRob3JpemU6IG5hdmlnYXRlVG9PcmRlckNvbmZpcm1hdGlvbixcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSksXG4gICAgICAgIFtpbml0aWFsaXplLCBsb2NhbGVDb250ZXh0LCBvbkVycm9yLCByZXN0LmNvbnRhaW5lcklkXSxcbiAgICApO1xuXG4gICAgcmV0dXJuIDxDaGVja291dEJ1dHRvbiBpbml0aWFsaXplPXtpbml0aWFsaXplT3B0aW9uc30gey4uLnJlc3R9IC8+O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgQXBwbGVQYXlCdXR0b247XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./packages/core/src/app/customer/customWalletButton/ApplePayButton.tsx\n\n}");

/***/ })

}]);